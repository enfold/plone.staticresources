(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{2143:function(t,n,e){(function(t){!function(){"use strict";var n=function(t){return function(n){return function(t){var n=typeof t;return null===t?"null":"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(n)===t}},e=function(t){return function(n){return typeof n===t}},o=function(t){return function(n){return t===n}},r=n("string"),i=n("object"),u=n("array"),a=o(null),c=e("boolean"),s=o(void 0),f=function(t){return null==t},l=function(t){return!f(t)},d=e("function"),m=e("number"),g=function(t,n){if(u(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},p=function(){},h=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},v=function(t){return function(){return t}},b=function(t){return t},y=function(t,n){return t===n};function x(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var w=function(t){return function(n){return!t(n)}},S=function(t){return function(){throw new Error(t)}},k=v(!1),C=v(!0),O=tinymce.util.Tools.resolve("tinymce.ThemeManager"),_=function(){return _=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},_.apply(this,arguments)};function T(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function E(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}var D,B,A,M=function(){return F},F=(D=function(t){return t()},{fold:function(t,n){return t()},isSome:k,isNone:C,getOr:B=b,getOrThunk:D,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:v(null),getOrUndefined:v(void 0),or:B,orThunk:D,map:M,each:p,bind:M,exists:k,forall:C,filter:function(){return M()},toArray:function(){return[]},toString:v("none()")}),I=function(t){var n=v(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},isSome:C,isNone:k,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return I(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:F},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},R={some:I,none:M,from:function(t){return null==t?F:I(t)}},V=Array.prototype.slice,P=Array.prototype.indexOf,H=Array.prototype.push,z=function(t,n){return P.call(t,n)},N=function(t,n){return z(t,n)>-1},L=function(t,n){for(var e=0,o=t.length;e<o;e++){if(n(t[e],e))return!0}return!1},j=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},W=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=V.call(t,o,o+n);e.push(r)}return e},U=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},G=function(t,n){for(var e=0,o=t.length;e<o;e++){n(t[e],e)}},X=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},q=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},Y=function(t,n,e){return function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e)}(t,(function(t,o){e=n(e,t,o)})),e},K=function(t,n,e){return G(t,(function(t,o){e=n(e,t,o)})),e},J=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return R.some(i);if(e(i,o))break}return R.none()}(t,n,k)},$=function(t,n){for(var e=0,o=t.length;e<o;e++){if(n(t[e],e))return R.some(e)}return R.none()},Q=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!u(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);H.apply(n,t[e])}return n},Z=function(t,n){return Q(U(t,n))},tt=function(t,n){for(var e=0,o=t.length;e<o;++e){if(!0!==n(t[e],e))return!1}return!0},nt=function(t){var n=V.call(t,0);return n.reverse(),n},et=function(t,n){return q(t,(function(t){return!N(n,t)}))},ot=function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e},rt=function(t){return[t]},it=function(t,n){var e=V.call(t,0);return e.sort(n),e},ut=function(t,n){return n>=0&&n<t.length?R.some(t[n]):R.none()},at=function(t){return ut(t,0)},ct=function(t){return ut(t,t.length-1)},st=d(Array.from)?Array.from:function(t){return V.call(t)},ft=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return R.none()},lt=function(t){return{isValue:C,isError:k,getOr:v(t),getOrThunk:v(t),getOrDie:v(t),or:function(n){return lt(t)},orThunk:function(n){return lt(t)},fold:function(n,e){return e(t)},map:function(n){return lt(n(t))},mapError:function(n){return lt(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return R.some(t)}}},dt=function(t){return{isValue:k,isError:C,getOr:b,getOrThunk:function(t){return t()},getOrDie:function(){return S(String(t))()},or:b,orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return dt(t)},mapError:function(n){return dt(n(t))},each:p,bind:function(n){return dt(t)},exists:k,forall:C,toOptional:R.none}},mt={value:lt,error:dt,fromOption:function(t,n){return t.fold((function(){return dt(n)}),lt)}};!function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"}(A||(A={}));var gt=function(t,n,e){return t.stype===A.Error?n(t.serror):e(t.svalue)},pt=function(t){return{stype:A.Value,svalue:t}},ht=function(t){return{stype:A.Error,serror:t}},vt=function(t){return t.fold(ht,pt)},bt=function(t){return gt(t,mt.error,mt.value)},yt=pt,xt=function(t){var n=[],e=[];return G(t,(function(t){gt(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},wt=ht,St=function(t,n){return t.stype===A.Value?n(t.svalue):t},kt=function(t,n){return t.stype===A.Error?n(t.serror):t},Ct=function(t,n){return t.stype===A.Value?{stype:A.Value,svalue:n(t.svalue)}:t},Ot=function(t,n){return t.stype===A.Error?{stype:A.Error,serror:n(t.serror)}:t},_t=gt,Tt=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},Et=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}},Dt=Object.keys,Bt=Object.hasOwnProperty,At=function(t,n){for(var e=Dt(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},Mt=function(t,n){return Ft(t,(function(t,e){return{k:e,v:n(t,e)}}))},Ft=function(t,n){var e={};return At(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},It=function(t,n){var e={};return function(t,n,e,o){At(t,(function(t,r){(n(t,r)?e:o)(t,r)}))}(t,n,function(t){return function(n,e){t[e]=n}}(e),p),e},Rt=function(t,n){var e=[];return At(t,(function(t,o){e.push(n(t,o))})),e},Vt=function(t,n){for(var e=Dt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return R.some(u)}return R.none()},Pt=function(t){return Rt(t,b)},Ht=function(t,n){return zt(t,n)?R.from(t[n]):R.none()},zt=function(t,n){return Bt.call(t,n)},Nt=function(t,n){return zt(t,n)&&void 0!==t[n]&&null!==t[n]},Lt=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)zt(i,u)&&(o[u]=t(o[u],i[u]))}return o}},jt=Lt((function(t,n){return i(t)&&i(n)?jt(t,n):n})),Wt=Lt((function(t,n){return n})),Ut=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},Gt=function(t){return{tag:"defaultedThunk",process:t}},Xt=function(t){return Gt(v(t))},qt=function(t){return{tag:"mergeWithThunk",process:t}},Yt=function(t){return h(wt,Q)(t)},Kt=function(t){var n=xt(t);return n.errors.length>0?Yt(n.errors):yt(n.values)},Jt=function(t){return i(t)&&Dt(t).length>100?" removed due to size":JSON.stringify(t,null,2)},$t=function(t,n){return wt([{path:t,getErrorInfo:n}])},Qt=function(t){return{extract:function(n,e){return kt(t(e),(function(t){return function(t,n){return $t(t,v(n))}(n,t)}))},toString:v("val")}},Zt=Qt(yt),tn=function(t,n,e,o){return Ht(n,e).fold((function(){return function(t,n,e){return $t(t,(function(){return'Could not find valid *required* value for "'+n+'" in '+Jt(e)}))}(t,e,n)}),o)},nn=function(t,n,e,o){return o(Ht(t,n).getOrThunk((function(){return e(t)})))},en=function(t,n,e,o,r){var i=function(t){return r.extract(n.concat([o]),t)},u=function(t){return t.fold((function(){return yt(R.none())}),(function(t){var e=r.extract(n.concat([o]),t);return Ct(e,R.some)}))};switch(t.tag){case"required":return tn(n,e,o,i);case"defaultedThunk":return nn(e,o,t.process,i);case"option":return function(t,n,e){return e(Ht(t,n))}(e,o,u);case"defaultedOptionThunk":return function(t,n,e,o){return o(Ht(t,n).map((function(n){return!0===n?e(t):n})))}(e,o,t.process,u);case"mergeWithThunk":return nn(e,o,v({}),(function(n){var o=jt(t.process(e),n);return i(o)}))}},on=function(t){return{extract:function(n,e){return t().extract(n,e)},toString:function(){return t().toString()}}},rn=function(t){return Dt(It(t,l))},un=function(t){var n=an(t),e=Y(t,(function(t,n){return Et(n,(function(n){var e;return jt(t,((e={})[n]=!0,e))}),v(t))}),{});return{extract:function(t,o){var r=c(o)?[]:rn(o),i=q(r,(function(t){return!Nt(e,t)}));return 0===i.length?n.extract(t,o):function(t,n){return $t(t,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))}(t,i)},toString:n.toString}},an=function(t){return{extract:function(n,e){return function(t,n,e){for(var o={},r=[],i=0,u=e;i<u.length;i++){var a=u[i];Et(a,(function(e,i,u,a){var c=en(u,t,n,e,a);_t(c,(function(t){r.push.apply(r,t)}),(function(t){o[i]=t}))}),(function(t,e){o[t]=e(n)}))}return r.length>0?wt(r):yt(o)}(n,e,t)},toString:function(){var n=U(t,(function(t){return Et(t,(function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))}));return"obj{\n"+n.join("\n")+"}"}}},cn=function(t){return{extract:function(n,e){var o=U(e,(function(e,o){return t.extract(n.concat(["["+o+"]"]),e)}));return Kt(o)},toString:function(){return"array("+t.toString()+")"}}},sn=function(t){return{extract:function(n,e){for(var o=[],r=0,i=t;r<i.length;r++){var u=i[r].extract(n,e);if(u.stype===A.Value)return u;o.push(u)}return Kt(o)},toString:function(){return"oneOf("+U(t,(function(t){return t.toString()})).join(", ")+")"}}},fn=function(t,n){return{extract:function(e,o){var r=Dt(o),i=function(n,e){return cn(Qt(t)).extract(n,e)}(e,r);return St(i,(function(t){var r=U(t,(function(t){return Tt(t,t,{tag:"required",process:{}},n)}));return an(r).extract(e,o)}))},toString:function(){return"setOf("+n.toString()+")"}}},ln=h(cn,an),dn=v(Zt),mn=function(t,n){return Qt((function(e){var o=typeof e;return t(e)?yt(e):wt("Expected type: "+n+" but got: "+o)}))},gn=mn(m,"number"),pn=mn(r,"string"),hn=mn(c,"boolean"),vn=mn(d,"function"),bn=function(t){if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return bn(t[n])}));default:return!1}},yn=Qt((function(t){return bn(t)?yt(t):wt("Expected value to be acceptable for sending via postMessage")})),xn=function(t,n,e,o){return Ht(e,o).fold((function(){return function(t,n,e){return $t(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Jt(n)}))}(t,e,o)}),(function(e){return e.extract(t.concat(["branch: "+o]),n)}))},wn=function(t,n){return{extract:function(e,o){return Ht(o,t).fold((function(){return function(t,n){return $t(t,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))}(e,t)}),(function(t){return xn(e,o,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+Dt(n)}}},Sn=function(t){return Qt((function(n){return t(n).fold(wt,yt)}))},kn=function(t,n){return fn((function(n){return vt(t(n))}),n)},Cn=function(t,n,e){return bt(function(t,n,e){var o=n.extract([t],e);return Ot(o,(function(t){return{input:e,errors:t}}))}(t,n,e))},On=function(t){return t.fold((function(t){throw new Error(Tn(t))}),b)},_n=function(t,n,e){return On(Cn(t,n,e))},Tn=function(t){return"Errors: \n"+(n=t.errors,e=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:v("... (only showing first ten failures)")}]):n,U(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))).join("\n")+"\n\nInput object: "+Jt(t.input);var n,e},En=function(t,n){return wn(t,Mt(n,an))},Dn=Tt,Bn=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},An=function(t){return Sn((function(n){return N(t,n)?mt.value(n):mt.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Mn=function(t){return Dn(t,t,{tag:"required",process:{}},dn())},Fn=function(t,n){return Dn(t,t,{tag:"required",process:{}},n)},In=function(t){return Fn(t,gn)},Rn=function(t){return Fn(t,pn)},Vn=function(t,n){return Dn(t,t,{tag:"required",process:{}},An(n))},Pn=function(t){return Fn(t,vn)},Hn=function(t,n){return Dn(t,t,{tag:"required",process:{}},an(n))},zn=function(t,n){return Dn(t,t,{tag:"required",process:{}},ln(n))},Nn=function(t,n){return Dn(t,t,{tag:"required",process:{}},cn(n))},Ln=function(t){return Dn(t,t,{tag:"option",process:{}},dn())},jn=function(t,n){return Dn(t,t,{tag:"option",process:{}},n)},Wn=function(t){return jn(t,gn)},Un=function(t){return jn(t,pn)},Gn=function(t){return jn(t,vn)},Xn=function(t,n){return jn(t,cn(n))},qn=function(t,n){return jn(t,an(n))},Yn=function(t,n){return Dn(t,t,Xt(n),dn())},Kn=function(t,n,e){return Dn(t,t,Xt(n),e)},Jn=function(t,n){return Kn(t,n,gn)},$n=function(t,n){return Kn(t,n,pn)},Qn=function(t,n,e){return Kn(t,n,An(e))},Zn=function(t,n){return Kn(t,n,hn)},te=function(t,n){return Kn(t,n,vn)},ne=function(t,n,e){return Kn(t,n,cn(e))},ee=function(t,n,e){return Kn(t,n,an(e))},oe=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},re=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},ie={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return re(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t);return re(e)},fromText:function(t,n){var e=(n||document).createTextNode(t);return re(e)},fromDom:re,fromPoint:function(t,n,e){return R.from(t.dom.elementFromPoint(n,e)).map(re)}},ue=function(){return ae(0,0)},ae=function(t,n){return{major:t,minor:n}},ce={nu:ae,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?ue():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return ae(o(1),o(2))}(t,e)},unknown:ue},se=function(t,n){var e=String(n).toLowerCase();return J(t,(function(t){return t.search(e)}))},fe=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},le=function(t,n){return-1!==t.indexOf(n)},de=function(t,n){return fe(t,n,0)},me=function(t,n){return fe(t,n,t.length-n.length)},ge=function(t){return function(n){return n.replace(t,"")}}(/^\s+|\s+$/g),pe=function(t){return t.length>0},he=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ve=function(t){return function(n){return le(n,t)}},be=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return le(t,"edge/")&&le(t,"chrome")&&le(t,"safari")&&le(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,he],search:function(t){return le(t,"chrome")&&!le(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return le(t,"msie")||le(t,"trident")}},{name:"Opera",versionRegexes:[he,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ve("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ve("firefox")},{name:"Safari",versionRegexes:[he,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(le(t,"safari")||le(t,"mobile/"))&&le(t,"applewebkit")}}],ye=[{name:"Windows",search:ve("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return le(t,"iphone")||le(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ve("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ve("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ve("linux"),versionRegexes:[]},{name:"Solaris",search:ve("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ve("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ve("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],xe={browsers:v(be),oses:v(ye)},we="Edge",Se="Chrome",ke="Opera",Ce="Firefox",Oe="Safari",_e=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o(we),isChrome:o(Se),isIE:o("IE"),isOpera:o(ke),isFirefox:o(Ce),isSafari:o(Oe)}},Te={unknown:function(){return _e({current:void 0,version:ce.unknown()})},nu:_e,edge:v(we),chrome:v(Se),ie:v("IE"),opera:v(ke),firefox:v(Ce),safari:v(Oe)},Ee="Windows",De="Android",Be="Linux",Ae="Solaris",Me="FreeBSD",Fe="ChromeOS",Ie=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(Ee),isiOS:o("iOS"),isAndroid:o(De),isOSX:o("OSX"),isLinux:o(Be),isSolaris:o(Ae),isFreeBSD:o(Me),isChromeOS:o(Fe)}},Re={unknown:function(){return Ie({current:void 0,version:ce.unknown()})},nu:Ie,windows:v(Ee),ios:v("iOS"),android:v(De),linux:v(Be),osx:v("OSX"),solaris:v(Ae),freebsd:v(Me),chromeos:v(Fe)},Ve=function(t,n,e){var o=xe.browsers(),r=xe.oses(),i=n.bind((function(t){return function(t,n){return ft(n.brands,(function(n){var e=n.brand.toLowerCase();return J(t,(function(t){var n;return e===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(t){return{current:t.name,version:ce.nu(parseInt(n.version,10),0)}}))}))}(o,t)})).orThunk((function(){return function(t,n){return se(t,n).map((function(t){var e=ce.detect(t.versionRegexes,n);return{current:t.name,version:e}}))}(o,t)})).fold(Te.unknown,Te.nu),u=function(t,n){return se(t,n).map((function(t){var e=ce.detect(t.versionRegexes,n);return{current:t.name,version:e}}))}(r,t).fold(Re.unknown,Re.nu),a=function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f;return{isiPad:v(r),isiPhone:v(i),isTablet:v(c),isPhone:v(s),isTouch:v(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:v(f),isDesktop:v(l)}}(u,i,t,e);return{browser:i,os:u,deviceType:a}},Pe=function(t){return window.matchMedia(t).matches},He=Ut((function(){return Ve(navigator.userAgent,R.from(navigator.userAgentData),Pe)})),ze=function(){return He()},Ne=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Le=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},je=function(t,n){return t.dom===n.dom},We=function(t,n){return function(t,n){return function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)}(t,n,Node.DOCUMENT_POSITION_CONTAINED_BY)}(t.dom,n.dom)},Ue=function(t,n){return ze().browser.isIE()?We(t,n):function(t,n){var e=t.dom,o=n.dom;return e!==o&&e.contains(o)}(t,n)},Ge=function(t){if(!u(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return G(t,(function(o,r){var i=Dt(o);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=o[a];if(void 0!==e[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!u(c))throw new Error("case arguments must be an array");n.push(a),e[a]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);var u=function(t){var o=Dt(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!tt(n,(function(t){return N(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[a].apply(null,e)};return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);var i=n[r];return i.apply(null,e)},match:u,log:function(t){console.log(t,{constructors:n,constructor:a,params:e})}}}})),e};Ge([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var Xe=function(t,n){return function(t,n){var e={};return At(t,(function(t,o){N(n,o)||(e[o]=t)})),e}(t,n)},qe=function(t,n){return function(t,n){var e;return(e={})[t]=n,e}(t,n)},Ye=function(t){return function(t){var n={};return G(t,(function(t){n[t.key]=t.value})),n}(t)},Ke=function(t,n){var e,o=function(t){var n=[],e=[];return G(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){e.push(t)}))})),{errors:n,values:e}}(t);return o.errors.length>0?(e=o.errors,mt.error(Q(e))):function(t,n){return 0===t.length?mt.value(n):mt.value(jt(n,Wt.apply(void 0,t)))}(o.values,n)},Je=function(t){return d(t)?t:k},$e=function(t,n,e){for(var o=t.dom,r=Je(e);o.parentNode;){o=o.parentNode;var i=ie.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return R.none()},Qe=function(t,n,e){var o=n(t),r=Je(e);return o.orThunk((function(){return r(t)?R.none():$e(t,n,r)}))},Ze=function(t,n){return je(t.element,n.event.target)},to={can:C,abort:k,run:p},no=function(t){if(!Nt(t,"can")&&!Nt(t,"abort")&&!Nt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return _(_({},to),t)},eo=function(t){var n=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return K(t,(function(t,o){return t&&n(o).apply(void 0,e)}),!0)}}(t,(function(t){return t.can})),e=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return K(t,(function(t,o){return t||n(o).apply(void 0,e)}),!1)}}(t,(function(t){return t.abort}));return{can:n,abort:e,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];G(t,(function(t){t.run.apply(void 0,n)}))}}},oo=v,ro=oo("touchstart"),io=oo("touchmove"),uo=oo("touchend"),ao=oo("touchcancel"),co=oo("mousedown"),so=oo("mousemove"),fo=oo("mouseout"),lo=oo("mouseup"),mo=oo("mouseover"),go=oo("focusin"),po=oo("focusout"),ho=oo("keydown"),vo=oo("keyup"),bo=oo("input"),yo=oo("change"),xo=oo("click"),wo=oo("transitioncancel"),So=oo("transitionend"),ko=oo("transitionstart"),Co=oo("selectstart"),Oo=function(t){return v("alloy."+t)},_o={tap:Oo("tap")},To=Oo("focus"),Eo=Oo("blur.post"),Do=Oo("paste.post"),Bo=Oo("receive"),Ao=Oo("execute"),Mo=Oo("focus.item"),Fo=_o.tap,Io=Oo("longpress"),Ro=Oo("sandbox.close"),Vo=Oo("typeahead.cancel"),Po=Oo("system.init"),Ho=Oo("system.touchmove"),zo=Oo("system.touchend"),No=Oo("system.scroll"),Lo=Oo("system.resize"),jo=Oo("system.attached"),Wo=Oo("system.detached"),Uo=Oo("system.dismissRequested"),Go=Oo("system.repositionRequested"),Xo=Oo("focusmanager.shifted"),qo=Oo("slotcontainer.visibility"),Yo=Oo("change.tab"),Ko=Oo("dismiss.tab"),Jo=Oo("highlight"),$o=Oo("dehighlight"),Qo=function(t,n){er(t,t.element,n,{})},Zo=function(t,n,e){er(t,t.element,n,e)},tr=function(t){Qo(t,Ao())},nr=function(t,n,e){er(t,n,e,{})},er=function(t,n,e,o){var r=_({target:n},o);t.getSystem().triggerEvent(e,n,r)},or=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},rr=function(t){return Ye(t)},ir=function(t,n){return{key:t,value:no({abort:n})}},ur=function(t){return{key:t,value:no({run:function(t,n){n.event.prevent()}})}},ar=function(t,n){return{key:t,value:no({run:n})}},cr=function(t,n,e){return{key:t,value:no({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},sr=function(t){return function(n){return{key:t,value:no({run:function(t,e){Ze(t,e)&&n(t,e)}})}}},fr=function(t,n,e){return function(t,n){return ar(t,(function(e,o){e.getSystem().getByUid(n).each((function(n){or(n,n.element,t,o)}))}))}(t,n.partUids[e])},lr=function(t,n){return ar(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk((function(){return Qe(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),k).getOr(t)}));n(t,r,e)}))},dr=function(t){return ar(t,(function(t,n){n.cut()}))},mr=function(t){return ar(t,(function(t,n){n.stop()}))},gr=function(t,n){return sr(t)(n)},pr=sr(jo()),hr=sr(Wo()),vr=sr(Po()),br=function(t){return function(n){return ar(t,n)}}(Ao());"undefined"!=typeof window?window:Function("return this;")();var yr,xr=function(t){return t.dom.nodeName.toLowerCase()},wr=function(t){return function(n){return function(t){return t.dom.nodeType}(n)===t}},Sr=wr(1),kr=wr(3),Cr=wr(9),Or=wr(11),_r=function(t){return ie.fromDom(t.dom.ownerDocument)},Tr=function(t){return Cr(t)?t:_r(t)},Er=function(t){return ie.fromDom(Tr(t).dom.documentElement)},Dr=function(t){return ie.fromDom(Tr(t).dom.defaultView)},Br=function(t){return R.from(t.dom.parentNode).map(ie.fromDom)},Ar=function(t){return R.from(t.dom.offsetParent).map(ie.fromDom)},Mr=function(t){return U(t.dom.childNodes,ie.fromDom)},Fr=function(t,n){var e=t.dom.childNodes;return R.from(e[n]).map(ie.fromDom)},Ir=function(t,n){return{element:t,offset:n}},Rr=function(t,n){var e=Mr(t);return e.length>0&&n<e.length?Ir(e[n],0):Ir(t,n)},Vr=function(t){return Or(t)&&l(t.dom.host)},Pr=d(Element.prototype.attachShadow)&&d(Node.prototype.getRootNode),Hr=v(Pr),zr=Pr?function(t){return ie.fromDom(t.dom.getRootNode())}:Tr,Nr=function(t){return Vr(t)?t:ie.fromDom(Tr(t).dom.body)},Lr=function(t){var n=zr(t);return Vr(n)?R.some(n):R.none()},jr=function(t){return ie.fromDom(t.dom.host)},Wr=function(t){return l(t.dom.shadowRoot)},Ur=function(t,n){Br(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},Gr=function(t,n){var e=function(t){return R.from(t.dom.nextSibling).map(ie.fromDom)}(t);e.fold((function(){Br(t).each((function(t){qr(t,n)}))}),(function(t){Ur(t,n)}))},Xr=function(t,n){var e=function(t){return Fr(t,0)}(t);e.fold((function(){qr(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},qr=function(t,n){t.dom.appendChild(n.dom)},Yr=function(t,n){G(n,(function(n){qr(t,n)}))},Kr=function(t){t.dom.textContent="",G(Mr(t),(function(t){Jr(t)}))},Jr=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},$r=function(t){var n,e=Mr(t);e.length>0&&(n=t,G(e,(function(t){Ur(n,t)}))),Jr(t)},Qr=function(t){return t.dom.innerHTML},Zr=function(t,n){var e,o,r=_r(t).dom,i=ie.fromDom(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,Mr(ie.fromDom(o)));Yr(i,u),Kr(t),qr(t,i)},ti=function(t,n,e){if(!(r(e)||c(e)||m(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},ni=function(t,n,e){ti(t.dom,n,e)},ei=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},oi=function(t,n){return R.from(ei(t,n))},ri=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},ii=function(t,n){t.dom.removeAttribute(n)},ui=function(t){return function(t,n){return ie.fromDom(t.dom.cloneNode(n))}(t,!1)},ai=function(t){return Vr(t)?"#shadow-root":function(t){var n=ie.fromTag("div"),e=ie.fromDom(t.dom.cloneNode(!0));return qr(n,e),Qr(n)}(ui(t))},ci=function(t){return ai(t)},si=rr([function(t,n){return{key:t,value:no({can:n})}}(To(),(function(t,n){var e=n.event,o=e.originator,r=e.target;return!function(t,n,e){return je(n,t.element)&&!je(n,e)}(t,o,r)||(console.warn(To()+" did not get interpreted by the desired target. \nOriginator: "+ci(o)+"\nTarget: "+ci(r)+"\nCheck the "+To()+" event handlers"),!1)}))]),fi=Object.freeze({__proto__:null,events:si}),li=0,di=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++li+String(n)},mi=v("alloy-id-"),gi=v("data-alloy-id"),pi=mi(),hi=gi(),vi=function(t,n){Object.defineProperty(t.dom,hi,{value:n,writable:!0})},bi=function(t){var n=Sr(t)?t.dom[hi]:null;return R.from(n)},yi=function(t){return di(t)},xi=b,wi=function(t){var n=function(n){return"The component must be in a context to execute: "+n+(t?"\n"+ci(t().element)+" is not in context.":"")},e=function(t){return function(){throw new Error(n(t))}},o=function(t){return function(){console.warn(n(t))}};return{debugInfo:v("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:k}},Si=wi(),ki=function(t){return U(t,(function(t){return me(t,"/*")?t.substring(0,t.length-"/*".length):t}))},Ci=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ki(i)}},t},Oi=di("alloy-premade"),_i=function(t){return qe(Oi,t)},Ti=function(t){return function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ki(i.slice(1))}},t}((function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,E([n.getApis(),n],e))}),t)},Ei={init:function(){return Di({readState:v("No State required")})}},Di=function(t){return t},Bi=function(t,n){var e={};return At(t,(function(t,o){At(t,(function(t,r){var i=Ht(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},Ai=function(t){return{classes:s(t.classes)?[]:t.classes,attributes:s(t.attributes)?{}:t.attributes,styles:s(t.styles)?{}:t.styles}},Mi=function(t){return t.cHandler},Fi=function(t,n){return{name:t,handler:n}},Ii=function(t,n,e){var o=_(_({},e),function(t,n){var e={};return G(t,(function(t){e[t.name()]=t.handlers(n)})),e}(n,t));return Bi(o,Fi)},Ri=function(t){var n=function(t){return d(t)?{can:C,abort:k,run:t}:t}(t);return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,e].concat(o);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},Vi=function(t,n,e){var o=n[e];return o?function(t,n,e,o){try{var r=it(e,(function(e,r){var i=e[n],u=r[n],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return mt.value(r)}catch(t){return mt.error([t])}}("Event: "+e,"name",t,o).map((function(t){var n=U(t,(function(t){return t.handler}));return eo(n)})):function(t,n){return mt.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(U(n,(function(t){return t.name})),null,2)])}(e,t)},Pi=function(t,n){var e=Rt(t,(function(t,e){return(1===t.length?mt.value(t[0].handler):Vi(t,n,e)).map((function(o){var r=Ri(o),i=t.length>1?q(n[e],(function(n){return L(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return qe(e,function(t,n){return{handler:t,purpose:n}}(r,i))}))}));return Ke(e,{})},Hi="alloy.base.behaviour",zi=an([Dn("dom","dom",{tag:"required",process:{}},an([Mn("tag"),Yn("styles",{}),Yn("classes",[]),Yn("attributes",{}),Ln("value"),Ln("innerHtml")])),Mn("components"),Mn("uid"),Yn("events",{}),Yn("apis",{}),Dn("eventOrder","eventOrder",function(t){return qt(v(t))}((yr={},yr[Ao()]=["disabling",Hi,"toggling","typeaheadevents"],yr[To()]=[Hi,"focusing","keying"],yr[Po()]=[Hi,"disabling","toggling","representing"],yr[bo()]=[Hi,"representing","streaming","invalidating"],yr[Wo()]=[Hi,"representing","item-events","tooltipping"],yr[co()]=["focusing",Hi,"item-type-events"],yr[ro()]=["focusing",Hi,"item-type-events"],yr[mo()]=["item-type-events","tooltipping"],yr[Bo()]=["receiving","reflecting","tooltipping"],yr)),dn()),Ln("domModification")]),Ni=function(t){return t.events},Li=function(t,n){var e=ei(t,n);return void 0===e||""===e?[]:e.split(" ")},ji=function(t){return void 0!==t.dom.classList},Wi=function(t,n){return function(t,n,e){var o=Li(t,n).concat([e]);return ni(t,n,o.join(" ")),!0}(t,"class",n)},Ui=function(t,n){return function(t,n,e){var o=q(Li(t,n),(function(t){return t!==e}));return o.length>0?ni(t,n,o.join(" ")):ii(t,n),!1}(t,"class",n)},Gi=function(t,n){ji(t)?t.dom.classList.add(n):Wi(t,n)},Xi=function(t){var n=ji(t)?t.dom.classList:function(t){return Li(t,"class")}(t);0===n.length&&ii(t,"class")},qi=function(t,n){ji(t)?t.dom.classList.remove(n):Ui(t,n);Xi(t)},Yi=function(t,n){return ji(t)&&t.dom.classList.contains(n)},Ki=function(t,n){G(n,(function(n){Gi(t,n)}))},Ji=function(t,n){G(n,(function(n){qi(t,n)}))},$i=function(t,n,e){return void 0===e&&(e=y),t.exists((function(t){return e(t,n)}))},Qi=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},Zi=function(t,n,e){return t.isSome()&&n.isSome()?R.some(e(t.getOrDie(),n.getOrDie())):R.none()},tu=function(t,n){return t?R.some(n):R.none()},nu=function(t){return void 0!==t.style&&d(t.style.getPropertyValue)},eu=function(t){var n=kr(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return Lr(ie.fromDom(n)).fold((function(){return r.body.contains(n)}),(e=eu,o=jr,function(t){return e(o(t))}))},ou=function(){return ru(ie.fromDom(document))},ru=function(t){var n=t.dom.body;if(null==n)throw new Error("Body is not available yet");return ie.fromDom(n)},iu=function(t,n,e){if(!r(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);nu(t)&&t.style.setProperty(n,e)},uu=function(t,n){nu(t)&&t.style.removeProperty(n)},au=function(t,n,e){var o=t.dom;iu(o,n,e)},cu=function(t,n){var e=t.dom;At(n,(function(t,n){iu(e,n,t)}))},su=function(t,n){var e=t.dom;At(n,(function(t,n){t.fold((function(){uu(e,n)}),(function(t){iu(e,n,t)}))}))},fu=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||eu(t)?o:lu(e,n)},lu=function(t,n){return nu(t)?t.style.getPropertyValue(n):""},du=function(t,n){var e=t.dom,o=lu(e,n);return R.from(o).filter((function(t){return t.length>0}))},mu=function(t){var n={},e=t.dom;if(nu(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n},gu=function(t,n,e){var o=ie.fromTag(t);return au(o,n,e),du(o,n).isSome()},pu=function(t,n){var e=t.dom;uu(e,n),$i(oi(t,"style").map(ge),"")&&ii(t,"style")},hu=function(t){return t.dom.offsetWidth},vu=function(t){return t.dom.value},bu=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},yu=function(t){var n=ie.fromTag(t.tag);!function(t,n){var e=t.dom;At(n,(function(t,n){ti(e,n,t)}))}(n,t.attributes),Ki(n,t.classes),cu(n,t.styles),t.innerHtml.each((function(t){return Zr(n,t)}));var e=t.domChildren;return Yr(n,e),t.value.each((function(t){bu(n,t)})),t.uid,vi(n,t.uid),n},xu=function(t,n){return function(t,n){var e=U(n,(function(t){return qn(t.name(),[Mn("config"),Yn("state",Ei)])})),o=Cn("component.behaviours",an(e),t.behaviours).fold((function(n){throw new Error(Tn(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),b);return{list:n,data:Mt(o,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return v(n)}))}}(t,n)},wu=function(t){var n=function(t){var n=Ht(t,"behaviours").getOr({}),e=q(Dt(n),(function(t){return void 0!==n[t]}));return U(e,(function(t){return n[t].me}))}(t);return xu(t,n)},Su=function(t,n,e){var o,r,i,u=_(_({},(o=t).dom),{uid:o.uid,domChildren:U(o.components,(function(t){return t.element}))}),a=function(t){return t.domModification.fold((function(){return Ai({})}),Ai)}(t),c={"alloy.base.modification":a},s=n.length>0?function(t,n,e,o){var r=_({},n);G(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=Bi(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return Y(t,(function(t,n){return _(_({},n.modification),t)}),{})},a=Y(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return Ai({classes:a,attributes:c,styles:s})}(e,c,n,u):a;return i=s,_(_({},r=u),{attributes:_(_({},r.attributes),i.attributes),styles:_(_({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},ku=function(t,n,e){var o={"alloy.base.behaviour":Ni(t)};return function(t,n,e,o){var r=Ii(t,e,o);return Pi(r,n)}(e,t.eventOrder,n,o).getOrDie()},Cu=function(t){var n=function(){return l},e=oe(Si),o=On(function(t){return Cn("custom.definition",zi,t)}(t)),r=wu(t),i=function(t){return t.list}(r),u=function(t){return t.data}(r),a=Su(o,i,u),c=yu(a),s=ku(o,i,u),f=oe(o.components),l={uid:t.uid,getSystem:e.get,config:function(n){var e=u;return(d(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(t){return d(u[t.name()])},spec:t,readState:function(t){return u[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(wi(n))},element:c,syncComponents:function(){var t=Mr(c),n=Z(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),rt)}));f.set(n)},components:f.get,events:s};return l},Ou=function(t){var n=xi(t),e=n.events,o=T(n,["events"]),r=function(t){var n=Ht(t,"components").getOr([]);return U(n,Du)}(o),i=_(_({},o),{events:_(_({},fi),e),components:r});return mt.value(Cu(i))},_u=function(t){var n=ie.fromText(t);return Tu({element:n})},Tu=function(t){var n=_n("external.component",un([Mn("element"),Ln("uid")]),t),e=oe(wi()),o=n.uid.getOrThunk((function(){return yi("external")}));vi(n.element,o);var r={uid:o,getSystem:e.get,config:R.none,hasConfigured:k,connect:function(t){e.set(t)},disconnect:function(){e.set(wi((function(){return r})))},getApis:function(){return{}},element:n.element,spec:t,readState:v("No state"),syncComponents:p,components:v([]),events:{}};return _i(r)},Eu=yi,Du=function(t){return function(t){return Ht(t,Oi)}(t).getOrThunk((function(){var n=function(t){return zt(t,"uid")}(t)?t:_({uid:Eu("")},t);return Ou(n).getOrDie()}))},Bu=_i,Au=function(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=fu(e,t);return parseFloat(r)||0}return o},o=function(t,n){return K(n,(function(n,e){var o=fu(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!m(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;nu(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return n>r?n-r:0}}},Mu=Au("height",(function(t){var n=t.dom;return eu(t)?n.getBoundingClientRect().height:n.offsetHeight})),Fu=function(t){return Mu.get(t)},Iu=function(t){return Mu.getOuter(t)},Ru=function(t,n){return{left:t,top:n,translate:function(e,o){return Ru(t+e,n+o)}}},Vu=Ru,Pu=function(t,n){return void 0!==t?t:void 0!==n?n:0},Hu=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return Vu(e.offsetLeft,e.offsetTop);var i=Pu(null==o?void 0:o.pageYOffset,r.scrollTop),u=Pu(null==o?void 0:o.pageXOffset,r.scrollLeft),a=Pu(r.clientTop,e.clientTop),c=Pu(r.clientLeft,e.clientLeft);return zu(t).translate(u-c,i-a)},zu=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?Vu(e.offsetLeft,e.offsetTop):eu(t)?function(t){var n=t.getBoundingClientRect();return Vu(n.left,n.top)}(n):Vu(0,0)},Nu=Au("width",(function(t){return t.dom.offsetWidth})),Lu=function(t){return Nu.get(t)},ju=function(t){return Nu.getOuter(t)},Wu=function(t){var n=ie.fromDom(function(t){if(Hr()&&l(t.target)){var n=ie.fromDom(t.target);if(Sr(n)&&Wr(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return at(e)}}return R.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=h(o,e);return function(t,n,e,o,r,i,u){return{target:t,x:n,y:e,stop:o,prevent:r,kill:i,raw:u}}(n,t.clientX,t.clientY,e,o,r,t)},Uu=function(t,n,e,o,r){var i=function(t,n){return function(e){t(e)&&n(Wu(e))}}(e,o);return t.dom.addEventListener(n,i,r),{unbind:x(Gu,t,n,i,r)}},Gu=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Xu=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return Vu(e,o)},qu=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},Yu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Ku=function(t){var n=void 0===t?window:t,e=n.document,o=Xu(ie.fromDom(e));return function(t){var n=void 0===t?window:t;return R.from(n.visualViewport)}(n).fold((function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return Yu(o.left,o.top,e,r)}),(function(t){return Yu(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)}))},Ju=function(t,n){return t.view(n).fold(v([]),(function(n){var e=t.owner(n),o=Ju(t,e);return[n].concat(o)}))},$u=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?R.none():R.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(ie.fromDom)},owner:function(t){return _r(t)}}),Qu=function(t){var n=ie.fromDom(document),e=Xu(n),o=function(t,n){var e=n.owner(t),o=Ju(n,e);return R.some(o)}(t,$u);return o.fold(x(Hu,t),(function(n){var o=zu(t),r=Y(n,(function(t,n){var e=zu(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return Vu(r.left+o.left+e.left,r.top+o.top+e.top)}))},Zu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},ta=function(t){var n=Hu(t),e=ju(t),o=Iu(t);return Zu(n.left,n.top,e,o)},na=function(t){var n=Qu(t),e=ju(t),o=Iu(t);return Zu(n.left,n.top,e,o)},ea=function(){return Ku(window)};function oa(t,n,e,o,r){return t(e,o)?R.some(e):d(r)&&r(e)?R.none():n(e,o,r)}var ra,ia=function(t,n,e){for(var o=t.dom,r=d(e)?e:k;o.parentNode;){o=o.parentNode;var i=ie.fromDom(o);if(n(i))return R.some(i);if(r(i))break}return R.none()},ua=function(t,n,e){return oa((function(t,n){return n(t)}),ia,t,n,e)},aa=function(t,n,e){return ua(t,n,e).isSome()},ca=function(t,n,e){return ia(t,(function(t){return Ne(t,n)}),e)},sa=function(t,n){return function(t,n){return J(t.dom.childNodes,(function(t){return n(ie.fromDom(t))})).map(ie.fromDom)}(t,(function(t){return Ne(t,n)}))},fa=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return Le(e)?R.none():R.from(e.querySelector(t)).map(ie.fromDom)}(n,t)},la=function(t,n,e){return oa((function(t,n){return Ne(t,n)}),ca,t,n,e)},da=function(){var t=di("aria-owns");return{id:t,link:function(n){ni(n,"aria-owns",t)},unlink:function(t){ii(t,"aria-owns")}}},ma=function(t,n){return function(t){var n=ua(t,(function(t){if(!Sr(t))return!1;var n=ei(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1}));return n.bind((function(t){var n=ei(t,"id"),e=zr(t);return fa(e,'[aria-owns="'+n+'"]')}))}(n).exists((function(n){return ga(t,n)}))},ga=function(t,n){return aa(n,(function(n){return je(n,t.element)}),k)||ma(t,n)},pa="unknown";!function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.LOGGING=2]="LOGGING"}(ra||(ra={}));var ha=oe({}),va=function(t,n,e){switch(Ht(ha.get(),t).orThunk((function(){var n=Dt(ha.get());return ft(n,(function(n){return t.indexOf(n)>-1?R.some(ha.get()[n]):R.none()}))})).getOr(ra.NORMAL)){case ra.NORMAL:return e(xa());case ra.LOGGING:var o=function(t,n){var e=[],o=(new Date).getTime();return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=(new Date).getTime();N(["mousemove","mouseover","mouseout",Po()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:U(e,(function(t){return N(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+ci(t.target)+")":t.outcome}))})}}}(t,n),r=e(o);return o.write(),r;case ra.STOP:return!0}},ba=["alloy/data/Fields","alloy/debugging/Debugging"],ya=function(t,n,e){return va(t,n,e)},xa=v({logEventCut:p,logEventStopped:p,logNoParent:p,logEventNoHandlers:p,logEventResponse:p,write:p}),wa=v([Mn("menu"),Mn("selectedMenu")]),Sa=v([Mn("item"),Mn("selectedItem")]);v(an(Sa().concat(wa())));var ka=v(an(Sa())),Ca=Hn("initSize",[Mn("numColumns"),Mn("numRows")]),Oa=function(){return Hn("markers",[Mn("backgroundMenu")].concat(wa()).concat(Sa()))},_a=function(t){return Hn("markers",U(t,Mn))},Ta=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");return J(n,(function(t){return t.indexOf("alloy")>0&&!L(ba,(function(n){return t.indexOf(n)>-1}))})).getOr(pa)}}(),Dn(n,n,e,Sn((function(t){return mt.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},Ea=function(t){return Ta(0,t,Xt(p))},Da=function(t){return Ta(0,t,Xt(R.none))},Ba=function(t){return Ta(0,t,{tag:"required",process:{}})},Aa=function(t){return Ta(0,t,{tag:"required",process:{}})},Ma=function(t,n){return Bn(t,v(n))},Fa=function(t){return Bn(t,b)},Ia=v(Ca),Ra=function(t,n,e,o,r,i,u,a){return void 0===a&&(a=!1),{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a}},Va=Ge([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Pa=Va.southeast,Ha=Va.southwest,za=Va.northeast,Na=Va.northwest,La=Va.south,ja=Va.north,Wa=Va.east,Ua=Va.west,Ga=function(t,n,e,o){var r=t+n;return r>o?e:r<e?o:r},Xa=function(t,n,e){return Math.min(Math.max(t,n),e)},qa=function(t,n){return ot(["left","right","top","bottom"],(function(e){return Ht(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)}))}))},Ya="layout",Ka=function(t){return t.x},Ja=function(t,n){return t.x+t.width/2-n.width/2},$a=function(t,n){return t.x+t.width-n.width},Qa=function(t,n){return t.y-n.height},Za=function(t){return t.y+t.height},tc=function(t,n){return t.y+t.height/2-n.height/2},nc=function(t,n,e){return Ra(Ka(t),Za(t),e.southeast(),Pa(),"southeast",qa(t,{left:1,top:3}),Ya)},ec=function(t,n,e){return Ra($a(t,n),Za(t),e.southwest(),Ha(),"southwest",qa(t,{right:0,top:3}),Ya)},oc=function(t,n,e){return Ra(Ka(t),Qa(t,n),e.northeast(),za(),"northeast",qa(t,{left:1,bottom:2}),Ya)},rc=function(t,n,e){return Ra($a(t,n),Qa(t,n),e.northwest(),Na(),"northwest",qa(t,{right:0,bottom:2}),Ya)},ic=function(t,n,e){return Ra(Ja(t,n),Qa(t,n),e.north(),ja(),"north",qa(t,{bottom:2}),Ya)},uc=function(t,n,e){return Ra(Ja(t,n),Za(t),e.south(),La(),"south",qa(t,{top:3}),Ya)},ac=function(t,n,e){return Ra(function(t){return t.x+t.width}(t),tc(t,n),e.east(),Wa(),"east",qa(t,{left:0}),Ya)},cc=function(t,n,e){return Ra(function(t,n){return t.x-n.width}(t,n),tc(t,n),e.west(),Ua(),"west",qa(t,{right:1}),Ya)},sc=function(){return[nc,ec,oc,rc,uc,ic,ac,cc]},fc=function(){return[ec,nc,rc,oc,uc,ic,ac,cc]},lc=function(){return[oc,rc,nc,ec,ic,uc]},dc=function(){return[rc,oc,ec,nc,ic,uc]},mc=function(){return[nc,ec,oc,rc,uc,ic]},gc=function(){return[ec,nc,rc,oc,uc,ic]},pc=Object.freeze({__proto__:null,events:function(t){return rr([ar(Bo(),(function(n,e){var o=t.channels,r=Dt(o),i=e,u=function(t,n){return n.universal?t:q(t,(function(t){return N(n.channels,t)}))}(r,i);G(u,(function(t){var e=o[t],r=e.schema,u=_n("channel["+t+"] data\nReceiver: "+ci(n.element),r,i.data);e.onReceive(n,u)}))}))])}}),hc=[Fn("channels",kn(mt.value,un([Ba("onReceive"),Yn("schema",dn())])))],vc=function(t,n,e){return vr((function(o,r){e(o,t,n)}))},bc=function(t,n,e){return function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ki(u.slice(0,1).concat(u.slice(3)))}},t}((function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:v(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(u,1);return n.apply(void 0,[o,t.config,t.state].concat(e))}))}),e,n)},yc=function(t){return{key:t,value:void 0}},xc=function(t,n,e,o,r,i,u){var a=function(t){return Nt(t,e)?t[e]():R.none()},c=Mt(r,(function(t,n){return bc(e,t,n)})),s=Mt(i,(function(t,n){return Ci(t,n)})),f=_(_(_({},s),c),{revoke:x(yc,e),config:function(n){var o=_n(e+"-config",t,n);return{key:e,value:{config:o,me:f,configAsRaw:Ut((function(){return _n(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:v(n),exhibit:function(t,n){return Zi(a(t),Ht(o,"exhibit"),(function(t,e){return e(n,t.config,t.state)})).getOrThunk((function(){return Ai({})}))},name:v(e),handlers:function(t){return a(t).map((function(t){return Ht(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return f},wc=function(t){return Ye(t)},Sc=un([Mn("fields"),Mn("name"),Yn("active",{}),Yn("apis",{}),Yn("state",Ei),Yn("extra",{})]),kc=function(t){var n=_n("Creating behaviour: "+t.name,Sc,t);return function(t,n,e,o,r,i){var u,a,c=un(t),s=qn(n,[(u="config",a=t,jn(u,un(a)))]);return xc(c,s,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},Cc=un([Mn("branchKey"),Mn("branches"),Mn("name"),Yn("active",{}),Yn("apis",{}),Yn("state",Ei),Yn("extra",{})]),Oc=function(t){var n=_n("Creating behaviour: "+t.name,Cc,t);return function(t,n,e,o,r,i){var u=t,a=qn(n,[jn("config",t)]);return xc(u,a,n,e,o,r,i)}(En(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},_c=v(void 0),Tc=kc({fields:hc,name:"receiving",active:pc}),Ec=Object.freeze({__proto__:null,exhibit:function(t,n){return Ai({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Dc=function(t){return t.dom.focus()},Bc=function(t){var n=zr(t).dom;return t.dom===n.activeElement},Ac=function(t){return void 0===t&&(t=ie.fromDom(document)),R.from(t.dom.activeElement).map(ie.fromDom)},Mc=function(t){return Ac(zr(t)).filter((function(n){return t.dom.contains(n.dom)}))},Fc=function(t,n){var e=zr(n),o=Ac(e).bind((function(t){var e,o,r=function(n){return je(t,n)};return r(n)?R.some(n):(e=r,(o=function(t){for(var n=0;n<t.childNodes.length;n++){var r=ie.fromDom(t.childNodes[n]);if(e(r))return R.some(r);var i=o(t.childNodes[n]);if(i.isSome())return i}return R.none()})(n.dom))})),r=t(n);return o.each((function(t){Ac(e).filter((function(n){return je(n,t)})).fold((function(){Dc(t)}),p)})),r},Ic=function(t,n,e,o,r){var i=function(t){return t+"px"};return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}},Rc=function(t,n){su(t,function(t){return _(_({},t),{position:R.some(t.position)})}(n))},Vc=Ge([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Pc=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=r-(a+u.width),f=i-(c+u.height),l=R.some(a),d=R.some(c),m=R.some(s),g=R.some(f),p=R.none();return function(t,n,e,o,r,i,u,a,c){return t.fold(n,e,o,r,i,u,a,c)}(n.direction,(function(){return Ic(t,l,d,p,p)}),(function(){return Ic(t,p,d,m,p)}),(function(){return Ic(t,l,p,p,g)}),(function(){return Ic(t,p,p,m,g)}),(function(){return Ic(t,l,d,p,p)}),(function(){return Ic(t,l,p,p,g)}),(function(){return Ic(t,l,d,p,p)}),(function(){return Ic(t,p,d,m,p)}))},Hc=function(t,n){return t.fold((function(){var t=n.rect;return Ic("absolute",R.some(t.x),R.some(t.y),R.none(),R.none())}),(function(t,e,o,r){return Pc("absolute",n,t,e,o,r)}),(function(t,e,o,r){return Pc("fixed",n,t,e,o,r)}))},zc=function(t,n){var e=x(Qu,n),o=t.fold(e,e,(function(){var t=Xu();return Qu(n).translate(-t.left,-t.top)})),r=ju(n),i=Iu(n);return Zu(o.left,o.top,r,i)},Nc=function(t,n){return n.fold((function(){return t.fold(ea,ea,Zu)}),(function(n){return t.fold(n,n,(function(){var e=n(),o=Lc(t,e.x,e.y);return Zu(o.left,o.top,e.width,e.height)}))}))},Lc=function(t,n,e){var o=Vu(n,e);return t.fold(v(o),v(o),(function(){var t=Xu();return o.translate(-t.left,-t.top)}))};Vc.none;var jc,Wc=Vc.relative,Uc=Vc.fixed,Gc=function(t,n){return function(t,n){return{anchorBox:t,origin:n}}(t,n)},Xc="data-alloy-placement",qc=function(t){return oi(t,Xc)},Yc=Ge([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Kc=function(t,n,e,o){var r=t.bubble,i=r.offset,u=function(t,n,e){var o=function(o,r){return n[o].map((function(n){var i="top"===o||"bottom"===o,u=i?e.top:e.left,a=("left"===o||"top"===o?Math.max:Math.min)(n,r)+u;return i?Xa(a,t.y,t.bottom):Xa(a,t.x,t.right)})).getOr(r)},r=o("left",t.x),i=o("top",t.y),u=o("right",t.right),a=o("bottom",t.bottom);return Zu(r,i,u-r,a-i)}(o,t.restriction,i),a=t.x+i.left,c=t.y+i.top,s=Zu(a,c,n,e),f=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.right,s=t.bottom,f=t.width,l=t.height;return{originInBounds:u>=e&&u<=r&&a>=o&&a<=i,sizeInBounds:c<=r&&c>=e&&s<=i&&s>=o,visibleW:Math.min(f,u>=e?r-u:c-e),visibleH:Math.min(l,a>=o?i-a:s-o)}}(s,u),l=f.originInBounds,d=f.sizeInBounds,m=f.visibleW,g=f.visibleH,p=l&&d,h=p?s:function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.width,s=t.height,f=Math.max(e,r-c),l=Math.max(o,i-s),d=Xa(u,e,f),m=Xa(a,o,l),g=Math.min(d+c,r)-d,p=Math.min(m+s,i)-m;return Zu(d,m,g,p)}(s,u),b=h.width>0&&h.height>0,y=function(t,n,e){var o=v(n.bottom-e.y),r=v(e.bottom-n.y),i=function(t,n,e,o){return t.fold(n,n,o,o,n,o,e,e)}(t,r,r,o),u=v(n.right-e.x),a=v(e.right-n.x),c=function(t,n,e,o){return t.fold(n,o,n,o,e,e,n,o)}(t,a,a,u);return{maxWidth:c,maxHeight:i}}(t.direction,h,o),x=y.maxWidth,w={rect:h,maxHeight:y.maxHeight,maxWidth:x,direction:t.direction,placement:t.placement,classes:{on:r.classesOn,off:r.classesOff},layout:t.label,testY:c};return p||t.alwaysFit?Yc.fit(w):Yc.nofit(w,m,g,b)},Jc=function(t){var n=oe(R.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(R.none())},isSet:function(){return n.get().isSome()},get:function(){return n.get()},set:function(t){e(),n.set(R.some(t))}}},$c=function(){return Jc((function(t){return t.unbind()}))},Qc=function(){var t=Jc(p);return _(_({},t),{on:function(n){return t.get().each(n)}})},Zc=C,ts=function(t,n,e){return function(t,n,e,o){return Uu(t,n,e,o,!1)}(t,n,Zc,e)},ns=function(t,n,e){return function(t,n,e,o){return Uu(t,n,e,o,!0)}(t,n,Zc,e)},es=Wu,os=["top","bottom","right","left"],rs="data-alloy-transition-timer",is=function(t,n){return function(t,n){return tt(n,(function(n){return Yi(t,n)}))}(t,n.classes)},us=function(t,n){var e=function(t){return parseFloat(t).toPrecision(3)};return Vt(n,(function(n,o){var r,i,u,a=t[o].map(e),c=n.map(e);return void 0===u&&(u=y),!Zi(r=a,i=c,u).getOr(r.isNone()&&i.isNone())})).isSome()},as=function(t,n){var e,o=$c(),i=$c(),u=function(n){var e,o=null!==(e=n.raw.pseudoElement)&&void 0!==e?e:"";return je(n.target,t)&&!pe(o)&&N(os,n.raw.propertyName)},a=function(r){if(f(r)||u(r)){o.clear(),i.clear();var a=null==r?void 0:r.raw.type;(f(a)||a===So())&&(clearTimeout(e),ii(t,rs),Ji(t,n.classes))}},c=function(){o.set(ts(t,So(),a)),i.set(ts(t,wo(),a))};if("ontransitionstart"in t.dom)var s=ts(t,ko(),(function(t){u(t)&&(s.unbind(),c())}));else c();var l=function(t){var n=function(n){var e=fu(t,n),o=r(e)?e.split(/\s*,\s*/):[];return q(o,pe)},e=function(t){if(r(t)&&/^[\d.]+/.test(t)){var n=parseFloat(t);return me(t,"ms")?n:1e3*n}return 0},o=n("transition-delay"),i=n("transition-duration");return K(i,(function(t,n,r){var i=e(o[r])+e(n);return Math.max(t,i)}),0)}(t);requestAnimationFrame((function(){e=setTimeout(a,l+17),ni(t,rs,e)}))},cs=function(t,n,e,o,r,i){var u=function(t,n,e){return e.exists((function(e){var o=t.mode;return"all"===o||e[o]!==n[o]}))}(o,r,i);if(u||is(t,o)){au(t,"position",e.position);var a=zc(n,t),c=Hc(n,_(_({},r),{rect:a})),s=ot(os,(function(t){return c[t]}));us(e,s)&&(su(t,s),u&&function(t,n){Ki(t,n.classes),oi(t,rs).each((function(n){clearTimeout(parseInt(n,10)),ii(t,rs)})),as(t,n)}(t,o),hu(t))}else Ji(t,o.classes)},ss=function(t,n,e,o){pu(n,"max-height"),pu(n,"max-width");var r,i={width:ju(r=n),height:Iu(r)};return function(t,n,e,o,r,i){var u=o.width,a=o.height,c=function(n,c,s,f,l){var d=n(e,o,r,t,i),m=Kc(d,u,a,i);return m.fold(v(m),(function(t,n,e,o){return(l===o?e>f||n>s:!l&&o)?m:Yc.nofit(c,s,f,l)}))},s=K(n,(function(t,n){var e=x(c,n);return t.fold(v(t),e)}),Yc.nofit({rect:e,maxHeight:o.height,maxWidth:o.width,direction:Pa(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:e.y},-1,-1,!1));return s.fold(b,b)}(n,o.preference,t,i,e,o.bounds)},fs=function(t,n){!function(t,n){ni(t,Xc,n)}(t,n.placement)},ls=function(t,n){!function(t,n){var e=Mu.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);au(t,"max-height",e+"px")}(t,Math.floor(n))},ds=v((function(t,n){ls(t,n),cu(t,{"overflow-x":"hidden","overflow-y":"auto"})})),ms=v((function(t,n){ls(t,n)})),gs=function(t,n,e){return void 0===t[n]?e:t[n]},ps=function(t,n,e,o){var r=ss(t,n,e,o);return function(t,n,e){var o=Hc(e.origin,n);e.transition.each((function(r){cs(t,e.origin,o,r,n,e.lastPlacement)})),Rc(t,o)}(n,r,o),fs(n,r),function(t,n){var e=n.classes;Ji(t,e.off),Ki(t,e.on)}(n,r),function(t,n,e){(0,e.maxHeightFunction)(t,n.maxHeight)}(n,r,o),function(t,n,e){(0,e.maxWidthFunction)(t,n.maxWidth)}(n,r,o),{layout:r.layout,placement:r.placement}},hs=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],vs=function(t,n,e,o){void 0===o&&(o=1);var r=t*o,i=n*o,u=function(t){return Ht(e,t).getOr([])},a=function(t,n,e){var o=et(hs,e);return{offset:Vu(t,n),classesOn:Z(e,u),classesOff:Z(o,u)}};return{southeast:function(){return a(-t,n,["top","alignLeft"])},southwest:function(){return a(t,n,["top","alignRight"])},south:function(){return a(-t/2,n,["top","alignCentre"])},northeast:function(){return a(-t,-n,["bottom","alignLeft"])},northwest:function(){return a(t,-n,["bottom","alignRight"])},north:function(){return a(-t/2,-n,["bottom","alignCentre"])},east:function(){return a(t,-n/2,["valignCentre","left"])},west:function(){return a(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return a(r,i,["top","alignLeft","inset"])},insetNorthwest:function(){return a(-r,i,["top","alignRight","inset"])},insetNorth:function(){return a(-r/2,i,["top","alignCentre","inset"])},insetSoutheast:function(){return a(r,-i,["bottom","alignLeft","inset"])},insetSouthwest:function(){return a(-r,-i,["bottom","alignRight","inset"])},insetSouth:function(){return a(-r/2,-i,["bottom","alignCentre","inset"])},insetEast:function(){return a(-r,-i/2,["valignCentre","right","inset"])},insetWest:function(){return a(r,-i/2,["valignCentre","left","inset"])}}},bs=function(){return vs(0,0,{})},ys=b,xs=function(t,n){return function(e){return"rtl"===ws(e)?n:t}},ws=function(t){return"rtl"===fu(t,"direction")?"rtl":"ltr"};!function(t){t.TopToBottom="toptobottom",t.BottomToTop="bottomtotop"}(jc||(jc={}));var Ss="data-alloy-vertical-dir",ks=function(t){return aa(t,(function(t){return Sr(t)&&ei(t,"data-alloy-vertical-dir")===jc.BottomToTop}))},Cs=function(){return qn("layouts",[Mn("onLtr"),Mn("onRtl"),Ln("onBottomLtr"),Ln("onBottomRtl")])},Os=function(t,n,e,o,r,i,u){var a=u.map(ks).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),f=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),l=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o);return xs(f,l)(t)},_s=[Mn("hotspot"),Ln("bubble"),Yn("overrides",{}),Cs(),Ma("placement",(function(t,n,e){var o=n.hotspot,r=zc(e,o.element),i=Os(t.element,n,mc(),gc(),lc(),dc(),R.some(n.hotspot.element));return R.some(ys({anchorBox:r,bubble:n.bubble.getOr(bs()),overrides:n.overrides,layouts:i,placer:R.none()}))}))],Ts=[Mn("x"),Mn("y"),Yn("height",0),Yn("width",0),Yn("bubble",bs()),Yn("overrides",{}),Cs(),Ma("placement",(function(t,n,e){var o=Lc(e,n.x,n.y),r=Zu(o.left,o.top,n.width,n.height),i=Os(t.element,n,sc(),fc(),sc(),fc(),R.none());return R.some(ys({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:R.none()}))}))],Es=Ge([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Ds=function(t){return t.fold(b,(function(t,n,e){return t.translate(-n,-e)}))},Bs=function(t){return t.fold(b,b)},As=function(t){return K(t,(function(t,n){return t.translate(n.left,n.top)}),Vu(0,0))},Ms=function(t){var n=U(t,Bs);return As(n)},Fs=Es.screen,Is=Es.absolute,Rs=function(t,n,e){var o=_r(t.element),r=Xu(o),i=function(t,n,e){var o=Dr(e.root).dom;return R.from(o.frameElement).map(ie.fromDom).filter((function(n){var e=_r(n),o=_r(t.element);return je(e,o)})).map(Hu)}(t,0,e).getOr(r);return Is(i,r.left,r.top)},Vs=function(t,n,e,o){var r=Fs(Vu(t,n));return R.some(function(t,n,e){return{point:t,width:n,height:e}}(r,e,o))},Ps=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c=[n,t.point],s=(i=function(){return Ms(c)},u=function(){return Ms(c)},a=function(){return function(t){var n=U(t,Ds);return As(n)}(c)},o.fold(i,u,a)),f=function(t,n,e,o){return{x:t,y:n,width:e,height:o}}(s.left,s.top,t.width,t.height),l=e.showAbove?lc():mc(),d=e.showAbove?dc():gc(),m=Os(r,e,l,d,l,d,R.none());return ys({anchorBox:f,bubble:e.bubble.getOr(bs()),overrides:e.overrides,layouts:m,placer:R.none()})}))},Hs=[Mn("node"),Mn("root"),Ln("bubble"),Cs(),Yn("overrides",{}),Yn("showAbove",!1),Ma("placement",(function(t,n,e){var o=Rs(t,0,n);return n.node.filter(eu).bind((function(r){var i=r.dom.getBoundingClientRect(),u=Vs(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return Ps(u,o,n,e,a)}))}))],zs=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Ns=Ge([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ls=(Ns.before,Ns.on,Ns.after,function(t){return t.fold(b,b,b)}),js=Ge([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ws={domRange:js.domRange,relative:js.relative,exact:js.exact,exactFromRange:function(t){return js.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=function(t){return t.match({domRange:function(t){return ie.fromDom(t.startContainer)},relative:function(t,n){return Ls(t)},exact:function(t,n,e,o){return t}})}(t);return Dr(n)},range:zs},Us=function(t,n,e){var o,r=t.document.createRange();return o=r,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),function(t,n){n.fold((function(n){t.setEndBefore(n.dom)}),(function(n,e){t.setEnd(n.dom,e)}),(function(n){t.setEndAfter(n.dom)}))}(r,e),r},Gs=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Xs=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},qs=Ge([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ys=function(t,n,e){return n(ie.fromDom(e.startContainer),e.startOffset,ie.fromDom(e.endContainer),e.endOffset)},Ks=function(t,n){var e=function(t,n){return n.match({domRange:function(t){return{ltr:v(t),rtl:R.none}},relative:function(n,e){return{ltr:Ut((function(){return Us(t,n,e)})),rtl:Ut((function(){return R.some(Us(t,e,n))}))}},exact:function(n,e,o,r){return{ltr:Ut((function(){return Gs(t,n,e,o,r)})),rtl:Ut((function(){return R.some(Gs(t,o,r,n,e))}))}}})}(t,n);return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return qs.rtl(ie.fromDom(t.endContainer),t.endOffset,ie.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ys(0,qs.ltr,e)})):Ys(0,qs.ltr,e)}(0,e)},Js=function(t,n){return Ks(t,n).match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})};qs.ltr,qs.rtl;var $s,Qs=function(t,n){var e=function(n){return t(n)?R.from(n.dom.nodeValue):R.none()};return{get:function(o){if(!t(o))throw new Error("Can only get "+n+" value of a "+n+" node");return e(o).getOr("")},getOption:e,set:function(e,o){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=o}}}(kr,"text"),Zs=function(t){return Qs.getOption(t)},tf=["img","br"],nf=function(t){var n=Zs(t).filter((function(t){return 0!==t.trim().length||t.indexOf(" ")>-1})).isSome();return n||N(tf,xr(t))},ef=function(t,n){var e=function(t){for(var o=Mr(t),r=o.length-1;r>=0;r--){var i=o[r];if(n(i))return R.some(i);var u=e(i);if(u.isSome())return u}return R.none()};return e(t)},of=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return Le(e)?[]:U(e.querySelectorAll(t),ie.fromDom)}(n,t)},rf=function(t,n,e,o){var r=function(t,n,e,o){var r=_r(t).dom.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r}(t,n,e,o),i=je(t,e)&&n===o;return r.collapsed&&!i},uf=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return R.some(zs(ie.fromDom(n.startContainer),n.startOffset,ie.fromDom(e.endContainer),e.endOffset))}return R.none()},af=function(t){if(null===t.anchorNode||null===t.focusNode)return uf(t);var n=ie.fromDom(t.anchorNode),e=ie.fromDom(t.focusNode);return rf(n,t.anchorOffset,e,t.focusOffset)?R.some(zs(n,t.anchorOffset,e,t.focusOffset)):uf(t)},cf=function(t){return function(t){return R.from(t.getSelection())}(t).filter((function(t){return t.rangeCount>0})).bind(af)},sf=function(t,n){return function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?R.some(e).map(Xs):R.none()}(Js(t,n))},ff=function(t,n){return function(t){var n=t.getBoundingClientRect();return n.width>0||n.height>0?R.some(n).map(Xs):R.none()}(Js(t,n))},lf=function(t,n){return{element:t,offset:n}},df=function(t,n){var e=Mr(t);if(0===e.length)return lf(t,n);if(n<e.length)return lf(e[n],0);var o=e[e.length-1],r=kr(o)?function(t){return Qs.get(t)}(o).length:Mr(o).length;return lf(o,r)},mf=function(t,n){return kr(t)?lf(t,n):df(t,n)},gf=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return cf(t)}}))().map((function(t){var n=mf(t.start,t.soffset),e=mf(t.finish,t.foffset);return Ws.range(n.element,n.offset,e.element,e.offset)}))},pf=[Ln("getSelection"),Mn("root"),Ln("bubble"),Cs(),Yn("overrides",{}),Yn("showAbove",!1),Ma("placement",(function(t,n,e){var o=Dr(n.root).dom,r=Rs(t,0,n),i=gf(o,n).bind((function(t){var n=ff(o,Ws.exactFromRange(t)).orThunk((function(){var n=ie.fromText("\ufeff");Ur(t.start,n);var e=sf(o,Ws.exact(n,0,n,1));return Jr(n),e}));return n.bind((function(t){return Vs(t.left,t.top,t.width,t.height)}))})),u=gf(o,n).bind((function(t){return Sr(t.start)?R.some(t.start):function(t){return Br(t)}(t.start)})),a=u.getOr(t.element);return Ps(i,r,n,e,a)}))],hf="link-layout",vf=function(t){return t.x+t.width},bf=function(t,n){return t.x-n.width},yf=function(t,n){return t.y-n.height+t.height},xf=function(t){return t.y},wf=function(t,n,e){return Ra(vf(t),xf(t),e.southeast(),Pa(),"southeast",qa(t,{left:0,top:2}),hf)},Sf=function(t,n,e){return Ra(bf(t,n),xf(t),e.southwest(),Ha(),"southwest",qa(t,{right:1,top:2}),hf)},kf=function(t,n,e){return Ra(vf(t),yf(t,n),e.northeast(),za(),"northeast",qa(t,{left:0,bottom:3}),hf)},Cf=function(t,n,e){return Ra(bf(t,n),yf(t,n),e.northwest(),Na(),"northwest",qa(t,{right:1,bottom:3}),hf)},Of=function(){return[wf,Sf,kf,Cf]},_f=function(){return[Sf,wf,Cf,kf]},Tf=[Mn("item"),Cs(),Yn("overrides",{}),Ma("placement",(function(t,n,e){var o=zc(e,n.item.element),r=Os(t.element,n,Of(),_f(),Of(),_f(),R.none());return R.some(ys({anchorBox:o,bubble:bs(),overrides:n.overrides,layouts:r,placer:R.none()}))}))],Ef=En("type",{selection:pf,node:Hs,hotspot:_s,submenu:Tf,makeshift:Ts}),Df=[Nn("classes",pn),Qn("mode","all",["all","layout","placement"])],Bf=[Yn("useFixed",k),Ln("getBounds")],Af=[Fn("anchor",Ef),qn("transition",Df)],Mf=function(t,n,e,o,r,i,u){return function(t,n,e,o,r,i,u,a){var c=gs(u,"maxHeightFunction",ds()),s=gs(u,"maxWidthFunction",p),f=t.anchorBox,l=t.origin,d={bounds:Nc(l,i),origin:l,preference:o,maxHeightFunction:c,maxWidthFunction:s,lastPlacement:r,transition:a};return ps(f,n,e,d)}(Gc(e.anchorBox,n),r.element,e.bubble,e.layouts,i,o,e.overrides,u)},Ff=function(t,n,e,o,r,i){var u=i.map(ta);return If(t,n,e,o,r,u)},If=function(t,n,e,o,r,i){var u=_n("placement.info",an(Af),r),a=u.anchor,c=o.element,s=e.get(o.uid);Fc((function(){au(c,"position","fixed");var r=du(c,"visibility");au(c,"visibility","hidden");var f,l=n.useFixed()?(f=document.documentElement,Uc(0,0,f.clientWidth,f.clientHeight)):function(t){var n=Hu(t.element),e=t.element.dom.getBoundingClientRect();return Wc(n.left,n.top,e.width,e.height)}(t),d=a.placement,m=i.map(v).or(n.getBounds);d(t,a,l).each((function(n){var r=n.placer.getOr(Mf)(t,l,n,m,o,s,u.transition);e.set(o.uid,r)})),r.fold((function(){pu(c,"visibility")}),(function(t){au(c,"visibility",t)})),du(c,"left").isNone()&&du(c,"top").isNone()&&du(c,"right").isNone()&&du(c,"bottom").isNone()&&$i(du(c,"position"),"fixed")&&pu(c,"position")}),c)},Rf=Object.freeze({__proto__:null,position:function(t,n,e,o,r){Ff(t,n,e,o,r,R.none())},positionWithin:Ff,positionWithinBounds:If,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"},reset:function(t,n,e,o){var r=o.element;G(["position","left","right","top","bottom"],(function(t){return pu(r,t)})),function(t){ii(t,Xc)}(r),e.clear(o.uid)}}),Vf=Object.freeze({__proto__:null,init:function(){var t={};return Di({readState:function(){return t},clear:function(n){l(n)?delete t[n]:t={}},set:function(n,e){t[n]=e},get:function(n){return Ht(t,n)}})}}),Pf=kc({fields:Bf,name:"positioning",active:Ec,apis:Rf,state:Vf}),Hf=function(t){Qo(t,Wo());var n=t.components();G(n,Hf)},zf=function(t){var n=t.components();G(n,zf),Qo(t,jo())},Nf=function(t,n){qr(t.element,n.element)},Lf=function(t,n){var e=t.components();!function(t){G(t.components(),(function(t){return Jr(t.element)})),Kr(t.element),t.syncComponents()}(t);var o=et(e,n);G(o,(function(n){Hf(n),t.getSystem().removeFromWorld(n)})),G(n,(function(n){n.getSystem().isConnected()?Nf(t,n):(t.getSystem().addToWorld(n),Nf(t,n),eu(t.element)&&zf(n)),t.syncComponents()}))},jf=function(t,n){Wf(t,n,qr)},Wf=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),eu(t.element)&&zf(n),t.syncComponents()},Uf=function(t){Hf(t),Jr(t.element),t.getSystem().removeFromWorld(t)},Gf=function(t){var n=Br(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));Uf(t),n.each((function(t){t.syncComponents()}))},Xf=function(t){var n=t.components();G(n,Uf),Kr(t.element),t.syncComponents()},qf=function(t,n){Yf(t,n,qr)},Yf=function(t,n,e){e(t,n.element);var o=Mr(n.element);G(o,(function(t){n.getByDom(t).each(zf)}))},Kf=function(t){var n=Mr(t.element);G(n,(function(n){t.getByDom(n).each(Hf)})),Jr(t.element)},Jf=function(t,n,e,o){e.get().each((function(n){Xf(t)}));var r=n.getAttachPoint(t);jf(r,t);var i=t.getSystem().build(o);return jf(t,i),e.set(i),i},$f=function(t,n,e,o){var r=Jf(t,n,e,o);return n.onOpen(t,r),r},Qf=function(t,n,e){e.get().each((function(o){Xf(t),Gf(t),n.onClose(t,o),e.clear()}))},Zf=function(t,n,e){return e.isOpen()},tl=function(t,n,e){var o=n.getAttachPoint(t);au(t.element,"position",Pf.getMode(o)),function(t,n,e,o){du(t.element,n).fold((function(){ii(t.element,e)}),(function(n){ni(t.element,e,n)})),au(t.element,n,o)}(t,"visibility",n.cloakVisibilityAttr,"hidden")},nl=function(t,n,e){(function(t){return L(["top","left","right","bottom"],(function(n){return du(t,n).isSome()}))})(t.element)||pu(t.element,"position"),function(t,n,e){oi(t.element,e).fold((function(){return pu(t.element,n)}),(function(e){return au(t.element,n,e)}))}(t,"visibility",n.cloakVisibilityAttr)},el=Object.freeze({__proto__:null,cloak:tl,decloak:nl,open:$f,openWhileCloaked:function(t,n,e,o,r){tl(t,n),$f(t,n,e,o),r(),nl(t,n)},close:Qf,isOpen:Zf,isPartOf:function(t,n,e,o){return Zf(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return Jf(t,n,e,o)}))}}),ol=Object.freeze({__proto__:null,events:function(t,n){return rr([ar(Ro(),(function(e,o){Qf(e,t,n)}))])}}),rl=[Ea("onOpen"),Ea("onClose"),Mn("isPartOf"),Mn("getAttachPoint"),Yn("cloakVisibilityAttr","data-precloak-visibility")],il=Object.freeze({__proto__:null,init:function(){var t=Qc(),n=v("not-implemented");return Di({readState:n,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})}}),ul=kc({fields:rl,name:"sandboxing",active:ol,apis:el,state:il}),al=v("dismiss.popups"),cl=v("reposition.popups"),sl=v("mouse.released"),fl=un([Yn("isExtraPart",k),qn("fireEventInstead",[Yn("event",Uo())])]),ll=function(t){var n,e=_n("Dismissal",fl,t);return(n={})[al()]={schema:un([Mn("target")]),onReceive:function(t,n){ul.isOpen(t)&&(ul.isPartOf(t,n.target)||e.isExtraPart(t,n.target)||e.fireEventInstead.fold((function(){return ul.close(t)}),(function(n){return Qo(t,n.event)})))}},n},dl=un([qn("fireEventInstead",[Yn("event",Go())]),Pn("doReposition")]),ml=function(t){var n,e=_n("Reposition",dl,t);return(n={})[cl()]={onReceive:function(t){ul.isOpen(t)&&e.fireEventInstead.fold((function(){return e.doReposition(t)}),(function(n){return Qo(t,n.event)}))}},n},gl=function(t,n,e){n.store.manager.onLoad(t,n,e)},pl=function(t,n,e){n.store.manager.onUnload(t,n,e)},hl=Object.freeze({__proto__:null,onLoad:gl,onUnload:pl,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),vl=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[pr((function(e,o){gl(e,t,n)})),hr((function(e,o){pl(e,t,n)}))]:[vc(t,n,gl)];return rr(e)}}),bl=function(){var t=oe(null);return Di({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},yl=function(){var t=oe({}),n=oe({});return Di({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return Ht(t.get(),e).orThunk((function(){return Ht(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};G(e,(function(t){i[t.value]=t,Ht(t,"meta").each((function(n){Ht(n,"text").each((function(n){u[n]=t}))}))})),t.set(_(_({},o),i)),n.set(_(_({},r),u))},clear:function(){t.set({}),n.set({})}})},xl=Object.freeze({__proto__:null,memory:bl,dataset:yl,manual:function(){return Di({readState:p})},init:function(t){return t.store.manager.state(t)}}),wl=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Sl=[Ln("initialValue"),Mn("getFallbackEntry"),Mn("getDataKey"),Mn("setValue"),Ma("manager",{setValue:wl,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk((function(){return o.getFallbackEntry(r)}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){wl(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:yl})],kl=[Mn("getValue"),Yn("setValue",p),Ln("initialValue"),Ma("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:p,state:Ei.init})],Cl=[Ln("initialValue"),Ma("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:bl})],Ol=[Kn("store",{mode:"memory"},En("mode",{memory:Cl,manual:kl,dataset:Sl})),Ea("onSetValue"),Yn("resetOnDom",!1)],_l=kc({fields:Ol,name:"representing",active:vl,apis:hl,extra:{setValueFrom:function(t,n){var e=_l.getValue(n);_l.setValue(t,e)}},state:xl}),Tl=function(t,n){return ee(t,{},U(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,Dn(e,e,{tag:"option",process:{}},Qt((function(t){return wt("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([Bn("dump",b)]))},El=function(t){return t.dump},Dl=function(t,n){return _(_({},t.dump),wc(n))},Bl=Tl,Al=Dl,Ml="placeholder",Fl=Ge([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Il=function(t){return zt(t,"uiType")},Rl=function(t,n,e,o){return Il(e)&&e.uiType===Ml?function(t,n,e,o){return t.exists((function(t){return t!==e.owner}))?Fl.single(!0,v(e)):Ht(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+Dt(o)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(t){return t.replace()}))}(t,0,e,o):Fl.single(!1,v(e))},Vl=function(t,n,e,o){return Rl(t,0,e,o).fold((function(r,i){var u=Il(e)?i(n,e.config,e.validated):i(n),a=Ht(u,"components").getOr([]),c=Z(a,(function(e){return Vl(t,n,e,o)}));return[_(_({},u),{components:c})]}),(function(t,o){if(Il(e)){var r=o(n,e.config,e.validated);return e.validated.preprocess.getOr(b)(r)}return o(n)}))},Pl=function(t,n,e,o){var r=Mt(o,(function(t,n){return o=t,r=!1,{name:v(e=n),required:function(){return o.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r})),i=function(t,n,e,o){return Z(e,(function(e){return Vl(t,n,e,o)}))}(t,n,e,r);return At(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),i},Hl=Fl.single,zl=Fl.multiple,Nl=v(Ml),Ll=Ge([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),jl=Yn("factory",{sketch:b}),Wl=Yn("schema",[]),Ul=Mn("name"),Gl=Dn("pname","pname",Gt((function(t){return"<alloy."+di(t.name)+">"})),dn()),Xl=Bn("schema",(function(){return[Ln("preprocess")]})),ql=Yn("defaults",v({})),Yl=Yn("overrides",v({})),Kl=an([jl,Wl,Ul,Gl,ql,Yl]),Jl=an([jl,Wl,Ul,ql,Yl]),$l=an([jl,Wl,Ul,Gl,ql,Yl]),Ql=an([jl,Xl,Ul,Mn("unit"),Gl,ql,Yl]),Zl=function(t){return t.fold(R.some,R.none,R.some,R.some)},td=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},nd=function(t,n){return function(e){var o=_n("Converting part type",n,e);return t(o)}},ed=nd(Ll.required,Kl),od=nd(Ll.external,Jl),rd=nd(Ll.optional,$l),id=nd(Ll.group,Ql),ud=v("entirety"),ad=Object.freeze({__proto__:null,required:ed,external:od,optional:rd,group:id,asNamedPart:Zl,name:td,asCommon:function(t){return t.fold(b,b,b,b)},original:ud}),cd=function(t,n,e,o){return jt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},sd=function(t,n){var e={};return G(n,(function(n){Zl(n).each((function(n){var o=fd(t,n.pname);e[n.name]=function(e){var r=_n("Part: "+n.name+" in "+t,an(n.schema),e);return _(_({},o),{config:e,validated:r})}}))})),e},fd=function(t,n){return{uiType:Nl(),owner:t,name:n}},ld=function(t,n,e){return{uiType:Nl(),owner:t,name:n,config:e,validated:{}}},dd=function(t){return Z(t,(function(t){return t.fold(R.none,R.some,R.none,R.none).map((function(t){return Hn(t.name,t.schema.concat([Fa(ud())]))})).toArray()}))},md=function(t){return U(t,td)},gd=function(t,n,e){return function(t,n,e){var o={},r={};return G(e,(function(t){t.fold((function(t){o[t.pname]=Hl(!0,(function(n,e,o){return t.factory.sketch(cd(n,t,e,o))}))}),(function(t){var e=n.parts[t.name];r[t.name]=v(t.factory.sketch(cd(n,t,e[ud()]),e))}),(function(t){o[t.pname]=Hl(!1,(function(n,e,o){return t.factory.sketch(cd(n,t,e,o))}))}),(function(t){o[t.pname]=zl(!0,(function(n,e,o){var r=n[t.name];return U(r,(function(e){return t.factory.sketch(jt(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:v(o),externals:v(r)}}(0,n,e)},pd=function(t,n,e){return Pl(R.some(t),n,n.components,e)},hd=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},vd=function(t,n,e){return hd(t,n,e).getOrDie("Could not find part: "+e)},bd=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return G(e,(function(t){o[t]=v(i.getByUid(r[t]))})),o},yd=function(t,n){var e=t.getSystem();return Mt(n.partUids,(function(t,n){return v(e.getByUid(t))}))},xd=function(t){return Dt(t.partUids)},wd=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return G(e,(function(t){o[t]=v(i.getByUid(r[t]).getOrDie())})),o},Sd=function(t,n){var e=md(n);return Ye(U(e,(function(n){return{key:n,value:t+"-"+n}})))},kd=function(t){return Dn("partUids","partUids",qt((function(n){return Sd(n.uid,t)})),dn())},Cd=Object.freeze({__proto__:null,generate:sd,generateOne:ld,schemas:dd,names:md,substitutes:gd,components:pd,defaultUids:Sd,defaultUidsSchema:kd,getAllParts:yd,getAllPartNames:xd,getPart:hd,getPartOrDie:vd,getParts:bd,getPartsOrDie:wd}),Od=function(t,n,e,o,r){var i=function(t,n){return(t.length>0?[Hn("parts",t)]:[]).concat([Mn("uid"),Yn("dom",{}),Yn("components",[]),Fa("originalSpec"),Yn("debug.sketcher",{})]).concat(n)}(o,r);return _n(t+" [SpecSchema]",un(i.concat(n)),e)},_d=function(t,n,e,o,r){var i=Td(r),u=dd(e),a=kd(e),c=Od(t,n,i,u,[a]),s=gd(0,c,e);return o(c,pd(t,c,s.internals()),i,s.externals())},Td=function(t){return function(t){return zt(t,"uid")}(t)?t:_(_({},t),{uid:yi("uid")})},Ed=un([Mn("name"),Mn("factory"),Mn("configFields"),Yn("apis",{}),Yn("extraApis",{})]),Dd=un([Mn("name"),Mn("factory"),Mn("configFields"),Mn("partFields"),Yn("apis",{}),Yn("extraApis",{})]),Bd=function(t){var n=_n("Sketcher for "+t.name,Ed,t),e=Mt(n.apis,Ti),o=Mt(n.extraApis,(function(t,n){return Ci(t,n)}));return _(_({name:n.name,configFields:n.configFields,sketch:function(t){return function(t,n,e,o){var r=Td(o);return e(Od(t,n,r,[],[]),r)}(n.name,n.configFields,n.factory,t)}},e),o)},Ad=function(t){var n=_n("Sketcher for "+t.name,Dd,t),e=sd(n.name,n.partFields),o=Mt(n.apis,Ti),r=Mt(n.extraApis,(function(t,n){return Ci(t,n)}));return _(_({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return _d(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},Md=function(t){return"input"===xr(t)&&"radio"!==ei(t,"type")||"textarea"===xr(t)},Fd=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),Id=[Mn("find")],Rd=kc({fields:Id,name:"composing",apis:Fd}),Vd=["input","button","textarea","select"],Pd=function(t,n,e){(n.disabled()?Wd:Ud)(t,n)},Hd=function(t,n){return!0===n.useNative&&N(Vd,xr(t.element))},zd=function(t){ni(t.element,"disabled","disabled")},Nd=function(t){ii(t.element,"disabled")},Ld=function(t){ni(t.element,"aria-disabled","true")},jd=function(t){ni(t.element,"aria-disabled","false")},Wd=function(t,n,e){n.disableClass.each((function(n){Gi(t.element,n)})),(Hd(t,n)?zd:Ld)(t),n.onDisabled(t)},Ud=function(t,n,e){n.disableClass.each((function(n){qi(t.element,n)})),(Hd(t,n)?Nd:jd)(t),n.onEnabled(t)},Gd=function(t,n){return Hd(t,n)?function(t){return ri(t.element,"disabled")}(t):function(t){return"true"===ei(t.element,"aria-disabled")}(t)},Xd=Object.freeze({__proto__:null,enable:Ud,disable:Wd,isDisabled:Gd,onLoad:Pd,set:function(t,n,e,o){(o?Wd:Ud)(t,n)}}),qd=Object.freeze({__proto__:null,exhibit:function(t,n){return Ai({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return rr([ir(Ao(),(function(n,e){return Gd(n,t)})),vc(t,n,Pd)])}}),Yd=[te("disabled",k),Yn("useNative",!0),Ln("disableClass"),Ea("onDisabled"),Ea("onEnabled")],Kd=kc({fields:Yd,name:"disabling",active:qd,apis:Xd}),Jd=function(t,n,e,o){var r=of(t.element,"."+n.highlightClass);G(r,(function(e){L(o,(function(t){return t.element===e}))||(qi(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Qo(e,$o())})))}))},$d=function(t,n,e,o){Jd(t,n,0,[o]),Qd(t,n,e,o)||(Gi(o.element,n.highlightClass),n.onHighlight(t,o),Qo(o,Jo()))},Qd=function(t,n,e,o){return Yi(o.element,n.highlightClass)},Zd=function(t,n,e,o){var r=of(t.element,"."+n.itemClass);return R.from(r[o]).fold((function(){return mt.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)},tm=function(t,n,e){return fa(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},nm=function(t,n,e){var o=of(t.element,"."+n.itemClass);return(o.length>0?R.some(o[o.length-1]):R.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},em=function(t,n,e,o){var r=of(t.element,"."+n.itemClass),i=$(r,(function(t){return Yi(t,n.highlightClass)}));return i.bind((function(n){var e=Ga(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},om=function(t,n,e){var o=of(t.element,"."+n.itemClass);return Qi(U(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},rm=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return Jd(t,n,0,[])},dehighlight:function(t,n,e,o){Qd(t,n,e,o)&&(qi(o.element,n.highlightClass),n.onDehighlight(t,o),Qo(o,$o()))},highlight:$d,highlightFirst:function(t,n,e){tm(t,n).each((function(o){$d(t,n,e,o)}))},highlightLast:function(t,n,e){nm(t,n).each((function(o){$d(t,n,e,o)}))},highlightAt:function(t,n,e,o){Zd(t,n,e,o).fold((function(t){throw t}),(function(o){$d(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=om(t,n);J(r,o).each((function(o){$d(t,n,e,o)}))},isHighlighted:Qd,getHighlighted:function(t,n,e){return fa(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:tm,getLast:nm,getPrevious:function(t,n,e){return em(t,n,0,-1)},getNext:function(t,n,e){return em(t,n,0,1)},getCandidates:om}),im=[Mn("highlightClass"),Mn("itemClass"),Ea("onHighlight"),Ea("onDehighlight")],um=kc({fields:im,name:"highlighting",apis:rm}),am=[8],cm=[9],sm=[13],fm=[27],lm=[32],dm=[37],mm=[38],gm=[39],pm=[40],hm=function(t,n,e){var o=nt(t.slice(0,n)),r=nt(t.slice(n+1));return J(o.concat(r),e)},vm=function(t,n,e){var o=nt(t.slice(0,n));return J(o,e)},bm=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return J(r.concat(o),e)},ym=function(t,n,e){var o=t.slice(n+1);return J(o,e)},xm=function(t){return function(n){var e=n.raw;return N(t,e.which)}},wm=function(t){return function(n){return tt(t,(function(t){return t(n)}))}},Sm=function(t){return!0===t.raw.shiftKey},km=function(t){return!0===t.raw.ctrlKey},Cm=w(Sm),Om=function(t,n){return{matches:t,classification:n}},_m=function(t,n,e){n.exists((function(t){return e.exists((function(n){return je(n,t)}))}))||Zo(t,Xo(),{prevFocus:n,newFocus:e})},Tm=function(){var t=function(t){return Mc(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);_m(n,o,r)}}},Em=function(){var t=function(t){return um.getHighlighted(t).map((function(t){return t.element}))};return{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(p,(function(t){um.highlight(n,t)}));var r=t(n);_m(n,o,r)}}};!function(t){t.OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi"}($s||($s={}));var Dm,Bm=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u,a,c=e(t,n,o,r);return(i=c,u=n.event,a=J(i,(function(t){return t.matches(u)})),a.map((function(t){return t.classification}))).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([Yn("focusManager",Tm()),Kn("focusInside","onFocus",Sn((function(t){return N(["onFocus","onEnterOrSpace","onApi"],t)?mt.value(t):mt.error("Invalid value for focusInside")}))),Ma("handler",u),Ma("state",n),Ma("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==$s.OnFocusMode?R.none():r(t).map((function(e){return ar(To(),(function(o,r){e(o,t,n),r.stop()}))})),a=[ar(ho(),(function(o,u){i(o,u,e,t,n).fold((function(){!function(e,o){var i=xm(lm.concat(sm))(o.event);t.focusInside===$s.OnEnterOrSpaceMode&&i&&Ze(e,o)&&r(t).each((function(r){r(e,t,n),o.stop()}))}(o,u)}),(function(t){u.stop()}))})),ar(vo(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))];return rr(u.toArray().concat(a))}};return u},Am=function(t){var n=[Ln("onEscape"),Ln("onEnter"),Yn("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Yn("firstTabstop",0),Yn("useTabstopAt",C),Ln("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return la(n,t)})).getOr(n);return Fu(e)>0},o=function(t,n,o){(function(t,n){var o=of(t.element,n.selector),r=q(o,(function(t){return e(n,t)}));return R.from(r[n.firstTabstop])})(t,n).each((function(e){n.focusManager.set(t,e)}))},r=function(t,n,o,r,i){return i(n,o,(function(t){return function(t,n){return e(t,n)&&t.useTabstopAt(n)}(r,t)})).fold((function(){return r.cyclic?R.some(!0):R.none()}),(function(n){return r.focusManager.set(t,n),R.some(!0)}))},i=function(t,n,e,o){var i=of(t.element,e.selector);return function(t,n){return n.focusManager.get(t).bind((function(t){return la(t,n.selector)}))}(t,e).bind((function(n){return $(i,x(je,n)).bind((function(n){return r(t,i,n,e,o)}))}))},u=v([Om(wm([Sm,xm(cm)]),(function(t,n,e){var o=e.cyclic?hm:vm;return i(t,0,e,o)})),Om(xm(cm),(function(t,n,e){var o=e.cyclic?bm:ym;return i(t,0,e,o)})),Om(xm(fm),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),Om(wm([Cm,xm(sm)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),a=v([]);return Bm(n,Ei.init,u,a,(function(){return R.some(o)}))},Mm=Am(Bn("cyclic",k)),Fm=Am(Bn("cyclic",C)),Im=function(t,n,e){return Md(e)&&xm(lm)(n.event)?R.none():function(t,n,e){return nr(t,e,Ao()),R.some(!0)}(t,0,e)},Rm=function(t,n){return R.some(!0)},Vm=[Yn("execute",Im),Yn("useSpace",!1),Yn("useEnter",!0),Yn("useControlEnter",!1),Yn("useDown",!1)],Pm=function(t,n,e){return e.execute(t,n,t.element)},Hm=Bm(Vm,Ei.init,(function(t,n,e,o){var r=e.useSpace&&!Md(t.element)?lm:[],i=e.useEnter?sm:[],u=e.useDown?pm:[],a=r.concat(i).concat(u);return[Om(xm(a),Pm)].concat(e.useControlEnter?[Om(wm([km,xm(sm)]),Pm)]:[])}),(function(t,n,e,o){return e.useSpace&&!Md(t.element)?[Om(xm(lm),Rm)]:[]}),(function(){return R.none()})),zm=function(){var t=Qc();return Di({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set({numRows:n,numColumns:e})},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},Nm=Object.freeze({__proto__:null,flatgrid:zm,init:function(t){return t.state(t)}}),Lm=function(t){return function(n,e,o,r){var i=t(n.element);return Gm(i,n,e,o,r)}},jm=function(t,n){var e=xs(t,n);return Lm(e)},Wm=function(t,n){var e=xs(n,t);return Lm(e)},Um=function(t){return function(n,e,o,r){return Gm(t,n,e,o,r)}},Gm=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},Xm=Um,qm=Um,Ym=Um,Km=function(t){return!function(t){return t.offsetWidth<=0&&t.offsetHeight<=0}(t.dom)},Jm=function(t,n,e){var o=of(t,e);return function(t,n){return $(t,n).map((function(n){return{index:n,candidates:t}}))}(q(o,Km),(function(t){return je(t,n)}))},$m=function(t,n){return $(t,(function(t){return je(n,t)}))},Qm=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return o>=0&&o<t.length?R.some(t[o]):R.none()}))},Zm=function(t,n,e,o,r){return Qm(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=Ga(i,r,0,u-1);return R.some({row:n,column:a})}))},tg=function(t,n,e,o,r){return Qm(t,n,o,(function(n,i){var u=Ga(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Xa(i,0,a-1);return R.some({row:u,column:c})}))},ng=[Mn("selector"),Yn("execute",Im),Da("onEscape"),Yn("captureTab",!1),Ia()],eg=function(t,n,e){fa(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},og=function(t){return function(n,e,o,r){return Jm(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},rg=function(t,n,e){return e.captureTab?R.some(!0):R.none()},ig=og((function(t,n,e,o){return Zm(t,n,e,o,-1)})),ug=og((function(t,n,e,o){return Zm(t,n,e,o,1)})),ag=og((function(t,n,e,o){return tg(t,n,e,o,-1)})),cg=og((function(t,n,e,o){return tg(t,n,e,o,1)})),sg=v([Om(xm(dm),jm(ig,ug)),Om(xm(gm),Wm(ig,ug)),Om(xm(mm),Xm(ag)),Om(xm(pm),qm(cg)),Om(wm([Sm,xm(cm)]),rg),Om(wm([Cm,xm(cm)]),rg),Om(xm(fm),(function(t,n,e){return e.onEscape(t,n)})),Om(xm(lm.concat(sm)),(function(t,n,e,o){return function(t,n){return n.focusManager.get(t).bind((function(t){return la(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))}))]),fg=v([Om(xm(lm),Rm)]),lg=Bm(ng,zm,sg,fg,(function(){return R.some(eg)})),dg=function(t,n,e,o){var r=function(t,n,e){var i,u=Ga(n,o,0,e.length-1);return u===t?R.none():(i=e[u],"button"===xr(i)&&"disabled"===ei(i,"disabled")?r(t,u,e):R.from(e[u]))};return Jm(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))},mg=[Mn("selector"),Yn("getInitial",R.none),Yn("execute",Im),Da("onEscape"),Yn("executeOnMove",!1),Yn("allowVertical",!0)],gg=function(t,n,e){return function(t,n){return n.focusManager.get(t).bind((function(t){return la(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))},pg=function(t,n,e){n.getInitial(t).orThunk((function(){return fa(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},hg=function(t,n,e){return dg(t,e.selector,n,-1)},vg=function(t,n,e){return dg(t,e.selector,n,1)},bg=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?gg(n,e,o):R.some(!0)}))}},yg=function(t,n,e){return e.onEscape(t,n)},xg=v([Om(xm(lm),Rm)]),wg=Bm(mg,Ei.init,(function(t,n,e,o){var r=dm.concat(e.allowVertical?mm:[]),i=gm.concat(e.allowVertical?pm:[]);return[Om(xm(r),bg(jm(hg,vg))),Om(xm(i),bg(Wm(hg,vg))),Om(xm(sm),gg),Om(xm(lm),gg),Om(xm(fm),yg)]}),xg,(function(){return R.some(pg)})),Sg=function(t,n,e){return R.from(t[n]).bind((function(t){return R.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},kg=function(t,n,e,o){var r=t[n].length,i=Ga(e,o,0,r-1);return Sg(t,n,i)},Cg=function(t,n,e,o){var r=Ga(e,o,0,t.length-1),i=t[r].length,u=Xa(n,0,i-1);return Sg(t,r,u)},Og=function(t,n,e,o){var r=t[n].length,i=Xa(e+o,0,r-1);return Sg(t,n,i)},_g=function(t,n,e,o){var r=Xa(e+o,0,t.length-1),i=t[r].length,u=Xa(n,0,i-1);return Sg(t,r,u)},Tg=[Hn("selectors",[Mn("row"),Mn("cell")]),Yn("cycles",!0),Yn("previousSelector",R.none),Yn("execute",Im)],Eg=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors;return fa(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},Dg=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return la(o,r.selectors.row).bind((function(t){var n=of(t,r.selectors.cell);return $m(n,o).bind((function(n){var o=of(e,r.selectors.row);return $m(o,t).bind((function(t){var e=function(t,n){return U(t,(function(t){return of(t,n.selectors.cell)}))}(o,r);return i(e,t,n).map((function(t){return t.cell}))}))}))}))}},Bg=Dg((function(t,n,e){return kg(t,n,e,-1)}),(function(t,n,e){return Og(t,n,e,-1)})),Ag=Dg((function(t,n,e){return kg(t,n,e,1)}),(function(t,n,e){return Og(t,n,e,1)})),Mg=Dg((function(t,n,e){return Cg(t,e,n,-1)}),(function(t,n,e){return _g(t,e,n,-1)})),Fg=Dg((function(t,n,e){return Cg(t,e,n,1)}),(function(t,n,e){return _g(t,e,n,1)})),Ig=v([Om(xm(dm),jm(Bg,Ag)),Om(xm(gm),Wm(Bg,Ag)),Om(xm(mm),Xm(Mg)),Om(xm(pm),qm(Fg)),Om(xm(lm.concat(sm)),(function(t,n,e){return Mc(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),Rg=v([Om(xm(lm),Rm)]),Vg=Bm(Tg,Ei.init,Ig,Rg,(function(){return R.some(Eg)})),Pg=[Mn("selector"),Yn("execute",Im),Yn("moveOnTab",!1)],Hg=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},zg=function(t,n,e){fa(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},Ng=function(t,n,e){return dg(t,e.selector,n,-1)},Lg=function(t,n,e){return dg(t,e.selector,n,1)},jg=v([Om(xm(mm),Ym(Ng)),Om(xm(pm),Ym(Lg)),Om(wm([Sm,xm(cm)]),(function(t,n,e,o){return e.moveOnTab?Ym(Ng)(t,n,e,o):R.none()})),Om(wm([Cm,xm(cm)]),(function(t,n,e,o){return e.moveOnTab?Ym(Lg)(t,n,e,o):R.none()})),Om(xm(sm),Hg),Om(xm(lm),Hg)]),Wg=v([Om(xm(lm),Rm)]),Ug=Bm(Pg,Ei.init,jg,Wg,(function(){return R.some(zg)})),Gg=[Da("onSpace"),Da("onEnter"),Da("onShiftEnter"),Da("onLeft"),Da("onRight"),Da("onTab"),Da("onShiftTab"),Da("onUp"),Da("onDown"),Da("onEscape"),Yn("stopSpaceKeyup",!1),Ln("focusIn")],Xg=Bm(Gg,Ei.init,(function(t,n,e){return[Om(xm(lm),e.onSpace),Om(wm([Cm,xm(sm)]),e.onEnter),Om(wm([Sm,xm(sm)]),e.onShiftEnter),Om(wm([Sm,xm(cm)]),e.onShiftTab),Om(wm([Cm,xm(cm)]),e.onTab),Om(xm(mm),e.onUp),Om(xm(pm),e.onDown),Om(xm(dm),e.onLeft),Om(xm(gm),e.onRight),Om(xm(lm),e.onSpace),Om(xm(fm),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Om(xm(lm),Rm)]:[]}),(function(t){return t.focusIn})),qg=Mm.schema(),Yg=Fm.schema(),Kg=wg.schema(),Jg=lg.schema(),$g=Vg.schema(),Qg=Hm.schema(),Zg=Ug.schema(),tp=Xg.schema(),np=Oc({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:qg,cyclic:Yg,flow:Kg,flatgrid:Jg,matrix:$g,execution:Qg,menu:Zg,special:tp}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){!function(t){return Nt(t,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(o,r)}},state:Nm}),ep=function(t,n,e,o){var r=t.getSystem().build(o);Wf(t,r,e)},op=function(t,n,e,o){var r=rp(t),i=J(r,(function(t){return je(o.element,t.element)}));i.each(Gf)},rp=function(t,n){return t.components()},ip=function(t,n,e,o,r){var i=rp(t);return R.from(i[o]).map((function(n){return op(t,0,0,n),r.each((function(n){ep(t,0,(function(t,n){!function(t,n,e){Fr(t,e).fold((function(){qr(t,n)}),(function(t){Ur(t,n)}))}(t,n,o)}),n)})),n}))},up=Object.freeze({__proto__:null,append:function(t,n,e,o){ep(t,0,qr,o)},prepend:function(t,n,e,o){ep(t,0,Xr,o)},remove:op,replaceAt:ip,replaceBy:function(t,n,e,o,r){var i=rp(t);return $(i,o).bind((function(n){return ip(t,0,0,n,r)}))},set:function(t,n,e,o){Fc((function(){var n=U(o,t.getSystem().build);Lf(t,n)}),t.element)},contents:rp}),ap=kc({fields:[],name:"replacing",apis:up}),cp=function(t,n){var e=function(t,n){var e=rr(n);return kc({fields:[Mn("enabled")],name:t,active:{events:v(e)}})}(t,n);return{key:t,value:{config:{},me:e,configAsRaw:v({}),initialConfig:{},state:Ei}}},sp=function(t,n){n.ignore||(Dc(t.element),n.onFocus(t))},fp=Object.freeze({__proto__:null,focus:sp,blur:function(t,n){n.ignore||function(t){t.dom.blur()}(t.element)},isFocused:function(t){return Bc(t.element)}}),lp=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return Ai(e)},events:function(t){return rr([ar(To(),(function(n,e){sp(n,t),e.stop()}))].concat(t.stopMousedown?[ar(co(),(function(t,n){n.event.prevent()}))]:[]))}}),dp=[Ea("onFocus"),Yn("stopMousedown",!1),Yn("ignore",!1)],mp=kc({fields:dp,name:"focusing",active:lp,apis:fp}),gp=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},pp=function(t,n,e){n.toggleClass.each((function(n){e.get()?Gi(t.element,n):qi(t.element,n)}))},hp=function(t,n,e){yp(t,n,e,!e.get())},vp=function(t,n,e){e.set(!0),pp(t,n,e),gp(t,n,e)},bp=function(t,n,e){e.set(!1),pp(t,n,e),gp(t,n,e)},yp=function(t,n,e,o){(o?vp:bp)(t,n,e)},xp=function(t,n,e){yp(t,n,e,n.selected)},wp=Object.freeze({__proto__:null,onLoad:xp,toggle:hp,isOn:function(t,n,e){return e.get()},on:vp,off:bp,set:yp}),Sp=Object.freeze({__proto__:null,exhibit:function(){return Ai({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=hp,br((function(t){r(t,e,o)}))),u=vc(t,n,xp);return rr(Q([t.toggleOnExecute?[i]:[],[u]]))}}),kp=function(t,n,e){ni(t.element,"aria-expanded",e)},Cp=[Yn("selected",!1),Ln("toggleClass"),Yn("toggleOnExecute",!0),Kn("aria",{mode:"none"},En("mode",{pressed:[Yn("syncWithExpanded",!1),Ma("update",(function(t,n,e){ni(t.element,"aria-pressed",e),n.syncWithExpanded&&kp(t,n,e)}))],checked:[Ma("update",(function(t,n,e){ni(t.element,"aria-checked",e)}))],expanded:[Ma("update",kp)],selected:[Ma("update",(function(t,n,e){ni(t.element,"aria-selected",e)}))],none:[Ma("update",p)]}))],Op=kc({fields:Cp,name:"toggling",active:Sp,apis:wp,state:(Dm=!1,{init:function(){var t=oe(Dm);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(Dm)},readState:function(){return t.get()}}}})}),_p=function(){var t=function(t,n){n.stop(),tr(t)};return[ar(xo(),t),ar(Fo(),t),dr(ro()),dr(co())]},Tp=function(t){return rr(Q([t.map((function(t){return br((function(n,e){t(n),e.stop()}))})).toArray(),_p()]))},Ep="alloy.item-hover",Dp="alloy.item-focus",Bp=function(t){(Mc(t.element).isNone()||mp.isFocused(t))&&(mp.isFocused(t)||mp.focus(t),Zo(t,Ep,{item:t}))},Ap=function(t){Zo(t,Dp,{item:t})},Mp=v(Ep),Fp=v(Dp),Ip=[Mn("data"),Mn("components"),Mn("dom"),Yn("hasSubmenu",!1),Ln("toggling"),Bl("itemBehaviours",[Op,mp,np,_l]),Yn("ignoreFocus",!1),Yn("domModification",{}),Ma("builder",(function(t){return{dom:t.dom,domModification:_(_({},t.domModification),{attributes:_(_(_({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Al(t.itemBehaviours,[t.toggling.fold(Op.revoke,(function(t){return Op.config(_({aria:{mode:"checked"}},t))})),mp.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Ap(t)}}),np.config({mode:"execution"}),_l.config({store:{mode:"memory",initialValue:t.data}}),cp("item-type-events",E(E([],_p()),[ar(mo(),Bp),ar(Mo(),mp.focus)]))]),components:t.components,eventOrder:t.eventOrder}})),Yn("eventOrder",{})],Rp=[Mn("dom"),Mn("components"),Ma("builder",(function(t){return{dom:t.dom,components:t.components,events:rr([mr(Mo())])}}))],Vp=v("item-widget"),Pp=v([ed({name:"widget",overrides:function(t){return{behaviours:wc([_l.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:p}})])}}})]),Hp=[Mn("uid"),Mn("data"),Mn("components"),Mn("dom"),Yn("autofocus",!1),Yn("ignoreFocus",!1),Bl("widgetBehaviours",[_l,mp,np]),Yn("domModification",{}),kd(Pp()),Ma("builder",(function(t){var n=gd(Vp(),t,Pp()),e=pd(Vp(),t,n.internals()),o=function(n){return hd(n,t,"widget").map((function(t){return np.focusIn(t),t}))},r=function(n,e){return Md(e.event.target)?R.none():t.autofocus?(e.setSource(n.element),R.none()):R.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:rr([br((function(t,n){o(t).each((function(t){n.stop()}))})),ar(mo(),Bp),ar(Mo(),(function(n,e){t.autofocus?o(n):mp.focus(n)}))]),behaviours:Al(t.widgetBehaviours,[_l.config({store:{mode:"memory",initialValue:t.data}}),mp.config({ignore:t.ignoreFocus,onFocus:function(t){Ap(t)}}),np.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:_c(),onLeft:r,onRight:r,onEscape:function(n,e){return mp.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element),R.none()):R.none():(mp.focus(n),R.some(!0))}})])}}))],zp=En("type",{widget:Hp,item:Ip,separator:Rp}),Np=v([id({factory:{sketch:function(t){var n=_n("menu.spec item",zp,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return zt(n,"uid")?n:_(_({},n),{uid:yi("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Lp=v([Mn("value"),Mn("items"),Mn("dom"),Mn("components"),Yn("eventOrder",{}),Tl("menuBehaviours",[um,_l,Rd,np]),Kn("movement",{mode:"menu",moveOnTab:!0},En("mode",{grid:[Ia(),Ma("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[Ma("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Mn("rowSelector")],menu:[Yn("moveOnTab",!0),Ma("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Fn("markers",ka()),Yn("fakeFocus",!1),Yn("focusManager",Tm()),Ea("onHighlight")]),jp=v("alloy.menu-focus"),Wp=Ad({name:"Menu",configFields:Lp(),partFields:Np(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Dl(t.menuBehaviours,[um.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),_l.config({store:{mode:"memory",initialValue:t.value}}),Rd.config({find:R.some}),np.config(t.movement.config(t,t.movement))]),events:rr([ar(Fp(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){um.highlight(t,e),n.stop(),Zo(t,jp(),{menu:t,item:e})}))})),ar(Mp(),(function(t,n){var e=n.event.item;um.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Up=function(t,n,e,o){return Ht(e,o).bind((function(o){return Ht(t,o).bind((function(o){var r=Up(t,n,e,o);return R.some([o].concat(r))}))})).getOr([])},Gp=function(t,n){var e={};At(t,(function(t,n){G(t,(function(t){e[t]=n}))}));var o=n,r=Ft(n,(function(t,n){return{k:t,v:n}})),i=Mt(r,(function(t,n){return[n].concat(Up(e,o,r,n))}));return Mt(e,(function(t){return Ht(i,t).getOr([t])}))},Xp=function(t){return"prepared"===t.type?R.some(t.menu):R.none()},qp={init:function(){var t=oe({}),n=oe({}),e=oe({}),o=Qc(),r=oe({}),i=function(n,e,o){return u(n).bind((function(r){return function(n){return Vt(t.get(),(function(t,e){return t===n}))}(n).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}))}))},u=function(t){return a(t).bind(Xp)},a=function(t){return Ht(n.get(),t)},c=function(n){return Ht(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(_(_({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(i),t.set(a),n.set(u),r.set(c);var s=Gp(c,a);e.set(s)},expand:function(n){return Ht(t.get(),n).map((function(t){var o=Ht(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return Ht(e.get(),t)},collapse:function(t){return Ht(e.get(),t).bind((function(t){return t.length>1?R.some(t.slice(1)):R.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get();return et(Dt(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.clear()},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=q(c(t).toArray(),(function(t){return u(t).isSome()}));return Ht(e.get(),t).bind((function(t){var e=nt(r.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return R.none();n.push(o.getOrDie())}return R.some(n)}(Z(e,(function(t,r){return i(t,n,e.slice(0,r+1)).fold((function(){return $i(o.get(),t)?[]:[R.none()]}),(function(t){return[R.some(t)]}))})))}))}}},extractPreparedMenu:Xp},Yp=v("collapse-item"),Kp=Bd({name:"TieredMenu",configFields:[Aa("onExecute"),Aa("onEscape"),Ba("onOpenMenu"),Ba("onOpenSubmenu"),Ea("onRepositionMenu"),Ea("onCollapseMenu"),Yn("highlightImmediately",!0),Hn("data",[Mn("primary"),Mn("menus"),Mn("expansions")]),Yn("fakeFocus",!1),Ea("onHighlight"),Ea("onHover"),Oa(),Mn("dom"),Yn("navigateOnHover",!0),Yn("stayInDom",!1),Tl("tmenuBehaviours",[np,um,Rd,ap]),Yn("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o=Qc(),r=qp.init(),i=function(n){var e=function(n,e,o){return Mt(o,(function(o,r){var i=function(){return Wp.sketch(_(_({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Em():Tm()}))};return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))}(n,t.data.primary,t.data.menus),o=a();return r.setContents(t.data.primary,e,t.data.expansions,o),r.getPrimary()},u=function(t){return _l.getValue(t).value},a=function(n){return Mt(t.data.menus,(function(t,n){return Z(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},c=function(t,n){um.highlight(t,n),um.getHighlighted(n).orThunk((function(){return um.getFirst(n)})).each((function(n){nr(t,n.element,Mo())}))},s=function(t,n){return Qi(U(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?R.some(t.menu):R.none()}))})))},f=function(n,e,o){var r=s(e,e.otherMenus(o));G(r,(function(e){Ji(e.element,[t.markers.backgroundMenu]),t.stayInDom||ap.remove(n,e)}))},l=function(n,e){var r=function(n){return o.get().getOrThunk((function(){var e={},r=of(n.element,"."+t.markers.item),i=q(r,(function(t){return"true"===ei(t,"aria-haspopup")}));return G(i,(function(t){n.getSystem().getByDom(t).each((function(t){var n=u(t);e[n]=t}))})),o.set(e),e}))}(n);At(r,(function(t,n){var o=N(e,n);ni(t.element,"aria-expanded",o)}))},d=function(n,e,o){return R.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return R.none();var i=r.menu,u=s(e,o.slice(1));return G(u,(function(n){Gi(n.element,t.markers.backgroundMenu)})),eu(i.element)||ap.append(n,Bu(i)),Ji(i.element,[t.markers.backgroundMenu]),c(n,i),f(n,e,o),R.some(i)}))}))};!function(t){t[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent"}(e||(e={}));var m=function(n,o,i){if(void 0===i&&(i=e.HighlightSubmenu),o.hasConfigured(Kd)&&Kd.isDisabled(o))return R.some(o);var a=u(o);return r.expand(a).bind((function(u){return l(n,u),R.from(u[0]).bind((function(a){return r.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"===e.type){var o=t.getSystem().build(e.nbMenu());return r.setMenuBuilt(n,o),o}return e.menu}(n,a,c);return eu(s.element)||ap.append(n,Bu(s)),t.onOpenSubmenu(n,o,s,nt(u)),i===e.HighlightSubmenu?(um.highlightFirst(s),d(n,r,u)):(um.dehighlightAll(s),R.some(o))}))}))}))},g=function(n,e){var o=u(e);return r.collapse(o).bind((function(o){return l(n,o),d(n,r,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},h=function(n){return function(e,o){return la(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(C)}))}))}},v=rr([ar(jp(),(function(t,n){var e=n.event.item;r.lookupItem(u(e)).each((function(){var e=n.event.menu;um.highlight(t,e);var o=u(n.event.item);r.refresh(o).each((function(n){return f(t,r,n)}))}))})),br((function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each((function(o){0===u(o).indexOf("collapse-item")&&g(n,o),m(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),p)}))})),pr((function(n,e){i(n).each((function(e){ap.append(n,Bu(e)),t.onOpenMenu(n,e),t.highlightImmediately&&c(n,e)}))}))].concat(t.navigateOnHover?[ar(Mp(),(function(n,o){var i=o.event.item;!function(t,n){var e=u(n);r.refresh(e).bind((function(n){return l(t,n),d(t,r,n)}))}(n,i),m(n,i,e.HighlightParent),t.onHover(n,i)}))]:[])),b=function(t){return um.getHighlighted(t).bind(um.getHighlighted)},y={collapseMenu:function(t){b(t).each((function(n){g(t,n)}))},highlightPrimary:function(t){r.getPrimary().each((function(n){c(t,n)}))},repositionMenus:function(n){var e=r.getPrimary().bind((function(t){return b(n).bind((function(t){var n=u(t),e=Pt(r.getMenus()),o=Qi(U(e,qp.extractPreparedMenu));return r.getTriggeringPath(n,(function(t){return function(t,n,e){return ft(n,(function(t){if(!t.getSystem().isConnected())return R.none();var n=um.getCandidates(t);return J(n,(function(t){return u(t)===e}))}))}(0,o,t)}))})).map((function(n){return{primary:t,triggeringPath:n}}))}));e.fold((function(){(function(t){return R.from(t.components()[0]).filter((function(t){return"menu"===ei(t.element,"role")}))})(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Dl(t.tmenuBehaviours,[np.config({mode:"special",onRight:h((function(t,n){return Md(n.element)?R.none():m(t,n,e.HighlightSubmenu)})),onLeft:h((function(t,n){return Md(n.element)?R.none():g(t,n)})),onEscape:h((function(n,e){return g(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){r.getPrimary().each((function(n){nr(t,n.element,Mo())}))}}),um.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),Rd.config({find:function(t){return um.getHighlighted(t)}}),ap.config({})]),eventOrder:t.eventOrder,apis:y,events:v}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:qe(t,n),expansions:{}}},collapseItem:function(t){return{value:di(Yp()),meta:{text:t}}}}}),Jp=Bd({name:"InlineView",configFields:[Mn("lazySink"),Ea("onShow"),Ea("onHide"),Gn("onEscape"),Tl("inlineBehaviours",[ul,_l,Tc]),qn("fireDismissalEventInstead",[Yn("event",Uo())]),qn("fireRepositionEventInstead",[Yn("event",Go())]),Yn("getRelated",R.none),Yn("isExtraPart",k),Yn("eventOrder",R.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map((function(t){return ta(t)}))}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();ul.openWhileCloaked(n,e,(function(){return Pf.positionWithinBounds(i,n,o,r())})),_l.setValue(n,R.some({mode:"position",config:o,getBounds:r}))},r=function(n,e,o,r){var i=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return mc()},onRtl:function(){return gc()}}}:{},a=function(t){return function(t){return 2===t.length}(t)?u:{}};return Kp.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return ul.close(n),t.onEscape.map((function(t){return t(n)})),R.some(!0)},onExecute:function(){return R.some(!0)},onOpenMenu:function(t,n){Pf.positionWithinBounds(i().getOrDie(),n,e,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();Pf.position(r,e,{anchor:_({type:"submenu",item:n},a(o))})},onRepositionMenu:function(t,n,o){var u=i().getOrDie();Pf.positionWithinBounds(u,n,e,r()),G(o,(function(t){var n=a(t.triggeringPath);Pf.position(u,t.triggeredMenu,{anchor:_({type:"submenu",item:t.triggeringItem},n)})}))}})}(t,n,e,o,r);ul.open(n,i),_l.setValue(n,R.some({mode:"menu",menu:i}))},i=function(n){ul.isOpen(n)&&_l.getValue(n).each((function(e){switch(e.mode){case"menu":ul.getState(n).each(Kp.repositionMenus);break;case"position":var o=t.lazySink(n).getOrDie();Pf.positionWithinBounds(o,n,e.config,e.getBounds())}}))},u={setContent:function(t,n){ul.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,R.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,R.none)},showMenuWithinBounds:r,hide:function(t){ul.isOpen(t)&&(_l.setValue(t,R.none()),ul.close(t))},getContent:function(t){return ul.getState(t)},reposition:i,isOpen:ul.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Dl(t.inlineBehaviours,[ul.config({isPartOf:function(n,e,o){return ga(e,o)||function(n,e){return t.getRelated(n).exists((function(t){return ga(t,e)}))}(n,o)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),_l.config({store:{mode:"memory",initialValue:R.none()}}),Tc.config({channels:_(_({},ll(_({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),ml(_(_({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),$p="layout-inset",Qp=function(t){return t.x},Zp=function(t,n){return t.x+t.width/2-n.width/2},th=function(t,n){return t.x+t.width-n.width},nh=function(t){return t.y},eh=function(t,n){return t.y+t.height-n.height},oh=function(t,n){return t.y+t.height/2-n.height/2},rh=function(t,n,e){return Ra(th(t,n),eh(t,n),e.insetSouthwest(),Na(),"southwest",qa(t,{right:0,bottom:3}),$p)},ih=function(t,n,e){return Ra(Qp(t),eh(t,n),e.insetSoutheast(),za(),"southeast",qa(t,{left:1,bottom:3}),$p)},uh=function(t,n,e){return Ra(th(t,n),nh(t),e.insetNorthwest(),Ha(),"northwest",qa(t,{right:0,top:2}),$p)},ah=function(t,n,e){return Ra(Qp(t),nh(t),e.insetNortheast(),Pa(),"northeast",qa(t,{left:1,top:2}),$p)},ch=function(t,n,e){return Ra(Zp(t,n),nh(t),e.insetNorth(),La(),"north",qa(t,{top:2}),$p)},sh=function(t,n,e){return Ra(Zp(t,n),eh(t,n),e.insetSouth(),ja(),"south",qa(t,{bottom:3}),$p)},fh=function(t,n,e){return Ra(th(t,n),oh(t,n),e.insetEast(),Ua(),"east",qa(t,{right:0}),$p)},lh=function(t,n,e){return Ra(Qp(t),oh(t,n),e.insetWest(),Wa(),"west",qa(t,{left:1}),$p)},dh=function(t){switch(t){case"north":return ch;case"northeast":return ah;case"northwest":return uh;case"south":return sh;case"southeast":return ih;case"southwest":return rh;case"east":return fh;case"west":return lh}},mh=function(t,n,e,o,r){return qc(o).map(dh).getOr(ch)(t,n,e,o,r)},gh=function(t){switch(t){case"north":return sh;case"northeast":return ih;case"northwest":return rh;case"south":return ch;case"southeast":return ah;case"southwest":return uh;case"east":return lh;case"west":return fh}},ph=function(t,n,e,o,r){return qc(o).map(gh).getOr(ch)(t,n,e,o,r)},hh=tinymce.util.Tools.resolve("tinymce.util.Delay"),vh=Bd({name:"Button",factory:function(t){var n=Tp(t.action),e=t.dom.tag,o=function(n){return Ht(t.dom,"attributes").bind((function(t){return Ht(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:Al(t.buttonBehaviours,[mp.config({}),np.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return _({type:t},n)}return{role:o("role").getOr("button")}}()},eventOrder:t.eventOrder}},configFields:[Yn("uid",void 0),Mn("dom"),Yn("components",[]),Bl("buttonBehaviours",[mp,np]),Ln("action"),Ln("role"),Yn("eventOrder",{})]}),bh=function(t){var n=function(t){return void 0!==t.uid}(t)&&Nt(t,"uid")?t.uid:yi("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return _(_({},t),{uid:n})}}},yh=tinymce.util.Tools.resolve("tinymce.util.I18n"),xh={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},wh="temporary-placeholder",Sh=function(t){return function(){return Ht(t,wh).getOr("!not found!")}},kh=function(t,n){var e=t.toLowerCase();if(yh.isRtl()){var o=function(t,n){return me(t,n)?t:function(t,n){return t+n}(t,n)}(e,"-rtl");return zt(n,o)?o:e}return e},Ch=function(t,n){return Ht(n,kh(t,n))},Oh=function(t,n){var e=n();return Ch(t,e).getOrThunk(Sh(e))},_h=function(){return cp("add-focusable",[pr((function(t){sa(t.element,"svg").each((function(t){return ni(t,"focusable","false")}))}))])},Th=function(t,n,e,o){var r,i,u=function(t){return!!yh.isRtl()&&zt(xh,t)}(n)?["tox-icon--flip"]:[],a=Ht(e,kh(n,e)).or(o).getOrThunk(Sh(e));return{dom:{tag:t.tag,attributes:null!==(r=t.attributes)&&void 0!==r?r:{},classes:t.classes.concat(u),innerHtml:a},behaviours:wc(E(E([],null!==(i=t.behaviours)&&void 0!==i?i:[]),[_h()]))}},Eh=function(t,n,e,o){return void 0===o&&(o=R.none()),Th(n,t,e(),o)},Dh={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Bh=Bd({name:"Notification",factory:function(t){var n,e,o,r,i,u=bh({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:wc([ap.config({})])}),a=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},c=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},s=bh({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[a(0)]},c(0)],behaviours:wc([ap.config({})])}),f={updateProgress:function(t,n){t.getSystem().isConnected()&&s.getOpt(t).each((function(t){ap.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[a(n)]},c(n)])}))},updateText:function(t,n){if(t.getSystem().isConnected()){var e=u.get(t);ap.set(e,[_u(n)])}}},l=Q([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return R.from(Dh[t])})).toArray()]),d=bh(vh.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[Eh("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),m=(n=l,e={tag:"div",classes:["tox-notification__icon"]},o=t.iconProvider,r=o(),i=J(n,(function(t){return zt(r,kh(t,r))})),Th(e,i.getOr(wh),r,R.none())),g=[m,{dom:{tag:"div",classes:["tox-notification__body"]},components:[u.asSpec()],behaviours:wc([ap.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:wc([mp.config({}),cp("notification-events",[ar(go(),(function(t){d.getOpt(t).each(mp.focus)}))])]),components:g.concat(t.progress?[s.asSpec()]:[]).concat(t.closeButton?[d.asSpec()]:[]),apis:f}},configFields:[Ln("level"),Mn("progress"),Mn("icon"),Mn("onAction"),Mn("text"),Mn("iconProvider"),Mn("translationProvider"),Zn("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function Ah(t,n,e){var o=n.backstage.shared;return{open:function(t,n){var r=!t.closeButton&&t.timeout&&(t.timeout>0||t.timeout<0),i=function(){n(),Jp.hide(a)},u=Du(Bh.sketch({text:t.text,level:N(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:R.from(t.icon),closeButton:!r,onAction:i,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),a=Du(Jp.sketch(_({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{}},o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(a),t.timeout>0&&hh.setTimeout((function(){i()}),t.timeout),{close:i,moveTo:function(t,n){Jp.showAt(a,Bu(u),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,n){if("banner"!==n){var e=function(t){switch(t){case"bc-bc":return sh;case"tc-tc":return ch;case"tc-bc":return ic;default:return uc}}(n),r={type:"node",root:ou(),node:R.some(ie.fromDom(t)),layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}};Jp.showAt(a,Bu(u),{anchor:r})}else Jp.showAt(a,Bu(u),{anchor:o.anchors.banner()})},text:function(t){Bh.updateText(u,t)},settings:t,getEl:function(){return u.element.dom},progressBar:{value:function(t){Bh.updateProgress(u,t)}}}},close:function(t){t.close()},reposition:function(t){!function(t){G(t,(function(t){return t.moveTo(0,0)}))}(t),function(t){t.length>0&&(at(t).each((function(t){return t.moveRel(null,"banner")})),G(t,(function(n,e){e>0&&n.moveRel(t[e-1].getEl(),"bc-tc")})))}(t)},getArgs:function(t){return t.settings}}}var Mh,Fh=function(t,n){var e=null,o=function(){a(e)||(clearTimeout(e),e=null)};return{cancel:o,throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o(),e=setTimeout((function(){e=null,t.apply(null,r)}),n)}}},Ih=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Rh=function(t,n,e,o,r){var i=Ih(t,(function(n){return function(t,n){return t.isBlock(n)||N(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)}(t,n)}));return R.from(i.backwards(n,e,o,r))},Vh=function(t,n){return Ph(ie.fromDom(t.selection.getNode())).getOrThunk((function(){var e=ie.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return qr(e,ie.fromDom(n.extractContents())),n.insertNode(e.dom),Br(e).each((function(t){return t.dom.normalize()})),function(t){return ef(t,nf)}(e).map((function(n){t.selection.setCursorLocation(n.dom,function(t){return"img"===xr(t)?1:Zs(t).fold((function(){return Mr(t).length}),(function(t){return t.length}))}(n))})),e}))},Ph=function(t){return la(t,"[data-mce-autocompleter]")},Hh=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},zh=function(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)},Nh=function(t,n){return t.substring(n.length)},Lh=function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return R.none();var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return Rh(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){var o;for(o=n-1;o>=0;o--){var r=t.charAt(o);if(zh(r))return R.none();if(r===e)break}return R.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return R.none();var i=Hh(r);return 0!==i.lastIndexOf(e)||Nh(i,e).length<o?R.none():R.some({text:Nh(i,e),range:r,triggerChar:e})}))},jh=function(t,n,e,o){return void 0===o&&(o=0),Ph(ie.fromDom(n.startContainer)).fold((function(){return Lh(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=Hh(o);return R.some({range:o,text:Nh(r,e),triggerChar:e})}))},Wh=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){Zo(t,ho(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(um.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(tr),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(um.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&Ph(ie.fromDom(n.element)).isNone()&&t.cancelIfNecessary()}))},Uh=tinymce.util.Tools.resolve("tinymce.util.Promise"),Gh=function(t,n){return{container:t,offset:n}},Xh=function(t){if(function(t){return 3===t.nodeType}(t))return Gh(t,t.data.length);var n=t.childNodes;return n.length>0?Xh(n[n.length-1]):Gh(t,n.length)},qh=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?qh(e[n],0):e.length>0&&function(t){return 1===t.nodeType}(t)&&e.length===n?Xh(e[e.length-1]):Gh(t,n)},Yh=function(t){return function(n){var e=qh(n.startContainer,n.startOffset);return!function(t,n){return Rh(t,n.container,n.offset,(function(t,n){return 0===n?-1:n}),t.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!zh(n)})).isSome()}(t,e)}},Kh=function(t,n){var e=n(),o=t.selection.getRng();return function(t,n,e){return ft(e.triggerChars,(function(e){return jh(t,n,e)}))}(t.dom,o,e).bind((function(e){return Jh(t,n,e)}))},Jh=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=q(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return Yh(t.dom)}))(e.range,i,e.text)}));if(0===u.length)return R.none();var a=Uh.all(U(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return R.some({lookupData:a,context:e})},$h=an([Rn("type"),Un("text")]),Qh=an([Yn("type","autocompleteitem"),Yn("active",!1),Yn("disabled",!1),Yn("meta",{}),Rn("value"),Un("text"),Un("icon")]),Zh=an([Rn("type"),Rn("ch"),Jn("minChars",1),Yn("columns",1),Jn("maxResults",10),Gn("matches"),Pn("fetch"),Pn("onAction"),ne("highlightOn",[],pn)]),tv=[Zn("disabled",!1),Un("tooltip"),Un("icon"),Un("text"),te("onSetup",(function(){return p}))],nv=an([Rn("type"),Pn("onAction")].concat(tv)),ev=function(t){return Cn("toolbarbutton",nv,t)},ov=[Zn("active",!1)].concat(tv),rv=an(ov.concat([Rn("type"),Pn("onAction")])),iv=function(t){return Cn("ToggleButton",rv,t)},uv=[te("predicate",k),Qn("scope","node",["node","editor"]),Qn("position","selection",["node","selection","line"])],av=tv.concat([Yn("type","contextformbutton"),Yn("primary",!1),Pn("onAction"),Bn("original",b)]),cv=ov.concat([Yn("type","contextformbutton"),Yn("primary",!1),Pn("onAction"),Bn("original",b)]),sv=tv.concat([Yn("type","contextformbutton")]),fv=ov.concat([Yn("type","contextformtogglebutton")]),lv=En("type",{contextformbutton:av,contextformtogglebutton:cv}),dv=an([Yn("type","contextform"),te("initValue",v("")),Un("label"),Nn("commands",lv),jn("launch",En("type",{contextformbutton:sv,contextformtogglebutton:fv}))].concat(uv)),mv=an([Yn("type","contexttoolbar"),Rn("items")].concat(uv)),gv=function(t){var n=t.ui.registry.getAll().popups,e=Mt(n,(function(t){return(n=t,Cn("Autocompleter",Zh,n)).fold((function(t){throw new Error(Tn(t))}),b);var n})),o=function(t){var n={};return G(t,(function(t){n[t]={}})),Dt(n)}(Rt(e,(function(t){return t.ch}))),r=Pt(e);return{dataset:e,triggerChars:o,lookupByChar:function(t){return q(r,(function(n){return n.ch===t}))}}};!function(t){t[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(Mh||(Mh={}));var pv,hv=Mh,vv="tox-menu-nav__js",bv="tox-collection__item",yv="tox-swatch",xv={normal:vv,color:yv},wv="tox-collection__item--enabled",Sv="tox-collection__item-icon",kv="tox-collection__item-label",Cv="tox-collection__item-caret",Ov="tox-collection__item--active",_v="tox-collection__item-container",Tv="tox-collection__item-container--row",Ev=function(t){return Ht(xv,t).getOr(vv)},Dv=function(t){return"color"===t?"tox-swatches":"tox-menu"},Bv=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Dv(t),tieredMenu:"tox-tiered-menu"}},Av=function(t){var n=Bv(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Ev(t)}},Mv=function(t,n,e){var o=Bv(e);return{tag:"div",classes:Q([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},Fv=[Wp.parts.items({})],Iv=function(t,n,e){var o=Bv(e);return{dom:{tag:"div",classes:Q([[o.tieredMenu]])},markers:Av(e)}},Rv=function(t,n){return function(e){var o=W(e,n);return U(o,(function(n){return{dom:t,components:n}}))}},Vv=function(t,n){var e=[],o=[];return G(t,(function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],zt(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),o.length>0&&e.push(o),U(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Pv=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[Wp.parts.items({preprocess:function(e){return"auto"!==t&&t>1?Rv({tag:"div",classes:["tox-collection__group"]},t)(e):Vv(e,(function(t,e){return"separator"===n[e].type}))}})]}},Hv=function(t){return L(t,(function(t){return"icon"in t&&void 0!==t.icon}))},zv=function(t){return console.error(Tn(t)),console.log(t),R.none()},Nv=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Wp.parts.items({preprocess:function(t){return Vv(t,(function(t,n){return"separator"===i[n].type}))}})]});return{value:t,dom:u.dom,components:u.components,items:e}},Lv=function(t,n,e,o,r){if("color"===r){var i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Wp.parts.items({preprocess:"auto"!==t?Rv({tag:"div",classes:["tox-swatches__row"]},t):b})]}]}}(o);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r&&"auto"===o)return{value:t,dom:(i=Pv(o,e)).dom,components:i.components,items:e};if("normal"===r&&1===o)return{value:t,dom:(i=Pv(1,e)).dom,components:i.components,items:e};if("normal"===r)return{value:t,dom:(i=Pv(o,e)).dom,components:i.components,items:e};if("listpreview"===r&&"auto"!==o){i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Wp.parts.items({preprocess:Rv({tag:"div",classes:["tox-collection__group"]},t)})]}}(o);return{value:t,dom:i.dom,components:i.components,items:e}}return{value:t,dom:Mv(n,o,r),components:Fv,items:e}},jv=[Rn("type"),Rn("src"),Un("alt"),ne("classes",[],pn)],Wv=an(jv),Uv=[Rn("type"),Rn("text"),Un("name"),ne("classes",["tox-collection__item-label"],pn)],Gv=an(Uv),Xv=on((function(){return wn("type",{cardimage:Wv,cardtext:Gv,cardcontainer:qv})})),qv=an([Rn("type"),$n("direction","horizontal"),$n("align","left"),$n("valign","middle"),Nn("items",Xv)]),Yv=[Zn("disabled",!1),Un("text"),Un("shortcut"),Dn("value","value",Gt((function(){return di("menuitem-value")})),dn()),Yn("meta",{})],Kv=an([Rn("type"),Un("label"),Nn("items",Xv),te("onSetup",(function(){return p})),te("onAction",p)].concat(Yv)),Jv=an([Rn("type"),Zn("active",!1),Un("icon")].concat(Yv)),$v=[Rn("type"),Rn("fancytype"),te("onAction",p)],Qv=[Yn("initData",{})].concat($v),Zv=[ee("initData",{},[Zn("allowCustomColors",!0),Xn("colors",dn())])].concat($v),tb=En("fancytype",{inserttable:Qv,colorswatch:Zv}),nb=an([Rn("type"),te("onSetup",(function(){return p})),te("onAction",p),Un("icon")].concat(Yv)),eb=an([Rn("type"),Pn("getSubmenuItems"),te("onSetup",(function(){return p})),Un("icon")].concat(Yv)),ob=an([Rn("type"),Un("icon"),Zn("active",!1),te("onSetup",(function(){return p})),Pn("onAction")].concat(Yv)),rb=function(t,n,e){var o=of(t.element,"."+e);if(o.length>0){var r=$(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return R.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return R.none()},ib=function(t,n){return wc([cp(t,n)])},ub=function(t){return ib(di("unnamed-events"),t)},ab=di("tooltip.exclusive"),cb=di("tooltip.show"),sb=di("tooltip.hide"),fb=function(t,n,e){t.getSystem().broadcastOn([ab],{})},lb=Object.freeze({__proto__:null,hideAllExclusive:fb,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&ap.set(t,o)}))}}),db=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){Gf(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return rr(Q([[ar(cb,(function(e){n.resetTimer((function(){!function(e){if(!n.isShowing()){fb(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:rr("normal"===t.mode?[ar(mo(),(function(t){Qo(e,cb)})),ar(fo(),(function(t){Qo(e,sb)}))]:[]),behaviours:wc([ap.config({})])});n.setTooltip(r),jf(o,r),t.onShow(e,r),Pf.position(o,r,{anchor:t.anchor(e)})}}(e)}),t.delay)})),ar(sb,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),ar(Bo(),(function(t,n){var o=n;o.universal||N(o.channels,ab)&&e(t)})),hr((function(t){e(t)}))],"normal"===t.mode?[ar(go(),(function(t){Qo(t,cb)})),ar(Eo(),(function(t){Qo(t,sb)})),ar(mo(),(function(t){Qo(t,cb)})),ar(fo(),(function(t){Qo(t,sb)}))]:[ar(Jo(),(function(t,n){Qo(t,cb)})),ar($o(),(function(t){Qo(t,sb)}))]]))}}),mb=[Mn("lazySink"),Mn("tooltipDom"),Yn("exclusive",!0),Yn("tooltipComponents",[]),Yn("delay",300),Qn("mode","normal",["normal","follow-highlight"]),Yn("anchor",(function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:v([uc,ic,nc,oc,ec,rc]),onRtl:v([uc,ic,nc,oc,ec,rc])}}})),Ea("onHide"),Ea("onShow")],gb=kc({fields:mb,name:"tooltipping",active:db,state:Object.freeze({__proto__:null,init:function(){var t=Qc(),n=Qc(),e=function(){t.on(clearTimeout)},o=v("not-implemented");return Di({getTooltip:n.get,isShowing:n.isSet,setTooltip:n.set,clearTooltip:n.clear,clearTimer:e,resetTimer:function(n,o){e(),t.set(setTimeout(n,o))},readState:o})}}),apis:lb}),pb=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),hb=tinymce.util.Tools.resolve("tinymce.EditorManager"),vb=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},bb=function(t){return t.getParam("width",pb.DOM.getStyle(t.getElement(),"width"))},yb=function(t){return R.from(t.getParam("min_width")).filter(m)},xb=function(t){return R.from(t.getParam("min_height")).filter(m)},wb=function(t){return R.from(t.getParam("max_width")).filter(m)},Sb=function(t){return R.from(t.getParam("max_height")).filter(m)},kb=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Cb=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=r(n),i=u(n)&&n.length>0;return!_b(t)&&(i||o||e)},Ob=function(t){var n=j(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=q(n,(function(t){return"string"==typeof t}));return e.length>0?R.some(e):R.none()},_b=function(t){return Ob(t).fold((function(){return t.getParam("toolbar",[],"string[]").length>0}),C)};!function(t){t.default="wrap",t.floating="floating",t.sliding="sliding",t.scrolling="scrolling"}(pv||(pv={}));var Tb,Eb=function(t){return t.getParam("toolbar_mode","","string")};!function(t){t.auto="auto",t.top="top",t.bottom="bottom"}(Tb||(Tb={}));var Db,Bb,Ab=function(t){return t.getParam("toolbar_location",Tb.auto,"string")},Mb=function(t){return Ab(t)===Tb.bottom},Fb=function(t){if(!t.inline)return R.none();var n=function(t){return t.getParam("fixed_toolbar_container","","string")}(t);if(n.length>0)return fa(ou(),n);var e=function(t){return t.getParam("fixed_toolbar_container_target")}(t);return l(e)?R.some(ie.fromDom(e)):R.none()},Ib=function(t){return t.inline&&Fb(t).isSome()},Rb=function(t){return Fb(t).getOrThunk((function(){return Nr(zr(ie.fromDom(t.getElement())))}))},Vb=function(t){return t.inline&&!kb(t)&&!Cb(t)&&!_b(t)},Pb=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Ib(t)&&!Vb(t)},Hb=function(t){var n=t.getParam("menu");return n?Mt(n,(function(t){return _(_({},t),{items:t.items})})):{}},zb=function(t){return t.getParam("menubar")},Nb=function(t){return t.getParam("anchor_top","#top")},Lb=function(t){return t.getParam("anchor_bottom","#bottom")},jb="silver.readonly",Wb=an([(Db="readonly",Fn(Db,hn))]),Ub=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([al()],{target:e}),t.uiMothership.broadcastOn([al()],{target:e})),t.mothership.broadcastOn([jb],{readonly:n}),t.uiMothership.broadcastOn([jb],{readonly:n})},Gb=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&Ub(n,!0)})),t.on("SwitchMode",(function(){return Ub(n,t.mode.isReadOnly())})),function(t){return t.getParam("readonly",!1,"boolean")}(t)&&t.setMode("readonly")},Xb=function(){var t;return Tc.config({channels:(t={},t[jb]={schema:Wb,onReceive:function(t,n){Kd.set(t,n.readonly)}},t)})},qb=function(t){return Kd.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Yb=function(t){return Kd.config({disabled:t})},Kb=function(t){return Kd.config({disabled:t,disableClass:"tox-tbtn--disabled"})},Jb=function(t){return Kd.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},$b=function(t,n){var e=t.getApi(n);return function(t){t(e)}},Qb=function(t,n){return pr((function(e){$b(t,e)((function(e){var o=t.onSetup(e);d(o)&&n.set(o)}))}))},Zb=function(t,n){return hr((function(e){return $b(t,e)(n.get())}))},ty=function(t,n){return br((function(e,o){$b(t,e)(t.onAction),t.triggersSubmenu||n!==hv.CLOSE_ON_EXECUTE||(Qo(e,Ro()),o.stop())}))},ny=((Bb={})[Ao()]=["disabling","alloy.base.behaviour","toggling","item-events"],Bb),ey=Qi,oy=function(t,n,e,o){var r=oe(p);return{type:"item",dom:n.dom,components:ey(n.optComponents),data:t.data,eventOrder:ny,hasSubmenu:t.triggersSubmenu,itemBehaviours:wc([cp("item-events",[ty(t,e),Qb(t,r),Zb(t,r)]),qb((function(){return t.disabled||o.isDisabled()})),Xb(),ap.config({})].concat(t.itemBehaviours))}},ry=function(t){return{value:t.value,meta:_({text:t.text.getOr("")},t.meta)}},iy=tinymce.util.Tools.resolve("tinymce.Env"),uy=function(t){var n=iy.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=t.split("+"),o=U(e,(function(t){var e=t.toLowerCase().trim();return zt(n,e)?n[e]:t}));return iy.mac?o.join(""):o.join("+")},ay=function(t,n,e){return void 0===e&&(e=[Sv]),Eh(t,{tag:"div",classes:e},n)},cy=function(t){return{dom:{tag:"div",classes:[kv]},components:[_u(yh.translate(t))]}},sy=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},fy=function(t,n){return{dom:{tag:"div",classes:[kv]},components:[{dom:{tag:t.tag,styles:t.styles},components:[_u(yh.translate(n))]}]}},ly=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:uy(t)}}},dy=function(t){return ay("checkmark",t,["tox-collection__item-checkmark"])},my=function(t,n,e){var o,r,i,u=t.ariaLabel,a=t.value,c=t.iconContent.map((function(t){return function(t,n,e){var o=n();return Ch(t,o).or(e).getOrThunk(Sh(o))}(t,n.icons,e)}));return{dom:(o=c.getOr(""),r=u.map((function(t){return{title:n.translate(t)}})).getOr({}),i={tag:"div",attributes:r,classes:["tox-swatch"]},_(_({},i),"custom"===a?{tag:"button",classes:E(E([],i.classes),["tox-swatches__picker-btn"]),innerHtml:o}:"remove"===a?{classes:E(E([],i.classes),["tox-swatch--remove"]),innerHtml:o}:{attributes:_(_({},i.attributes),{"data-mce-color":a}),styles:{"background-color":a}})),optComponents:[]}},gy=function(t){var n=t.map((function(t){return{attributes:{title:yh.translate(t)}}})).getOr({});return _({tag:"div",classes:[vv,bv]},n)},py=function(t,n,e,o){return void 0===o&&(o=R.none()),"color"===t.presets?my(t,n,o):function(t,n,e,o){var r={tag:"div",classes:[Sv]},i=e?t.iconContent.map((function(t){return Eh(t,r,n.icons,o)})).orThunk((function(){return R.some({dom:r})})):R.none(),u=t.checkMark,a=R.from(t.meta).fold((function(){return cy}),(function(t){return zt(t,"style")?x(fy,t.style):cy})),c=t.htmlContent.fold((function(){return t.textContent.map(a)}),(function(t){return R.some(sy(t,[kv]))}));return{dom:gy(t.ariaLabel),optComponents:[i,c,t.shortcutContent.map(ly),u,t.caret]}}(t,n,e,o)},hy=function(t,n){return Ht(t,"tooltipWorker").map((function(t){return[gb.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:ms}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){gb.setComponents(n,[Tu({element:ie.fromDom(t)})])}))}})]})).getOr([])},vy=function(t,n){var e=function(t){return pb.DOM.encode(t)}(yh.translate(t));if(n.length>0){var o=new RegExp(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(n),"gi");return e.replace(o,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return e},by=function(t,n){return U(t,(function(t){switch(t.type){case"cardcontainer":return function(t,n){var e="vertical"===t.direction?"tox-collection__item-container--column":Tv,o="left"===t.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[_v,e,o,function(){switch(t.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:n}}(t,by(t.items,n));case"cardimage":return function(t,n,e){return{dom:{tag:"img",classes:n,attributes:{src:t,alt:e.getOr("")}}}}(t.src,t.classes,t.alt);case"cardtext":var e=t.name.exists((function(t){return N(n.cardText.highlightOn,t)})),o=e?R.from(n.cardText.matchText).getOr(""):"";return sy(vy(t.text,o),t.classes)}}))},yy=sd(Vp(),Pp()),xy=function(t){return{value:t}},wy=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Sy=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ky=function(t){return wy.test(t)||Sy.test(t)},Cy=function(t){return function(t,n){return de(t,n)?function(t,n){return t.substring(n)}(t,n.length):t}(t,"#").toUpperCase()},Oy=function(t){var n=function(t){var n=t.value.replace(wy,(function(t,n,e,o){return n+n+e+e+o+o}));return{value:n}}(t),e=Sy.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},_y=function(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},Ty=function(t){var n=_y(t.red)+_y(t.green)+_y(t.blue);return xy(n)},Ey=Math.min,Dy=Math.max,By=Math.round,Ay=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,My=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Fy=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Iy=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},Ry=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;if(i=Dy(0,Ey(i,1)),u=Dy(0,Ey(u,1)),0===i)return n=e=o=By(255*u),Fy(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=By(255*(n+f)),e=By(255*(e+f)),o=By(255*(o+f)),Fy(n,e,o,1)},Vy=function(t){var n=Oy(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return Fy(e,o,r,1)},Py=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Fy(r,i,u,a)},Hy=function(t){if("transparent"===t)return R.some(Fy(0,0,0,0));var n=Ay.exec(t);if(null!==n)return R.some(Py(n[1],n[2],n[3],"1"));var e=My.exec(t);return null!==e?R.some(Py(e[1],e[2],e[3],e[4])):R.none()},zy=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Ny=Fy(255,0,0,1),Ly=function(t,n){return t.fire("ResizeContent",n)},jy=function(t,n,e){return{hue:t,saturation:n,value:e}},Wy=function(t){var n,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));return a===c?jy(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),n=(c-a)/c,o=c,jy(Math.round(e),Math.round(100*n),Math.round(100*o)))},Uy=function(t){return Ty(Ry(t))},Gy=function(t){return(n=t,ky(n)?R.some({value:Cy(n)}):R.none()).orThunk((function(){return Hy(t).map(Ty)})).getOrThunk((function(){var n=document.createElement("canvas");n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1);var o=e.getImageData(0,0,1,1).data,r=o[0],i=o[1],u=o[2],a=o[3];return Ty(Fy(r,i,u,a))}));var n},Xy=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),qy="tinymce-custom-colors";var Yy,Ky="choiceitem",Jy=[{type:Ky,text:"Light Green",value:"#BFEDD2"},{type:Ky,text:"Light Yellow",value:"#FBEEB8"},{type:Ky,text:"Light Red",value:"#F8CAC6"},{type:Ky,text:"Light Purple",value:"#ECCAFA"},{type:Ky,text:"Light Blue",value:"#C2E0F4"},{type:Ky,text:"Green",value:"#2DC26B"},{type:Ky,text:"Yellow",value:"#F1C40F"},{type:Ky,text:"Red",value:"#E03E2D"},{type:Ky,text:"Purple",value:"#B96AD9"},{type:Ky,text:"Blue",value:"#3598DB"},{type:Ky,text:"Dark Turquoise",value:"#169179"},{type:Ky,text:"Orange",value:"#E67E23"},{type:Ky,text:"Dark Red",value:"#BA372A"},{type:Ky,text:"Dark Purple",value:"#843FA1"},{type:Ky,text:"Dark Blue",value:"#236FA1"},{type:Ky,text:"Light Gray",value:"#ECF0F1"},{type:Ky,text:"Medium Gray",value:"#CED4D9"},{type:Ky,text:"Gray",value:"#95A5A6"},{type:Ky,text:"Dark Gray",value:"#7E8C8D"},{type:Ky,text:"Navy Blue",value:"#34495E"},{type:Ky,text:"Black",value:"#000000"},{type:Ky,text:"White",value:"#ffffff"}],$y=function(t){void 0===t&&(t=10);var n,e=Xy.getItem(qy),o=r(e)?JSON.parse(e):[],i=t-(n=o).length<0?n.slice(0,t):n,u=function(t){i.splice(t,1)};return{add:function(n){(function(t,n){var e=z(t,n);return-1===e?R.none():R.some(e)})(i,n).each(u),i.unshift(n),i.length>t&&i.pop(),Xy.setItem(qy,JSON.stringify(i))},state:function(){return i.slice(0)}}}(10),Qy=function(t){return!1!==t.getParam("custom_colors")},Zy=function(t){var n=function(t){return t.getParam("color_map")}(t);return void 0!==n?function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+Gy(t[e]).value,type:"choiceitem"});return n}(n):Jy},tx=function(t){$y.add(t)},nx=function(t){var n=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))}(Zy(t).length);return function(t,n){return t.getParam("color_cols",n,"number")}(t,n)},ex=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]},ox=function(t,n,e,o){"custom"===e?sx(t)((function(e){e.each((function(e){tx(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},rx=function(t,n){return t.concat(U($y.state(),(function(t){return{type:Ky,text:t,value:t}})).concat(ex(n)))},ix=function(t,n){return function(e){e(rx(t,n))}},ux=function(t,n,e){var o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";t.setIconFill(o,e)},ax=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o=R.from(function(t,n){var e;return t.dom.getParents(t.selection.getStart(),(function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)})),e}(t,e));return o.bind((function(t){return Hy(t).map((function(t){var e=Ty(t).value;return le(n.toLowerCase(),e)}))})).getOr(!1)},columns:nx(t),fetch:ix(Zy(t),Qy(t)),onAction:function(n){null!==r.get()&&ox(t,e,r.get(),p)},onItemAction:function(o,i){ox(t,e,i,(function(e){r.set(e),function(t,n){t.fire("TextColorChange",n)}(t,{name:n,color:e})}))},onSetup:function(e){null!==r.get()&&ux(e,n,r.get());var o=function(t){t.name===n&&ux(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},cx=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){ox(t,e,n.value,p)}}]}})},sx=function(t){return function(n,e){var o=!1,r={colorpicker:e};t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(e){var r=e.getData().colorpicker;o?(n(R.from(r)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",r]))},onClose:p,onCancel:function(){n(R.none())}})}},fx=function(t,n,e,o,r,i,u,a){var c=Hv(n),s=lx(n,e,o,"color"!==r?"normal":"color",i,u,a);return Lv(t,c,s,o,r)},lx=function(t,n,e,o,r,i,u){return Qi(U(t,(function(a){return"choiceitem"===a.type?(c=a,Cn("choicemenuitem",Jv,c)).fold(zv,(function(c){return R.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=py({presets:e,textContent:n?t.text:R.none(),htmlContent:R.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:R.none(),checkMark:n?R.some(dy(u.icons)):R.none(),caret:R.none(),value:t.value},u,a);return jt(oy({data:ry(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Op.set(t,n)},isActive:function(){return Op.isOn(t)},isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),p},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:wv,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,Hv(t)))})):R.none();var c})))},dx=function(t,n){var e=Av(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},mx=function(t,n){var e=t.initData.allowCustomColors&&n.colorinput.hasCustomColors();return t.initData.colors.fold((function(){return rx(n.colorinput.getColors(),e)}),(function(t){return t.concat(ex(e))}))},gx=di("cell-over"),px=di("cell-execute"),hx=function(t,n,e){var o,r=function(e){return Zo(e,px,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return Du({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:wc([cp("insert-table-picker-cell",[ar(mo(),mp.focus),ar(Ao(),r),ar(xo(),i),ar(Fo(),i)]),Op.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),mp.config({onFocus:function(e){return Zo(e,gx,{row:t,col:n})}})])})},vx=function(t){return Z(t,(function(t){return U(t,Bu)}))},bx=function(t,n){return _u(n+1+"x"+(t+1))},yx={inserttable:function(t){var n=di("size-label"),e=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(hx(r,u,t));o.push(i)}return o}(n,10,10),o=bh({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[_u("0x0")],behaviours:wc([ap.config({})])});return{type:"widget",data:{value:di("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[yy.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:vx(e).concat(o.asSpec()),behaviours:wc([cp("insert-table-picker",[lr(gx,(function(t,n,r){var i=r.event.row,u=r.event.col;!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Op.set(t[i][u],i<=n&&u<=e)}(e,i,u,10,10),ap.set(o.get(t),[bx(i,u)])})),lr(px,(function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Qo(n,Ro())}))]),np.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=mx(t,n),o=n.colorinput.getColorCols(),r="color",i=fx(di("menu-value"),e,(function(n){t.onAction({value:n})}),o,r,hv.CLOSE_ON_EXECUTE,k,n.shared.providers),u=_(_({},i),{markers:Av(r),movement:dx(o,r)});return{type:"widget",data:{value:di("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[yy.widget(Wp.sketch(u))]}}},xx=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=py({presets:o,textContent:R.none(),htmlContent:e?t.text.map((function(t){return vy(t,n)})):R.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:R.none(),checkMark:R.none(),caret:R.none(),value:t.value},u.providers,a,t.icon);return oy({data:ry(t),disabled:t.disabled,getApi:v({}),onAction:function(n){return r(t.value,t.meta)},onSetup:v(p),triggersSubmenu:!1,itemBehaviours:hy(t.meta,u)},c,i,u.providers)},wx=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:_({tag:"div",classes:[bv,"tox-collection__group-heading"]},n),components:[]}},Sx=function(t,n,e,o){void 0===o&&(o=!0);var r=py({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:R.none(),ariaLabel:t.text,caret:R.none(),checkMark:R.none(),shortcutContent:t.shortcut},e,o);return oy({data:ry(t),getApi:function(t){return{isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},kx=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i,u=r?(i=e.icons,ay("chevron-down",i,[Cv])):function(t){return ay("chevron-right",t,[Cv])}(e.icons),a=py({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:R.none(),ariaLabel:t.text,caret:R.some(u),checkMark:R.none(),shortcutContent:t.shortcut},e,o);return oy({data:ry(t),getApi:function(t){return{isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)}}},disabled:t.disabled,onAction:p,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,e)},Cx=function(t,n,e,o){void 0===o&&(o=!0);var r=py({iconContent:t.icon,textContent:t.text,htmlContent:R.none(),ariaLabel:t.text,checkMark:R.some(dy(e.icons)),caret:R.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return jt(oy({data:ry(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Op.set(t,n)},isActive:function(){return Op.isOn(t)},isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:wv,toggleOnExecute:!1,selected:t.active}})},Ox=function(t,n){return Ht(yx,t.fancytype).map((function(e){return e(t,n)}))},_x=function(t,n,e,o){var r={dom:gy(t.label),optComponents:[R.some({dom:{tag:"div",classes:[_v,Tv]},components:by(t.items,o)})]};return oy({data:ry(_({text:R.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){Kd.set(t,n),G(of(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(Kd)&&Kd.set(t,n)}))}))}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:R.from(o.itemBehaviours).getOr([])},r,n,e.providers)};!function(t){t[t.ContentFocus=0]="ContentFocus",t[t.UiFocus=1]="UiFocus"}(Yy||(Yy={}));var Tx=function(t,n,e,o,r){var i,u=e.shared.providers,a=function(t){return r?_(_({},t),{shortcut:R.none(),icon:t.text.isSome()?R.none():t.icon}):t};switch(t.type){case"menuitem":return(i=t,Cn("menuitem",nb,i)).fold(zv,(function(t){return R.some(Sx(a(t),n,u,o))}));case"nestedmenuitem":return function(t){return Cn("nestedmenuitem",eb,t)}(t).fold(zv,(function(t){return R.some(kx(a(t),n,u,o,r))}));case"togglemenuitem":return function(t){return Cn("togglemenuitem",ob,t)}(t).fold(zv,(function(t){return R.some(Cx(a(t),n,u,o))}));case"separator":return function(t){return Cn("separatormenuitem",$h,t)}(t).fold(zv,(function(t){return R.some(wx(t))}));case"fancymenuitem":return function(t){return Cn("fancymenuitem",tb,t)}(t).fold(zv,(function(t){return Ox(a(t),e)}));default:return console.error("Unknown item in general menu",t),R.none()}},Ex=function(t,n,e,o,r,i,u){var a=1===o,c=!a||Hv(t);return Qi(U(t,(function(t){switch(t.type){case"separator":return(o=t,Cn("Autocompleter.Separator",$h,o)).fold(zv,(function(t){return R.some(wx(t))}));case"cardmenuitem":return function(t){return Cn("cardmenuitem",Kv,t)}(t).fold(zv,(function(t){return R.some(_x(_(_({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:hy(t.meta,i),cardText:{matchText:n,highlightOn:u}}))}));default:return function(t){return Cn("Autocompleter.Item",Qh,t)}(t).fold(zv,(function(t){return R.some(xx(t,n,a,"normal",e,r,i,c))}))}var o})))},Dx=function(t,n,e,o,r){var i=Hv(n),u=Qi(U(n,(function(t){var n=function(t){return Tx(t,e,o,function(t){return r?!zt(t,"text"):i}(t),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(_(_({},t),{disabled:!0})):n(t)})));return(r?Nv:Lv)(t,i,u,1,"normal")},Bx=function(t){return Kp.singleData(t.value,t)},Ax=function(t,n){var e=Qc(),o=oe(!1),r=Du(Jp.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:wc([cp("dismissAutocompleter",[ar(Uo(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&Jp.hide(r)},a=function(){if(i()){var n=e.get().map((function(t){return t.element}));Ph(n.getOr(ie.fromDom(t.selection.getNode()))).each($r),u(),e.clear(),o.set(!1)}},c=Ut((function(){return gv(t)})),s=function(n,e,o,i){n.matchLength=e.text.length;var u=ft(o,(function(t){return R.from(t.columns)})).getOr(1);Jp.showAt(r,Wp.sketch(function(t,n,e,o){var r=e===Yy.ContentFocus?Em():Tm(),i=dx(n,o),u=Av(o);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===Yy.ContentFocus,focusManager:r,menuBehaviours:ub("auto"!==n?[]:[pr((function(t,n){rb(t,4,u.item).each((function(n){var e=n.numColumns,o=n.numRows;np.setGridSize(t,o,e)}))}))])}}(Lv("autocompleter-value",!0,i,u,"normal"),u,Yy.ContentFocus,"normal")),{anchor:{type:"node",root:ie.fromDom(t.getBody()),node:R.from(n.element)}}),Jp.getContent(r).each(um.highlightFirst)},f=function(r){(function(n){return e.get().map((function(e){return jh(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return Jh(t,c,e,n)}))})).getOrThunk((function(){return Kh(t,c)}))})(r).fold(a,(function(r){!function(n){if(!i()){var r=Vh(t,n.range);e.set({triggerChar:n.triggerChar,element:r,matchLength:n.text.length}),o.set(!1)}}(r.context),r.lookupData.then((function(i){e.get().map((function(e){var c,l,d,m=r.context;if(e.triggerChar===m.triggerChar){var g=(c=m.triggerChar,d=ft(l=i,(function(t){return R.from(t.columns)})).getOr(1),Z(l,(function(e){var r=e.items;return Ex(r,e.matchText,(function(n,r){var i=t.selection.getRng();jh(t.dom,i,c).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),f(t)}};o.set(!0),e.onAction(c,i,n,r),o.set(!1)}))}),d,hv.BUBBLE_TO_SANDBOX,n,e.highlightOn)})));g.length>0?s(e,m,i,g):m.text.length-e.matchLength>=10?a():u()}}))}))}))},l={onKeypress:Fh((function(t){27!==t.which&&f()}),50),cancelIfNecessary:a,isMenuOpen:function(){return Jp.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return Jp.getContent(r)}};!1===t.hasPlugin("rtc")&&Wh(l,t)},Mx=function(t,n,e){return la(t,n,e).isSome()},Fx=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Ix=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?R.none():R.some(n.touches[0])},Rx=function(t){var n=Qc(),e=oe(!1),o=Fx((function(n){t.triggerEvent(Io(),n),e.set(!0)}),400),r=Ye([{key:ro(),value:function(t){return Ix(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(i)})),R.none()}},{key:io(),value:function(t){return o.cancel(),Ix(t).each((function(t){n.on((function(e){(function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y);return e>5||o>5})(t,e)&&n.clear()}))})),R.none()}},{key:uo(),value:function(r){o.cancel();return n.get().filter((function(t){return je(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(Fo(),r)}))}}]);return{fireIfReady:function(t,n){return Ht(r,n).bind((function(n){return n(t)}))}}},Vx=function(){return ze().browser.isFirefox()},Px=un([Pn("triggerEvent"),Yn("stopBackspace",!0)]),Hx=function(t,n){var e=_n("Getting GUI events settings",Px,n),o=Rx(e),r=U(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return ts(t,n,(function(t){o.fireIfReady(t,n).each((function(n){n&&t.kill()})),e.triggerEvent(n,t)&&t.kill()}))})),i=Qc(),u=ts(t,"paste",(function(t){o.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),e.triggerEvent("paste",t)&&t.kill(),i.set(setTimeout((function(){e.triggerEvent(Do(),t)}),0))})),a=ts(t,"keydown",(function(t){e.triggerEvent("keydown",t)?t.kill():!0===e.stopBackspace&&function(t){return t.raw.which===am[0]&&!N(["input","textarea"],xr(t.target))&&!Mx(t.target,'[contenteditable="true"]')}(t)&&t.prevent()})),c=function(t,n){return Vx()?ns(t,"focus",n):ts(t,"focusin",n)}(t,(function(t){e.triggerEvent("focusin",t)&&t.kill()})),s=Qc(),f=function(t,n){return Vx()?ns(t,"blur",n):ts(t,"focusout",n)}(t,(function(t){e.triggerEvent("focusout",t)&&t.kill(),s.set(setTimeout((function(){e.triggerEvent(Eo(),t)}),0))}));return{unbind:function(){G(r,(function(t){t.unbind()})),a.unbind(),c.unbind(),f.unbind(),u.unbind(),i.on(clearTimeout),s.on(clearTimeout)}}},zx=function(t,n){var e=Ht(t,"target").getOr(n);return oe(e)},Nx=Ge([{stopped:[]},{resume:["element"]},{complete:[]}]),Lx=function(t,n,e,o,r,i){var u=t(n,o),a=function(t,n){var e=oe(!1),o=oe(!1);return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}}(e,r);return u.fold((function(){return i.logEventNoHandlers(n,o),Nx.complete()}),(function(t){var e=t.descHandler;return Mi(e)(a),a.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Nx.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),Nx.complete()):Br(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),Nx.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),Nx.resume(o)}))}))},jx=function(t,n,e,o,r,i){return Lx(t,n,e,o,r,i).fold(C,(function(o){return jx(t,n,e,o,r,i)}),k)},Wx=function(t,n,e){var o=function(t){var n=oe(!1);return{stop:function(){n.set(!0)},cut:p,isStopped:n.get,isCut:k,event:t,setSource:S("Cannot set source of a broadcasted event"),getSource:S("Cannot get source of a broadcasted event")}}(n);return G(t,(function(t){var n=t.descHandler;Mi(n)(o)})),o.isStopped()},Ux=function(t,n,e,o,r){var i=zx(e,o);return jx(t,n,e,o,i,r)},Gx=function(){var t={};return{registerId:function(n,e,o){At(o,(function(o,r){var i=void 0!==t[r]?t[r]:{};i[e]=function(t,n){return e=x.apply(void 0,[t.handler].concat(n)),o=t.purpose,{cHandler:e,purpose:o};var e,o}(o,n),t[r]=i}))},unregisterId:function(n){At(t,(function(t,e){zt(t,n)&&delete t[n]}))},filterByType:function(n){return Ht(t,n).map((function(t){return Rt(t,(function(t,n){return function(t,n){return{id:t,descHandler:n}}(n,t)}))})).getOr([])},find:function(n,e,o){var r=Ht(t,e);return Qe(o,(function(t){return function(t,n){return bi(n).fold((function(){return R.none()}),(function(e){return t.bind((function(t){return Ht(t,e)})).map((function(t){return function(t,n){return{element:t,descHandler:n}}(n,t)}))}))}(r,t)}),n)}}},Xx=function(){var t=Gx(),n={},e=function(t){var n=t.element;return bi(n).getOrThunk((function(){return function(t,n){var e=di(pi+t);return vi(n,e),e}("uid-",t.element)}))},o=function(e){bi(e.element).each((function(e){delete n[e],t.unregisterId(e)}))};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(r){var i=e(r);Nt(n,i)&&function(t,e){var r=n[e];if(r!==t)throw new Error('The tagId "'+e+'" is already used by: '+ci(r.element)+"\nCannot use it for: "+ci(t.element)+"\nThe conflicting element is"+(eu(r.element)?" ":" not ")+"already in the DOM");o(t)}(r,i);var u=[r];t.registerId(u,i,r.events),n[i]=r},unregister:o,getById:function(t){return Ht(n,t)}}},qx=Bd({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=T(n,["attributes"]);return{uid:t.uid,dom:_({tag:"div",attributes:_({role:"presentation"},e)},o),components:t.components,behaviours:El(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Yn("components",[]),Tl("containerBehaviours",[]),Yn("events",{}),Yn("domModification",{}),Yn("eventOrder",{})]}),Yx=function(t){var n=function(n){return Br(t.element).fold(C,(function(t){return je(n,t)}))},e=Xx(),o=function(t,o){return e.find(n,t,o)},r=Hx(t.element,{triggerEvent:function(t,n){return ya(t,n.target,(function(e){return function(t,n,e,o){return Ux(t,n,e,e.target,o)}(o,t,n,e)}))}}),i={debugInfo:v("real"),triggerEvent:function(t,n,e){ya(t,n,(function(r){return Ux(o,t,e,n,r)}))},triggerFocus:function(t,n){bi(t).fold((function(){Dc(t)}),(function(e){ya(To(),t,(function(e){return function(t,n,e,o,r){var i=zx(e,o);Lx(t,n,e,o,i,r)}(o,To(),{originator:n,kill:p,prevent:p,target:t},t,e),!1}))}))},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return g(t)},getByDom:function(t){return h(t)},build:Du,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){l(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:C},u=function(t){t.connect(i),kr(t.element)||(e.register(t),G(t.components(),u),i.triggerEvent(Po(),t.element,{target:t.element}))},a=function(t){kr(t.element)||(G(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){jf(t,n)},s=function(t){Gf(t)},f=function(t){var n=e.filter(Bo());G(n,(function(n){var e=n.descHandler;Mi(e)(t)}))},l=function(t){f({universal:!0,data:t})},d=function(t,n){f({universal:!1,channels:t,data:n})},m=function(t,n){var o=e.filter(t);return Wx(o,n)},g=function(t){return e.getById(t).fold((function(){return mt.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),mt.value)},h=function(t){var n=bi(t).getOr("not found");return g(n)};return u(t),{root:t,element:t.element,destroy:function(){r.unbind(),Jr(t.element)},add:c,remove:s,getByUid:g,getByDom:h,addToWorld:u,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:m}},Kx=v([Yn("prefix","form-field"),Tl("fieldBehaviours",[Rd,_l])]),Jx=v([rd({schema:[Mn("dom")],name:"label"}),rd({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Mn("text")],name:"aria-descriptor"}),ed({factory:{sketch:function(t){var n=Xe(t,["factory"]);return t.factory.sketch(n)}},schema:[Mn("factory")],name:"field"})]),$x=Ad({name:"FormField",configFields:Kx(),partFields:Jx(),factory:function(t,n,e,o){var r=Dl(t.fieldBehaviours,[Rd.config({find:function(n){return hd(n,t,"field")}}),_l.config({store:{mode:"manual",getValue:function(t){return Rd.getCurrent(t).bind(_l.getValue)},setValue:function(t,n){Rd.getCurrent(t).each((function(t){_l.setValue(t,n)}))}}})]),i=rr([pr((function(n,e){var o=bd(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=di(t.prefix);o.label().each((function(t){ni(t.element,"for",e),ni(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=di(t.prefix);ni(e.element,"id",o),ni(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return hd(n,t,"field")},getLabel:function(n){return hd(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Qx=Object.freeze({__proto__:null,exhibit:function(t,n){return Ai({attributes:Ye([{key:n.tabAttr,value:"true"}])})}}),Zx=[Yn("tabAttr","data-alloy-tabstop")],tw=kc({fields:Zx,name:"tabstopping",active:Qx}),nw=tinymce.util.Tools.resolve("tinymce.html.Entities"),ew=function(t,n,e,o){var r=ow(t,n,e,o);return $x.sketch(r)},ow=function(t,n,e,o){return{dom:rw(e),components:t.toArray().concat([n]),fieldBehaviours:wc(o)}},rw=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},iw=function(t,n){return $x.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},uw=di("form-component-change"),aw=di("form-close"),cw=di("form-cancel"),sw=di("form-action"),fw=di("form-submit"),lw=di("form-block"),dw=di("form-unblock"),mw=di("form-tabchange"),gw=di("form-resize"),pw=function(t,n){var e,o,r,i=t.label.map((function(t){return iw(t,n)})),u=function(t){return function(n,e){la(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,ei(o,"data-collection-item-value"))}))}},a=u((function(e,o,r,i){o.stop(),n.isDisabled()||Zo(e,sw,{name:t.name,value:i})})),c=[ar(mo(),u((function(t,n,e){Dc(e)}))),ar(xo(),a),ar(Fo(),a),ar(go(),u((function(t,n,e){fa(t.element,"."+Ov).each((function(t){qi(t,Ov)})),Gi(e,Ov)}))),ar(po(),u((function(t){fa(t.element,"."+Ov).each((function(t){qi(t,Ov)}))}))),br(u((function(n,e,o,r){Zo(n,sw,{name:t.name,value:r})})))],s=function(t,n){return U(of(t.element,".tox-collection__item"),n)},f=$x.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:b},behaviours:wc([Kd.config({disabled:n.isDisabled,onDisabled:function(t){s(t,(function(t){Gi(t,"tox-collection__item--state-disabled"),ni(t,"aria-disabled",!0)}))},onEnabled:function(t){s(t,(function(t){qi(t,"tox-collection__item--state-disabled"),ii(t,"aria-disabled")}))}}),Xb(),ap.config({}),_l.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){!function(e,o){var r=U(o,(function(e){var o=yh.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+nw.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==t.columns&&t.columns>1?W(r,t.columns):[r],u=U(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));Zr(e.element,u.join(""))}(e,o),"auto"===t.columns&&rb(e,5,"tox-collection__item").each((function(t){var n=t.numRows,o=t.numColumns;np.setGridSize(e,n,o)})),Qo(e,gw)}}),tw.config({}),np.config((o=t.columns,r="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===r?".tox-swatches__row":".tox-collection__group",cell:"color"===r?".tox-swatch":"."+bv}})),cp("collection-events",c)]),eventOrder:(e={},e[Ao()]=["disabling","alloy.base.behaviour","collection-events"],e)});return ew(i,f,["tox-form__group--collection"],[])},hw=v([Ln("data"),Yn("inputAttributes",{}),Yn("inputStyles",{}),Yn("tag","input"),Yn("inputClasses",[]),Ea("onSetValue"),Yn("styles",{}),Yn("eventOrder",{}),Tl("inputBehaviours",[_l,mp]),Yn("selectOnFocus",!0)]),vw=function(t){return wc([mp.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=vu(n);n.dom.setSelectionRange(0,e.length)}:p})])},bw=function(t){return _(_({},vw(t)),Dl(t.inputBehaviours,[_l.config({store:_(_({mode:"manual"},t.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return vu(t.element)},setValue:function(t,n){vu(t.element)!==n&&bu(t.element,n)}}),onSetValue:t.onSetValue})]))},yw=function(t){return{tag:t.tag,attributes:_({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},xw=Bd({name:"Input",configFields:hw(),factory:function(t,n){return{uid:t.uid,dom:yw(t),components:[],behaviours:bw(t),eventOrder:t.eventOrder}}}),ww={},Sw={exports:ww};!function(n,e,o,r){!function(r){if("object"==typeof e&&void 0!==o)o.exports=r();else if("function"==typeof n&&n.amd)n([],r);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).EphoxContactWrapper=r()}}((function(){return function t(n,e,o){function i(a,c){if(!e[a]){if(!n[a]){var s="function"==typeof r&&r;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};n[a][0].call(l.exports,(function(t){return i(n[a][1][t]||t)}),l,l.exports,t,n,e,o)}return e[a].exports}for(var u="function"==typeof r&&r,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,n,e){var o,r,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,f=[],l=!1,d=-1;function m(){l&&s&&(l=!1,s.length?f=s.concat(f):d=-1,f.length&&g())}function g(){if(!l){var t=c(m);l=!0;for(var n=f.length;n;){for(s=f,f=[];++d<n;)s&&s[d].run();d=-1,n=f.length}s=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function h(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];f.push(new p(t,n)),1!==f.length||l||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){!function(e){var o=setTimeout;function r(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function u(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void c(n.promise,t)}a(n.promise,o)}else(1===t._state?a:c)(n.promise,t._value)}))):t._deferreds.push(n)}function a(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof i)return t._state=3,t._value=n,void s(t);if("function"==typeof e)return void l((o=e,r=n,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=n,s(t)}catch(n){c(t,n)}var o,r}function c(t,n){t._state=2,t._value=n,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&i._immediateFn((function(){t._handled||i._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)u(t,t._deferreds[n]);t._deferreds=null}function f(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t((function(t){e||(e=!0,a(n,t))}),(function(t){e||(e=!0,c(n,t))}))}catch(t){if(e)return;e=!0,c(n,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(r);return u(this,new f(t,n,e)),e},i.all=function(t){var n=Array.prototype.slice.call(t);return new i((function(t,e){if(0===n.length)return t([]);var o=n.length;function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0==--o&&t(n)}catch(t){e(t)}}for(var i=0;i<n.length;i++)r(i,n[i])}))},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i((function(n){n(t)}))},i.reject=function(t){return new i((function(n,e){e(t)}))},i.race=function(t){return new i((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},i._immediateFn="function"==typeof t?function(n){t(n)}:function(t){o(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){var r=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"==typeof n?n:function(t){var n=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,r((function(){a[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof o?o:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))}(void 0,ww,Sw,void 0);var kw,Cw=Sw.exports.boltExport,Ow=function(t){var n=R.none(),e=[],o=function(t){r()?u(t):e.push(t)},r=function(){return n.isSome()},i=function(t){G(t,u)},u=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))};return t((function(t){r()||(n=R.some(t),i(e),e=[])})),{get:o,map:function(t){return Ow((function(n){o((function(e){n(t(e))}))}))},isReady:r}},_w={nu:Ow,pure:function(t){return Ow((function(n){n(t)}))}},Tw=function(t){setTimeout((function(){throw t}),0)},Ew=function(t){var n=function(n){t().then(n,Tw)};return{map:function(n){return Ew((function(){return t().then(n)}))},bind:function(n){return Ew((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return Ew((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return _w.nu(n)},toCached:function(){var n=null;return Ew((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},Dw=function(t){return Ew((function(){return new Cw(t)}))},Bw=function(t){return Ew((function(){return Cw.resolve(t)}))},Aw=["input","textarea"],Mw=function(t){var n=xr(t);return N(Aw,n)},Fw=function(t,n){var e=n.getRoot(t).getOr(t.element);qi(e,n.invalidClass),n.notify.each((function(n){Mw(t.element)&&ni(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Zr(t,n.validHtml)})),n.onValid(t)}))},Iw=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);Gi(r,n.invalidClass),n.notify.each((function(n){Mw(t.element)&&ni(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Zr(t,o)})),n.onInvalid(t,o)}))},Rw=function(t,n,e){return n.validator.fold((function(){return Bw(mt.value(!0))}),(function(n){return n.validate(t)}))},Vw=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),Rw(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return Iw(t,n,0,e),mt.error(e)}),(function(e){return Fw(t,n),mt.value(e)})):mt.error("No longer in system")}))},Pw=Object.freeze({__proto__:null,markValid:Fw,markInvalid:Iw,query:Rw,run:Vw,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return Yi(e,n.invalidClass)}}),Hw=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map((function(n){return rr([ar(n.onEvent,(function(n){Vw(n,t).get(b)}))].concat(n.validateOnLoad?[pr((function(n){Vw(n,t).get(p)}))]:[]))})).getOr({})}}),zw=[Mn("invalidClass"),Yn("getRoot",R.none),qn("notify",[Yn("aria","alert"),Yn("getContainer",R.none),Yn("validHtml",""),Ea("onValid"),Ea("onInvalid"),Ea("onValidate")]),qn("validator",[Mn("validate"),Yn("onEvent","input"),Yn("validateOnLoad",!0)])],Nw=kc({fields:zw,name:"invalidating",active:Hw,apis:Pw,extra:{validation:function(t){return function(n){var e=_l.getValue(n);return Bw(t(e))}}}}),Lw=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),jw=[Fn("others",kn(mt.value,dn()))],Ww=Object.freeze({__proto__:null,init:function(){var t={},n=v({});return Di({readState:n,getOrCreate:function(n,e,o){var r=Dt(e.others);if(r)return Ht(t,o).getOrThunk((function(){var r=Ht(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i,i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}}),Uw=kc({fields:jw,name:"coupling",apis:Lw,state:Ww}),Gw=v("sink"),Xw=v(rd({name:Gw(),overrides:v({dom:{tag:"div"},behaviours:wc([Pf.config({useFixed:C})]),events:rr([dr(ho()),dr(co()),dr(xo())])})}));!function(t){t[t.HighlightFirst=0]="HighlightFirst",t[t.HighlightNone=1]="HighlightNone"}(kw||(kw={}));var qw,Yw,Kw,Jw=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides();return t.layouts.fold((function(){return{type:o,hotspot:e,overrides:r}}),(function(t){return{type:o,hotspot:e,overrides:r,layouts:t}}))},$w=function(t,n,e,o,r,i,u){var a=function(t,n,e,o,r,i,u){var a=function(t,n,e){return(0,t.fetch)(e).map(n)}(t,n,o),c=nS(o,t);return a.map((function(t){return t.bind((function(t){return R.from(Kp.sketch(_(_({},i.menu()),{uid:yi(""),data:t,highlightImmediately:u===kw.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie();Pf.position(o,n,{anchor:e}),ul.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();Pf.position(o,e,{anchor:{type:"submenu",item:n}}),ul.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie();Pf.position(r,n,{anchor:e}),G(o,(function(t){Pf.position(r,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})}))},onEscape:function(){return mp.focus(o),ul.close(r),R.some(!0)}})))}))}))}(t,n,Jw(t,e),e,o,r,u);return a.map((function(t){return t.fold((function(){ul.isOpen(o)&&ul.close(o)}),(function(t){ul.cloak(o),ul.open(o,t),i(o)})),o}))},Qw=function(t,n,e,o,r,i,u){return ul.close(o),Bw(o)},Zw=function(t,n,e,o,r,i){var u=Uw.getCoupled(e,"sandbox");return(ul.isOpen(u)?Qw:$w)(t,n,e,u,o,r,i)},tS=function(t,n,e){var o=Rd.getCurrent(n).getOr(n),r=Lu(t.element);e?au(o.element,"min-width",r+"px"):function(t,n){Nu.set(t,n)}(o.element,r)},nS=function(t,n){return t.getSystem().getByUid(n.uid+"-"+Gw()).map((function(t){return function(){return mt.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return mt.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},eS=function(t){ul.getState(t).each((function(t){Kp.repositionMenus(t)}))},oS=function(t,n,e){var o=da(),r=nS(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Al(t.sandboxBehaviours,[_l.config({store:{mode:"memory",initialValue:n}}),ul.config({onOpen:function(r,i){var u=Jw(t,n);o.link(n.element),t.matchWidth&&tS(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return ga(e,o)||ga(n,o)},getAttachPoint:function(){return r().getOrDie()}}),Rd.config({find:function(t){return ul.getState(t).bind((function(t){return Rd.getCurrent(t)}))}}),Tc.config({channels:_(_({},ll({isExtraPart:k})),ml({doReposition:eS}))})])}},rS=function(t){var n=Uw.getCoupled(t,"sandbox");eS(n)},iS=function(){return[Yn("sandboxClasses",[]),Bl("sandboxBehaviours",[Rd,Tc,ul,_l])]},uS=v([Mn("dom"),Mn("fetch"),Ea("onOpen"),Da("onExecute"),Yn("getHotspot",R.some),Yn("getAnchorOverrides",v({})),Cs(),Tl("dropdownBehaviours",[Op,Uw,np,mp]),Mn("toggleClass"),Yn("eventOrder",{}),Ln("lazySink"),Yn("matchWidth",!1),Yn("useMinWidth",!1),Ln("role")].concat(iS())),aS=v([od({schema:[Oa()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Xw()]),cS=Ad({name:"Dropdown",configFields:uS(),partFields:aS(),factory:function(t,n,e,o){var r,i,u=function(t){ul.getState(t).each((function(t){Kp.highlightPrimary(t)}))},a={expand:function(n){Op.isOn(n)||Zw(t,b,n,o,p,kw.HighlightNone).get(p)},open:function(n){Op.isOn(n)||Zw(t,b,n,o,p,kw.HighlightFirst).get(p)},isOpen:Op.isOn,close:function(n){Op.isOn(n)&&Zw(t,b,n,o,p,kw.HighlightFirst).get(p)},repositionMenus:function(t){Op.isOn(t)&&rS(t)}},c=function(t,n){return tr(t),R.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.dropdownBehaviours,[Op.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),Uw.config({others:{sandbox:function(n){return oS(t,n,{onOpen:function(){return Op.on(n)},onClose:function(){return Op.off(n)}})}}}),np.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t,n){if(cS.isOpen(t)){var e=Uw.getCoupled(t,"sandbox");u(e)}else cS.open(t);return R.some(!0)},onEscape:function(t,n){return cS.isOpen(t)?(cS.close(t),R.some(!0)):R.none()}}),mp.config({})]),events:Tp(R.some((function(n){Zw(t,b,n,o,u,kw.HighlightFirst).get(p)}))),eventOrder:_(_({},t.eventOrder),(r={},r[Ao()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:a,domModification:{attributes:_(_({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:(i="type",Ht(t.dom,"attributes").bind((function(t){return Ht(t,i)}))).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),sS=Object.freeze({__proto__:null,events:function(){return rr([ir(Co(),C)])},exhibit:function(){return Ai({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),fS=kc({fields:[],name:"unselecting",active:sS}),lS=di("color-input-change"),dS=di("color-swatch-change"),mS=di("color-picker-cancel"),gS=function(t,n,e){var o=$x.parts.field({factory:xw,inputClasses:["tox-textfield"],onSetValue:function(t){return Nw.run(t).get(p)},inputBehaviours:wc([Kd.config({disabled:n.providers.isDisabled}),Xb(),tw.config({}),Nw.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Br(t.element)},notify:{onValid:function(t){var n=_l.getValue(t);Zo(t,lS,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=_l.getValue(t);if(0===n.length)return Bw(mt.value(!0));var e=ie.fromTag("span");au(e,"background-color",n);var o=du(e,"background-color").fold((function(){return mt.error("blah")}),(function(t){return mt.value(n)}));return Bw(o)}}})]),selectOnFocus:!1}),r=t.label.map((function(t){return iw(t,n.providers)})),i=function(t,n){Zo(t,dS,{value:n})},u=bh(function(t,n){return cS.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:wc([Yb(n.providers.isDisabled),Xb(),fS.config({}),tw.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return Dw((function(n){return t.fetch(n)})).map((function(o){return R.from(Bx(jt(fx(di("menu-value"),o,(function(n){t.onItemAction(e,n)}),t.columns,t.presets,hv.CLOSE_ON_EXECUTE,k,n.providers),{movement:dx(t.columns,t.presets)})))}))},parts:{menu:Iv(0,0,t.presets)}})}({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[ec,nc,uc]},onLtr:function(){return[nc,ec,uc]}},components:[],fetch:ix(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){u.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return Qo(t,mS)}),(function(n){i(t,n),tx(n)}))}),"#ffffff"):i(t,"remove"===n?"":n)}))}},n));return $x.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,u.asSpec()]}]),fieldBehaviours:wc([cp("form-field-events",[ar(lS,(function(n,e){u.getOpt(n).each((function(t){au(t.element,"background-color",e.event.color)})),Zo(n,uw,{name:t.name})})),ar(dS,(function(t,n){$x.getField(t).each((function(e){_l.setValue(e,n.event.value),Rd.getCurrent(t).each(mp.focus)}))})),ar(mS,(function(t,n){$x.getField(t).each((function(n){Rd.getCurrent(t).each(mp.focus)}))}))])])})},pS=rd({schema:[Mn("dom")],name:"label"}),hS=function(t){return rd({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:rr([cr(ro(),(function(n,e,o){return t(n,o)}),[n]),cr(co(),(function(n,e,o){return t(n,o)}),[n]),cr(so(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},vS=hS("top-left"),bS=hS("top"),yS=hS("top-right"),xS=hS("right"),wS=hS("bottom-right"),SS=hS("bottom"),kS=hS("bottom-left"),CS=hS("left"),OS=ed({name:"thumb",defaults:v({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:rr([fr(ro(),t,"spectrum"),fr(io(),t,"spectrum"),fr(uo(),t,"spectrum"),fr(co(),t,"spectrum"),fr(so(),t,"spectrum"),fr(lo(),t,"spectrum")])}}}),_S=ed({schema:[Bn("mouseIsDown",(function(){return oe(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))};return{behaviours:wc([np.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),mp.config({})]),events:rr([ar(ro(),e),ar(io(),e),ar(co(),e),ar(so(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}}),TS=[pS,CS,xS,bS,SS,vS,yS,kS,wS,OS,_S],ES=v("slider.change.value"),DS=function(t){var n=t.event.raw;if(function(t){return-1!==t.type.indexOf("touch")}(n)){var e=n;return void 0!==e.touches&&1===e.touches.length?R.some(e.touches[0]).map((function(t){return Vu(t.clientX,t.clientY)})):R.none()}var o=n;return void 0!==o.clientX?R.some(o).map((function(t){return Vu(t.clientX,t.clientY)})):R.none()},BS=function(t){return t.model.minX},AS=function(t){return t.model.minY},MS=function(t){return t.model.minX-1},FS=function(t){return t.model.minY-1},IS=function(t){return t.model.maxX},RS=function(t){return t.model.maxY},VS=function(t){return t.model.maxX+1},PS=function(t){return t.model.maxY+1},HS=function(t,n,e){return n(t)-e(t)},zS=function(t){return HS(t,IS,BS)},NS=function(t){return HS(t,RS,AS)},LS=function(t){return zS(t)/2},jS=function(t){return NS(t)/2},WS=function(t){return t.stepSize},US=function(t){return t.snapToGrid},GS=function(t){return t.snapStart},XS=function(t){return t.rounded},qS=function(t,n){return void 0!==t[n+"-edge"]},YS=function(t){return qS(t,"left")},KS=function(t){return qS(t,"right")},JS=function(t){return qS(t,"top")},$S=function(t){return qS(t,"bottom")},QS=function(t){return t.model.value.get()},ZS=function(t){return{x:t}},tk=function(t){return{y:t}},nk=function(t,n){return{x:t,y:n}},ek=function(t,n){Zo(t,ES(),{value:n})},ok=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},rk=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},ik=function(t,n,e){return Math.max(n,Math.min(e,t))},uk=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var h=function(t,n,e){return Math.min(e,Math.max(t,n))-n}(r,l,d),v=ik(h/m*o+n,g,p);return u&&v>=n&&v<=e?function(t,n,e,o,r){return r.fold((function(){var r=t-n,i=Math.round(r/o)*o;return ik(n+i,n-1,e+1)}),(function(n){var r=(t-n)%o,i=Math.round(r/o),u=Math.floor((t-n)/o),a=Math.floor((e-n)/o),c=n+Math.min(a,u+i)*o;return Math.max(n,c)}))}(v,n,e,i,a):c?Math.round(v):v},ak=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return r<n?i?0:s:r>e?u?a:f:(r-n)/o*c},ck="top",sk="right",fk="bottom",lk="left",dk=function(t){return t.element.dom.getBoundingClientRect()},mk=function(t,n){return t[n]},gk=function(t){var n=dk(t);return mk(n,lk)},pk=function(t){var n=dk(t);return mk(n,sk)},hk=function(t){var n=dk(t);return mk(n,ck)},vk=function(t){var n=dk(t);return mk(n,fk)},bk=function(t){var n=dk(t);return mk(n,"width")},yk=function(t){var n=dk(t);return mk(n,"height")},xk=function(t,n,e){return(t+n)/2-e},wk=function(t,n){var e=dk(t),o=dk(n),r=mk(e,lk),i=mk(e,sk),u=mk(o,lk);return xk(r,i,u)},Sk=function(t,n){var e=dk(t),o=dk(n),r=mk(e,ck),i=mk(e,fk),u=mk(o,ck);return xk(r,i,u)},kk=function(t,n){Zo(t,ES(),{value:n})},Ck=function(t){return{x:t}},Ok=function(t,n,e){var o={min:BS(n),max:IS(n),range:zS(n),value:e,step:WS(n),snap:US(n),snapStart:GS(n),rounded:XS(n),hasMinEdge:YS(n),hasMaxEdge:KS(n),minBound:gk(t),maxBound:pk(t),screenRange:bk(t)};return uk(o)},_k=function(t){return function(n,e){return function(t,n,e){var o=(t>0?rk:ok)(QS(e).x,BS(e),IS(e),WS(e));return kk(n,Ck(o)),R.some(o)}(t,n,e).map(C)}},Tk=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=bk(t),u=o.bind((function(n){return R.some(wk(n,t))})).getOr(0),a=r.bind((function(n){return R.some(wk(n,t))})).getOr(i),c={min:BS(n),max:IS(n),range:zS(n),value:e,hasMinEdge:YS(n),hasMaxEdge:KS(n),minBound:gk(t),minOffset:0,maxBound:pk(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return ak(c)}(n,i,e,o,r);return gk(n)-gk(t)+u},Ek=_k(-1),Dk=_k(1),Bk=R.none,Ak=R.none,Mk={"top-left":R.none(),top:R.none(),"top-right":R.none(),right:R.some((function(t,n){ek(t,ZS(VS(n)))})),"bottom-right":R.none(),bottom:R.none(),"bottom-left":R.none(),left:R.some((function(t,n){ek(t,ZS(MS(n)))}))},Fk=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Ok(t,n,e),r=Ck(o);return kk(t,r),o},setToMin:function(t,n){var e=BS(n);kk(t,Ck(e))},setToMax:function(t,n){var e=IS(n);kk(t,Ck(e))},findValueOfOffset:Ok,getValueFromEvent:function(t){return DS(t).map((function(t){return t.left}))},findPositionOfValue:Tk,setPositionFromValue:function(t,n,e,o){var r=QS(e),i=Tk(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Lu(n.element)/2;au(n.element,"left",i-u+"px")},onLeft:Ek,onRight:Dk,onUp:Bk,onDown:Ak,edgeActions:Mk}),Ik=function(t,n){Zo(t,ES(),{value:n})},Rk=function(t){return{y:t}},Vk=function(t,n,e){var o={min:AS(n),max:RS(n),range:NS(n),value:e,step:WS(n),snap:US(n),snapStart:GS(n),rounded:XS(n),hasMinEdge:JS(n),hasMaxEdge:$S(n),minBound:hk(t),maxBound:vk(t),screenRange:yk(t)};return uk(o)},Pk=function(t){return function(n,e){return function(t,n,e){var o=(t>0?rk:ok)(QS(e).y,AS(e),RS(e),WS(e));return Ik(n,Rk(o)),R.some(o)}(t,n,e).map(C)}},Hk=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=yk(t),u=o.bind((function(n){return R.some(Sk(n,t))})).getOr(0),a=r.bind((function(n){return R.some(Sk(n,t))})).getOr(i),c={min:AS(n),max:RS(n),range:NS(n),value:e,hasMinEdge:JS(n),hasMaxEdge:$S(n),minBound:hk(t),minOffset:0,maxBound:vk(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return ak(c)}(n,i,e,o,r);return hk(n)-hk(t)+u},zk=R.none,Nk=R.none,Lk=Pk(-1),jk=Pk(1),Wk={"top-left":R.none(),top:R.some((function(t,n){ek(t,tk(FS(n)))})),"top-right":R.none(),right:R.none(),"bottom-right":R.none(),bottom:R.some((function(t,n){ek(t,tk(PS(n)))})),"bottom-left":R.none(),left:R.none()},Uk=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Vk(t,n,e),r=Rk(o);return Ik(t,r),o},setToMin:function(t,n){var e=AS(n);Ik(t,Rk(e))},setToMax:function(t,n){var e=RS(n);Ik(t,Rk(e))},findValueOfOffset:Vk,getValueFromEvent:function(t){return DS(t).map((function(t){return t.top}))},findPositionOfValue:Hk,setPositionFromValue:function(t,n,e,o){var r=QS(e),i=Hk(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=Fu(n.element)/2;au(n.element,"top",i-u+"px")},onLeft:zk,onRight:Nk,onUp:Lk,onDown:jk,edgeActions:Wk}),Gk=function(t,n){Zo(t,ES(),{value:n})},Xk=function(t,n){return{x:t,y:n}},qk=function(t,n){return function(e,o){return function(t,n,e,o){var r=t>0?rk:ok,i=n?QS(o).x:r(QS(o).x,BS(o),IS(o),WS(o)),u=n?r(QS(o).y,AS(o),RS(o),WS(o)):QS(o).y;return Gk(e,Xk(i,u)),R.some(i)}(t,n,e,o).map(C)}},Yk=qk(-1,!1),Kk=qk(1,!1),Jk=qk(-1,!0),$k=qk(1,!0),Qk={"top-left":R.some((function(t,n){ek(t,nk(MS(n),FS(n)))})),top:R.some((function(t,n){ek(t,nk(LS(n),FS(n)))})),"top-right":R.some((function(t,n){ek(t,nk(VS(n),FS(n)))})),right:R.some((function(t,n){ek(t,nk(VS(n),jS(n)))})),"bottom-right":R.some((function(t,n){ek(t,nk(VS(n),PS(n)))})),bottom:R.some((function(t,n){ek(t,nk(LS(n),PS(n)))})),"bottom-left":R.some((function(t,n){ek(t,nk(MS(n),PS(n)))})),left:R.some((function(t,n){ek(t,nk(MS(n),jS(n)))}))},Zk=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Ok(t,n,e.left),r=Vk(t,n,e.top),i=Xk(o,r);return Gk(t,i),i},setToMin:function(t,n){var e=BS(n),o=AS(n);Gk(t,Xk(e,o))},setToMax:function(t,n){var e=IS(n),o=RS(n);Gk(t,Xk(e,o))},getValueFromEvent:function(t){return DS(t)},setPositionFromValue:function(t,n,e,o){var r=QS(e),i=Tk(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Hk(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=Lu(n.element)/2,c=Fu(n.element)/2;au(n.element,"left",i-a+"px"),au(n.element,"top",u-c+"px")},onLeft:Yk,onRight:Kk,onUp:Jk,onDown:$k,edgeActions:Qk}),tC=Ad({name:"Slider",configFields:[Yn("stepSize",1),Yn("onChange",p),Yn("onChoose",p),Yn("onInit",p),Yn("onDragStart",p),Yn("onDragEnd",p),Yn("snapToGrid",!1),Yn("rounded",!0),Ln("snapStart"),Fn("model",En("mode",{x:[Yn("minX",0),Yn("maxX",100),Bn("value",(function(t){return oe(t.mode.minX)})),Mn("getInitialValue"),Ma("manager",Fk)],y:[Yn("minY",0),Yn("maxY",100),Bn("value",(function(t){return oe(t.mode.minY)})),Mn("getInitialValue"),Ma("manager",Uk)],xy:[Yn("minX",0),Yn("maxX",100),Yn("minY",0),Yn("maxY",100),Bn("value",(function(t){return oe({x:t.mode.minX,y:t.mode.minY})})),Mn("getInitialValue"),Ma("manager",Zk)]})),Tl("sliderBehaviours",[np,_l]),Bn("mouseIsDown",(function(){return oe(!1)}))],partFields:TS,factory:function(t,n,e,o){var r,i=function(n){return vd(n,t,"thumb")},u=function(n){return vd(n,t,"spectrum")},a=function(n){return hd(n,t,"left-edge")},c=function(n){return hd(n,t,"right-edge")},s=function(n){return hd(n,t,"top-edge")},f=function(n){return hd(n,t,"bottom-edge")},l=t.model,d=l.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(t,n){l.value.set(n);var e=i(t);m(t,e)},p=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&hd(n,t,"thumb").each((function(e){var o=l.value.get();t.onChoose(n,e,o)}))},h=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},v=function(n,e){e.stop(),t.onDragEnd(n,i(n)),p(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.sliderBehaviours,[np.config({mode:"special",focusIn:function(n){return hd(n,t,"spectrum").map(np.focusIn).map(C)}}),_l.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),Tc.config({channels:(r={},r[sl()]={onReceive:p},r)})]),events:rr([ar(ES(),(function(n,e){!function(n,e){g(n,e);var o=i(n);t.onChange(n,o,e),R.some(!0)}(n,e.event.value)})),pr((function(n,e){var o=l.getInitialValue();l.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,l.value.get())})),ar(ro(),h),ar(uo(),v),ar(co(),h),ar(lo(),v)]),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),nC=di("rgb-hex-update"),eC=di("slider-update"),oC=di("palette-update"),rC="form",iC=[Tl("formBehaviours",[_l])],uC=function(t){return"<alloy.field."+t+">"},aC=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.formBehaviours,[_l.config({store:{mode:"manual",getValue:function(n){var e=yd(n,t);return Mt(e,(function(t,n){return t().bind((function(t){var e,o,r=Rd.getCurrent(t);return e=r,o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+ci(t.element)),e.fold((function(){return mt.error(o)}),mt.value)})).map(_l.getValue)}))},setValue:function(n,e){At(e,(function(e,o){hd(n,t,o).each((function(t){Rd.getCurrent(t).each((function(t){_l.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return hd(n,t,e).bind(Rd.getCurrent)}}}},cC={getField:Ti((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n=function(){var t=[];return{field:function(n,e){return t.push(n),ld(rC,uC(n),e)},record:v(t)}}(),e=t(n),o=n.record(),r=U(o,(function(t){return ed({name:t,pname:uC(t)})}));return _d(rC,iC,r,aC,e)}},sC=di("valid-input"),fC=di("invalid-input"),lC=di("validating-input"),dC="colorcustom.rgb.",mC=function(t,n,e,o){var r=function(e,o){return Nw.config({invalidClass:n("invalid"),notify:{onValidate:function(t){Zo(t,lC,{type:e})},onValid:function(t){Zo(t,sC,{type:e,value:_l.getValue(t)})},onInvalid:function(t){Zo(t,fC,{type:e,value:_l.getValue(t)})}},validator:{validate:function(n){var e=_l.getValue(n),r=o(e)?mt.value(!0):mt.error(t("aria.input.invalid"));return Bw(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=t("colorcustom.rgb.range"),s=$x.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),f=$x.parts.field({data:a,factory:xw,inputAttributes:_({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:wc([r(o,e),tw.config({})]),onSetValue:function(t){Nw.isInvalid(t)&&Nw.run(t).get(p)}}),l=[s,f],d="hex"!==o?[$x.parts["aria-descriptor"]({text:c})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:l.concat(d)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue;_l.setValue(t,{red:e,green:o,blue:r})},a=bh({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){au(t.element,"background-color","#"+n.value)}))},s=Bd({factory:function(){var r={red:oe(R.some(255)),green:oe(R.some(255)),blue:oe(R.some(255)),hex:oe(R.some("ffffff"))},s=function(t){return r[t].get()},f=function(t,n){r[t].set(n)},l=function(t){var n=t.red,e=t.green,o=t.blue;f("red",R.some(n)),f("green",R.some(e)),f("blue",R.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?f(e.type,R.none()):o(t)},m=function(t,n,e){var o=parseInt(e,10);f(n,R.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return Fy(t,n,e,1)}))}))})).each((function(n){var e=function(t,n){var e=Ty(n);return cC.getField(t,"hex").each((function(n){mp.isFocused(n)||_l.setValue(t,{hex:e.value})})),e}(t,n);Zo(t,nC,{hex:e}),c(t,e)}))},g=function(t,n){var o=n.event;!function(t){return"hex"===t.type}(o)?m(t,o.type,o.value):function(t,n){e(t);var o=xy(n);f("hex",R.some(n));var r=Vy(o);u(t,r),l(r),Zo(t,nC,{hex:o}),c(t,o)}(t,o.value)},p=function(n){return{label:t(dC+n+".label"),description:t(dC+n+".description")}},h=p("red"),v=p("green"),b=p("blue"),y=p("hex");return jt(cC.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",$x.sketch(i(Iy,"red",h.label,h.description,255))),e.field("green",$x.sketch(i(Iy,"green",v.label,v.description,255))),e.field("blue",$x.sketch(i(Iy,"blue",b.label,b.description,255))),e.field("hex",$x.sketch(i(ky,"hex",y.label,y.description,"ffffff"))),a.asSpec()],formBehaviours:wc([Nw.config({invalidClass:n("form-invalid")}),cp("rgb-form-events",[ar(sC,g),ar(fC,d),ar(lC,d)])])}})),{apis:{updateHex:function(t,n){_l.setValue(t,{hex:n.value}),function(t,n){var e=Vy(n);u(t,e),l(e)}(t,n),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}});return s},gC=function(t,n){var e=tC.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=tC.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}},i=Bd({factory:function(t){var i=v({x:0,y:0}),u=wc([Rd.config({find:R.some}),mp.config({})]);return tC.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:function(t,n,e){Zo(t,oC,{value:e})},onInit:function(t,n,e,o){r(e.element.dom,zy(Ny))},sliderBehaviours:u})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){!function(t,n){var e=t.components()[0].element.dom,o=jy(n,100,100),i=Ry(o);r(e,zy(i))}(n,e)},setThumb:function(t,n,e){!function(t,n){var e=Wy(Vy(n));tC.setValue(t,{x:e.saturation,y:100-e.value})}(n,e)}},extraApis:{}});return i},pC=function(t,n){var e=Bd({name:"ColourPicker",configFields:[Mn("dom"),Yn("onValidHex",p),Yn("onInvalidHex",p)],factory:function(e){var o,r=mC(t,n,e.onValidHex,e.onInvalidHex),i=gC(0,n),u=function(t){return 100-t/360*100},a={paletteRgba:oe(Ny),paletteHue:oe(0)},c=bh(function(t,n){var e=tC.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=tC.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return tC.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:v({y:0})},components:[e,o],sliderBehaviours:wc([mp.config({})]),onChange:function(t,n,e){Zo(t,eC,{value:e})}})}(0,n)),s=bh(i.sketch({})),f=bh(r.sketch({})),l=function(t,n,e){s.getOpt(t).each((function(t){i.setHue(t,e)}))},d=function(t,n){f.getOpt(t).each((function(t){r.updateHex(t,n)}))},m=function(t,n,e){c.getOpt(t).each((function(t){tC.setValue(t,{y:u(e)})}))},g=function(t,n){s.getOpt(t).each((function(t){i.setThumb(t,n)}))},p=function(t,n,e,o){!function(t,n){var e=Vy(t);a.paletteRgba.set(e),a.paletteHue.set(n)}(n,e),G(o,(function(o){o(t,n,e)}))};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),f.asSpec()],behaviours:wc([cp("colour-picker-events",[ar(nC,(o=[l,m,g],function(t,n){var e=n.event.hex,r=function(t){return Wy(Vy(t))}(e);p(t,e,r.hue,o)})),ar(oC,function(){var t=[d];return function(n,e){var o=e.event.value,r=a.paletteHue.get(),i=jy(r,o.x,100-o.y),u=Uy(i);p(n,u,r,t)}}()),ar(eC,function(){var t=[l,d];return function(n,e){var o=function(t){return(100-t)/100*360}(e.event.value.y),r=a.paletteRgba.get(),i=Wy(r),u=jy(o,i.saturation,i.value),c=Uy(u);p(n,c,o,t)}}())]),Rd.config({find:function(t){return f.getOpt(t)}}),np.config({mode:"acyclic"})])}}});return e},hC=function(){return Rd.config({find:R.some})},vC=function(t){return Rd.config({find:t.getOpt})},bC=function(t){return Rd.config({find:function(n){return Fr(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},yC={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},xC=function(t){return function(t){return yC[t]}(t)},wC=tinymce.util.Tools.resolve("tinymce.Resource"),SC=tinymce.util.Tools.resolve("tinymce.util.Tools"),kC=an([Yn("preprocess",b),Yn("postprocess",b)]),CC=function(t,n,e){return _l.config(jt({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},OC=function(t,n,e){return CC(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))},_C=function(t,n){var e=_n("RepresentingConfigs.memento processors",kC,n);return _l.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=_l.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);_l.setValue(i,r)}}})},TC=CC,EC=function(t){return OC(t,Qr,Zr)},DC=function(t){return _l.config({store:{mode:"memory",initialValue:t}})},BC=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){G(t,(function(t){t(n,e)}))}},r=function(t,n){if(!Kd.isDisabled(t)){var e=n.event.raw;u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){_l.setValue(e,function(t,n){var e=SC.explode(n.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"));return q(st(t),(function(t){return L(e,(function(n){return me(t.name.toLowerCase(),"."+n.toLowerCase())}))}))}(o,n)),Zo(e,uw,{name:t.name})},a=bh({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:wc([cp("input-file-events",[dr(xo()),dr(Fo())])])}),c=t.label.map((function(t){return iw(t,n)})),s=$x.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:wc([DC([]),hC(),Kd.config({}),Op.config({toggleClass:"dragenter",toggleOnExecute:!1}),cp("dropzone-events",[ar("dragenter",o([e,Op.toggle])),ar("dragleave",o([e,Op.toggle])),ar("dragover",e),ar("drop",o([e,r])),ar(yo(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},vh.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:wc([tw.config({}),Yb(n.isDisabled),Xb()])})]}]}}}});return ew(c,s,["tox-form__group--stretched"],[])},AC=di("alloy-fake-before-tabstop"),MC=di("alloy-fake-after-tabstop"),FC=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:wc([mp.config({ignore:!0}),tw.config({})])}},IC=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[FC([AC]),t,FC([MC])],behaviours:wc([bC(1)])}},RC=function(t,n){Zo(t,ho(),{raw:{which:9,shiftKey:n}})},VC=function(t,n){var e=n.element;Yi(e,AC)?RC(t,!0):Yi(e,MC)&&RC(t,!1)},PC=function(t){return Mx(t,["."+AC,"."+MC].join(","),k)},HC=!(ze().browser.isIE()||ze().browser.isEdge()),zC=function(t,n){var e=HC&&t.sandboxed,o=_(_({},t.label.map((function(t){return{title:t}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(t){var n=oe("");return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)ni(e.element,"srcdoc",o);else{ni(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}n.set(o)}}}(e),i=t.label.map((function(t){return iw(t,n)})),u=$x.parts.field({factory:{sketch:function(t){return IC({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:wc([tw.config({}),mp.config({}),TC(R.none(),r.getValue,r.setValue)])})}}});return ew(i,u,["tox-form__group--stretched"],[])},NC=function(t,n){return WC(document.createElement("canvas"),t,n)},LC=function(t){var n=NC(t.width,t.height);return jC(n).drawImage(t,0,0),n},jC=function(t){return t.getContext("2d")},WC=function(t,n,e){return t.width=n,t.height=e,t},UC=function(t){return t.naturalWidth||t.width},GC=function(t){return t.naturalHeight||t.height},XC=window.Promise?window.Promise:function(){var t=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(t,o(u,this),o(a,this))},n=window,e=t.immediateFn||"function"==typeof n.setImmediate&&n.setImmediate||function(t){return setTimeout(t,1)},o=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.apply(n,e)}},r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t){var n=this;null!==this._state?e((function(){var e=n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(n){return void t.reject(n)}t.resolve(o)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function u(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void f(o(n,t),o(u,this),o(a,this))}this._state=!0,this._value=t,c.call(this)}catch(t){a.call(this,t)}}function a(t){this._state=!1,this._value=t,c.call(this)}function c(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];i.call(this,e)}this._deferreds=[]}function s(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}var f=function(t,n,e){var o=!1;try{t((function(t){o||(o=!0,n(t))}),(function(t){o||(o=!0,e(t))}))}catch(t){if(o)return;o=!0,e(t)}};return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.then=function(n,e){var o=this;return new t((function(t,r){i.call(o,new s(n,e,t,r))}))},t.all=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var o=Array.prototype.slice.call(1===n.length&&r(n[0])?n[0]:n);return new t((function(t,n){if(0===o.length)return t([]);for(var e=o.length,r=function(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),n)}o[i]=u,0==--e&&t(o)}catch(t){n(t)}},i=0;i<o.length;i++)r(i,o[i])}))},t.resolve=function(n){return n&&"object"==typeof n&&n.constructor===t?n:new t((function(t){t(n)}))},t.reject=function(n){return new t((function(t,e){e(n)}))},t.race=function(n){return new t((function(t,e){for(var o=0,r=n;o<r.length;o++){r[o].then(t,e)}}))},t}(),qC=function(t){return new XC((function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return R.none();for(var o=e[1],r=n[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=new Uint8Array(m)}return R.some(new Blob(s,{type:o}))})(t).fold((function(){e("uri is not base64: "+t)}),n)}))},YC=function(t,n,e){return n=n||"image/png",d(HTMLCanvasElement.prototype.toBlob)?new XC((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):qC(t.toDataURL(n,e))},KC=function(t){return function(t){return new XC((function(n,e){var o=URL.createObjectURL(t),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),n(r)},a=function(){i(),e("Unable to load data of type "+t.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))}(t).then((function(t){JC(t);var n=NC(UC(t),GC(t));return jC(n).drawImage(t,0,0),n}))},JC=function(t){URL.revokeObjectURL(t.src)},$C=function(t,n,e){var o=n.type,r=v(o),i=v(e),u=function(n,e){return t.then((function(t){return function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)}(t,n,e)}))};return{getType:r,toBlob:function(){return XC.resolve(n)},toDataURL:i,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return YC(t,n,e)}))},toAdjustedDataURL:u,toAdjustedBase64:function(t,n){return u(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(LC)}}},QC=function(t){return function(t){return new XC((function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}))}(t).then((function(n){return $C(KC(t),t,n)}))},ZC=function(t,n){return YC(t,n).then((function(n){return $C(XC.resolve(t),n,t.toDataURL())}))},tO=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return o>e?o=e:o<n&&(o=n),o},nO=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],eO=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},oO=function(t,n){return t.toCanvas().then((function(e){return rO(e,t.getType(),n)}))},rO=function(t,n,e){var o=jC(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),ZC(t,n)},iO=function(t,n,e){var o=jC(t),r=o.getImageData(0,0,t.width,t.height),i=o.getImageData(0,0,t.width,t.height);return i=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=4*(o(f+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(f*c+l);a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return n}(r,i,e),o.putImageData(i,0,0),ZC(t,n)},uO=function(t){return function(n,e){return oO(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}},aO=function(t){return function(n){return oO(n,t)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),cO=uO((function(t,n){return n=tO(255*n,-255,255),eO(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),sO=uO((function(t,n){var e;return n=tO(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0===(e=n%1)?nO[n]:nO[Math.floor(n)]*(1-e)+nO[Math.floor(n)+1]*e)+127,eO(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),fO=function(t,n,e,o){return oO(t,function(t,n,e,o){return n=tO(n,0,2),e=tO(e,0,2),o=tO(o,0,2),eO(t,[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],n,e,o))},lO=(qw=[0,-1,0,-1,5,-1,0,-1,0],function(t){return function(t,n){return t.toCanvas().then((function(e){return iO(e,t.getType(),n)}))}(t,qw)}),dO=(Yw=function(t,n){return 255*Math.pow(t/255,1-n)},function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){for(var o=jC(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Yw(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),ZC(t,n)}(e,t.getType(),n)}))}),mO=function(t,n,e){var o=UC(t),r=GC(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=gO(t,i,u);return a?c.then((function(t){return mO(t,n,e)})):c},gO=function(t,n,e){return new XC((function(o){var r=UC(t),i=GC(t),u=Math.floor(r*n),a=Math.floor(i*e),c=NC(u,a);jC(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},pO=function(t,n){void 0===n&&(n=2);var e=Math.pow(10,n),o=Math.round(t*e);return Math.ceil(o/e)},hO=function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=pO(Math.abs(r*a)+Math.abs(i*u)),s=pO(Math.abs(r*u)+Math.abs(i*a)),f=NC(c,s),l=jC(f);return l.translate(c/2,s/2),l.rotate(o),l.drawImage(t,-r/2,-i/2),ZC(f,n)},vO=function(t,n,e){var o=NC(t.width,t.height),r=jC(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),ZC(o,n)},bO=function(t,n,e,o,r,i){var u=NC(r,i);return jC(u).drawImage(t,-e,-o),ZC(u,n)},yO=function(t){return aO(t)},xO=function(t){return lO(t)},wO=function(t,n){return dO(t,n)},SO=function(t,n){return cO(t,n)},kO=function(t,n){return sO(t,n)},CO=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return vO(e,t.getType(),n)}))}(t,n)},OO=function(t,n,e,o,r){return function(t,n,e,o,r){return t.toCanvas().then((function(i){return bO(i,t.getType(),n,e,o,r)}))}(t,n,e,o,r)},_O=function(t,n,e){return function(t,n,e){return t.toCanvas().then((function(o){return mO(o,n,e).then((function(n){return ZC(n,t.getType())}))}))}(t,n,e)},TO=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return hO(e,t.getType(),n)}))}(t,n)},EO=function(t,n,e){return Eh(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)},DO=function(t,n){return EO(t,n,[])},BO=function(t,n){return EO(t,n,[ap.config({})])},AO=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:wc([ap.config({})])}},MO=di("toolbar.button.execute"),FO=((Kw={})[Ao()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Kw),IO=di("update-menu-text"),RO=di("update-menu-icon"),VO=function(t,n,e){var o=oe(p),r=t.text.map((function(t){return bh(AO(t,n,e.providers))})),i=t.icon.map((function(t){return bh(BO(t,e.providers.icons))})),u=function(t,n){var e=_l.getValue(t);return mp.focus(e),Zo(e,"keydown",{raw:n.event.raw}),cS.close(e),R.some(!0)},a=t.role.fold((function(){return{}}),(function(t){return{role:t}})),c=t.tooltip.fold((function(){return{}}),(function(t){var n=e.providers.translate(t);return{title:n,"aria-label":n}})),s=Eh("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},e.providers.icons);return bh(cS.sketch(_(_(_({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(U(t.classes,(function(t){return n+"--"+t}))),attributes:_({},c)},components:ey([i.map((function(t){return t.asSpec()})),r.map((function(t){return t.asSpec()})),R.some(s)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:wc(E(E([],t.dropdownBehaviours),[Yb((function(){return t.disabled||e.providers.isDisabled()})),Xb(),fS.config({}),ap.config({}),cp("dropdown-events",[Qb(t,o),Zb(t,o)]),cp("menubutton-update-display-text",[ar(IO,(function(t,n){r.bind((function(n){return n.getOpt(t)})).each((function(t){ap.set(t,[_u(e.providers.translate(n.event.text))])}))})),ar(RO,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){ap.set(t,[BO(n.event.icon,e.providers.icons)])}))}))])])),eventOrder:jt(FO,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:wc([np.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:Iv(0,t.columns,t.presets)},fetch:function(n){return Dw(x(t.fetch,n))}}))).asSpec()},PO=function(t){return"separator"===t.type},HO={type:"separator"},zO=function(t,n){var e=K(t,(function(t,e){return function(t){return r(t)}(e)?""===e?t:"|"===e?t.length>0&&!PO(t[t.length-1])?t.concat([HO]):t:zt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return e.length>0&&PO(e[e.length-1])&&e.pop(),e},NO=function(t,n){return function(t){return zt(t,"getSubmenuItems")}(t)?function(t,n){var e=t.getSubmenuItems(),o=LO(e,n);return{item:t,menus:jt(o.menus,qe(t.value,o.items)),expansions:jt(o.expansions,qe(t.value,t.value))}}(t,n):{item:t,menus:{},expansions:{}}},LO=function(t,n){var e=zO(r(t)?t.split(" "):t,n);return Y(e,(function(t,e){var o=function(t){if(PO(t))return t;var n=Ht(t,"value").getOrThunk((function(){return di("generated-menu-item")}));return jt({value:n},t)}(e),r=NO(o,n);return{menus:jt(t.menus,r.menus),items:[r.item].concat(t.items),expansions:jt(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},jO=function(t,n,e,o){var r=di("primary-menu"),i=LO(t,e.shared.providers.menuItems());if(0===i.items.length)return R.none();var u=Dx(r,i.items,n,e,o),a=Mt(i.menus,(function(t,o){return Dx(o,t,n,e,!1)})),c=jt(a,qe(r,u));return R.from(Kp.tieredData(r,c,i.expansions))},WO=function(t){return{isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)},setActive:function(n){var e=t.element;n?(Gi(e,"tox-tbtn--enabled"),ni(e,"aria-pressed",!0)):(qi(e,"tox-tbtn--enabled"),ii(e,"aria-pressed"))},isActive:function(){return Yi(t.element,"tox-tbtn--enabled")}}},UO=function(t,n,e,o){return VO({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(jO(t,hv.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:WO,columns:1,presets:"normal",classes:[],dropdownBehaviours:[tw.config({})]},n,e.shared)},GO=function(t,n,e){var o=function(t){return function(o){var r=!o.isActive();o.setActive(r),t.storage.set(r),e.shared.getSink().each((function(e){n().getOpt(e).each((function(n){Dc(n.element),Zo(n,sw,{name:t.name,value:t.storage.get()})}))}))}},r=function(t){return function(n){n.setActive(t.storage.get())}};return function(n){n(U(t,(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return _(_({type:t.type,active:!1},n),{onAction:o(t),onSetup:r(t)})})))}},XO=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=_({buttonBehaviours:wc([Yb((function(){return t.disabled||i.isDisabled()})),Xb(),tw.config({}),cp("button press",[ur("click"),ur("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=jt(a,{dom:o});return jt(c,{components:r})},qO=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return DO(t,e.icons)})),u=ey([i]);return XO(t,n,o,r,u,e)},YO=function(t,n,e,o){void 0===o&&(o=[]);var r=qO(t,R.some(n),e,o);return vh.sketch(r)},KO=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return DO(t,e.icons)})):R.none(),a=u.isSome()?ey([u]):[],c=u.isSome()?{}:{innerHtml:i},s=E(E(E(E([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"]),u.isSome()?["tox-button--icon"]:[]),t.borderless?["tox-button--naked"]:[]),r),f=_(_({tag:"button",classes:s},c),{attributes:{title:i}});return XO(t,n,o,f,a,e)},JO=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=KO(t,R.some(n),e,o,r);return vh.sketch(i)},$O=function(t,n){return function(e){"custom"===n?Zo(e,sw,{name:t,value:{}}):"submit"===n?Qo(e,fw):"cancel"===n?Qo(e,cw):console.error("Unknown button type: ",n)}},QO=function(t,n,e){if(function(t,n){return"menu"===n}(0,n)){var o=t,r=_(_({},t),{onSetup:function(n){return n.setDisabled(t.disabled),p},fetch:GO(o.items,(function(){return i}),e)}),i=bh(UO(r,"tox-tbtn",e,R.none()));return i.asSpec()}if(function(t,n){return"custom"===n||"cancel"===n||"submit"===n}(0,n)){var u=$O(t.name,n),a=_(_({},t),{borderless:!1});return JO(a,u,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},ZO=function(t,n){var e,o,r=$O(t.name,"custom");return e=R.none(),o=$x.parts.field(_({factory:vh},KO(t,R.some(r),n,[DC(""),hC()]))),ew(e,o,[],[])},t_=v([Yn("field1Name","field1"),Yn("field2Name","field2"),Ba("onLockedChange"),_a(["lockClass"]),Yn("locked",!1),Bl("coupledFieldBehaviours",[Rd,_l])]),n_=function(t,n){return ed({factory:$x,name:t,overrides:function(t){return{fieldBehaviours:wc([cp("coupled-input-behaviour",[ar(bo(),(function(e){(function(t,n,e){return hd(t,n,e).bind(Rd.getCurrent)})(e,t,n).each((function(n){hd(e,t,"lock").each((function(o){Op.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},e_=v([n_("field1","field2"),n_("field2","field1"),ed({factory:vh,schema:[Mn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:wc([Op.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),o_=Ad({name:"FormCoupledInputs",configFields:t_(),partFields:e_(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Al(t.coupledFieldBehaviours,[Rd.config({find:R.some}),_l.config({store:{mode:"manual",getValue:function(n){var e,o=wd(n,t,["field1","field2"]);return(e={})[t.field1Name]=_l.getValue(o.field1()),e[t.field2Name]=_l.getValue(o.field2()),e},setValue:function(n,e){var o=wd(n,t,["field1","field2"]);Nt(e,t.field1Name)&&_l.setValue(o.field1(),e[t.field1Name]),Nt(e,t.field2Name)&&_l.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return hd(n,t,"field1")},getField2:function(n){return hd(n,t,"field2")},getLock:function(n){return hd(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),r_=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null!==n){var e=parseFloat(n[1]),o=n[2];return mt.value({value:e,unit:o})}return mt.error(t)},i_=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return zt(e,t)};return t.unit===n?R.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?R.some(t.value):R.some(t.value/e[t.unit]*e[n]):R.none()},u_=function(t){return R.none()},a_=function(t,n){var e=r_(t).toOptional(),o=r_(n).toOptional();return Zi(e,o,(function(t,n){return i_(t,n.unit).map((function(t){return n.value/t})).map((function(t){return function(t,n){return function(e){return i_(e,n).map((function(e){return{value:e*t,unit:n}}))}}(t,n.unit)})).getOr(u_)})).getOr(u_)},c_=function(t,n){var e=u_,o=di("ratio-event"),r=function(t){return Eh(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)},i=o_.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:wc([Kd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Xb(),tw.config({})])}),u=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},a=function(e){return $x.parts.field({factory:xw,inputClasses:["tox-textfield"],inputBehaviours:wc([Kd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Xb(),tw.config({}),cp("size-input-events",[ar(go(),(function(t,n){Zo(t,o,{isField1:e})})),ar(yo(),(function(n,e){Zo(n,uw,{name:t.name})}))])]),selectOnFocus:!1})},c=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},s=o_.parts.field1(u([$x.parts.label(c("Width")),a(!0)])),f=o_.parts.field2(u([$x.parts.label(c("Height")),a(!1)]));return o_.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,f,u([c("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){r_(_l.getValue(t)).each((function(t){e(t).each((function(t){_l.setValue(n,function(t){var n,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=t.value.toFixed((n=t.unit)in e?e[n]:1);return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+t.unit}(t))}))}))},coupledFieldBehaviours:wc([Kd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){o_.getField1(t).bind($x.getField).each(Kd.disable),o_.getField2(t).bind($x.getField).each(Kd.disable),o_.getLock(t).each(Kd.disable)},onEnabled:function(t){o_.getField1(t).bind($x.getField).each(Kd.enable),o_.getField2(t).bind($x.getField).each(Kd.enable),o_.getLock(t).each(Kd.enable)}}),Xb(),cp("size-input-events2",[ar(o,(function(t,n){var o=n.event.isField1,r=o?o_.getField1(t):o_.getField2(t),i=o?o_.getField2(t):o_.getField1(t),u=r.map(_l.getValue).getOr(""),a=i.map(_l.getValue).getOr("");e=a_(u,a)}))])])})},s_={undo:v(di("undo")),redo:v(di("redo")),zoom:v(di("zoom")),back:v(di("back")),apply:v(di("apply")),swap:v(di("swap")),transform:v(di("transform")),tempTransform:v(di("temp-transform")),transformApply:v(di("transform-apply"))},f_=v("save-state"),l_=v("disable"),d_=v("enable"),m_={formActionEvent:sw,saveState:f_,disable:l_,enable:d_},g_=function(t,n){var e=function(t,e,o,r){return bh(JO({name:t,text:t,disabled:o,primary:r,icon:R.none(),borderless:!1},e,n))},o=function(t,e,o,r){return bh(YO({name:t,icon:R.some(t),tooltip:R.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Kd)&&Kd.disable(e)}))},i=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Kd)&&Kd.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=p,c=function(t,n,e){Zo(t,n,e)},s=function(t){return Qo(t,m_.disable())},f=function(t){return Qo(t,m_.enable())},l=function(t,n){s(t),c(t,s_.transform(),{transform:n}),f(t)},d=function(t){return function(){tt.getOpt(t).each((function(t){ap.set(t,[Q])}))}},m=function(t,n){s(t),c(t,s_.transformApply(),{transform:n,swap:d(t)}),f(t)},g=function(){return e("Back",(function(t){return c(t,s_.back(),{swap:d(t)})}),!1,!1)},h=function(){return bh({dom:{tag:"div",classes:["tox-spacer"]},behaviours:wc([Kd.config({})])})},b=function(){return e("Apply",(function(t){return c(t,s_.apply(),{swap:d(t)})}),!0,!0)},y=[g(),h(),e("Apply",(function(n){var e=function(n){var e=t.getRect();return OO(n,e.x,e.y,e.w,e.h)};m(n,e),t.hideCrop()}),!1,!0)],x=qx.sketch({dom:u,components:y.map((function(t){return t.asSpec()})),containerBehaviours:wc([cp("image-tools-crop-buttons-events",[ar(m_.disable(),(function(t,n){r(y,t)})),ar(m_.enable(),(function(t,n){i(y,t)}))])])}),w=bh(c_({name:"size",label:R.none(),constrain:!0,disabled:!1},n)),S=[g(),h(),w,h(),e("Apply",(function(t){w.getOpt(t).each((function(n){var e=_l.getValue(n),o=function(t,n){return function(e){return _O(e,t,n)}}(parseInt(e.width,10),parseInt(e.height,10));m(t,o)}))}),!1,!0)],k=qx.sketch({dom:u,components:S.map((function(t){return t.asSpec()})),containerBehaviours:wc([cp("image-tools-resize-buttons-events",[ar(m_.disable(),(function(t,n){r(S,t)})),ar(m_.enable(),(function(t,n){i(S,t)}))])])}),C=function(t,n){return function(e){return t(e,n)}},O=C(CO,"h"),_=C(CO,"v"),T=C(TO,-90),E=C(TO,90),D=function(t,n){!function(t,n){s(t),c(t,s_.tempTransform(),{transform:n}),f(t)}(t,n)},B=[g(),h(),o("flip-horizontally","Flip horizontally",(function(t){D(t,O)}),!1),o("flip-vertically","Flip vertically",(function(t){D(t,_)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){D(t,T)}),!1),o("rotate-right","Rotate clockwise",(function(t){D(t,E)}),!1),h(),b()],A=qx.sketch({dom:u,components:B.map((function(t){return t.asSpec()})),containerBehaviours:wc([cp("image-tools-fliprotate-buttons-events",[ar(m_.disable(),(function(t,n){r(B,t)})),ar(m_.enable(),(function(t,n){i(B,t)}))])])}),M=function(t,e,o,r,i){var u=tC.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=tC.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=tC.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return bh(tC.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:v({x:r})},components:[u,a,c],sliderBehaviours:wc([mp.config({})]),onChoose:e}))},F=function(t,n,e,o,r){return M(t,(function(t,e,o){var r=C(n,o.x/100);l(t,r)}),e,o,r)},I=function(t,n,e,o,a){var c=function(t,n,e,o,r){return[g(),F(t,n,e,o,r),b()]}(t,n,e,o,a);return qx.sketch({dom:u,components:c.map((function(t){return t.asSpec()})),containerBehaviours:wc([cp("image-tools-filter-panel-buttons-events",[ar(m_.disable(),(function(t,n){r(c,t)})),ar(m_.enable(),(function(t,n){i(c,t)}))])])})},V=[g(),h(),b()],P=qx.sketch({dom:u,components:V.map((function(t){return t.asSpec()}))}),H=I("Brightness",SO,-100,0,100),z=I("Contrast",kO,-100,0,100),N=I("Gamma",wO,-100,0,100),L=function(t,n,e){return function(o){return function(t,n,e,o){return fO(t,n,e,o)}(o,t,n,e)}},j=function(t){return M(t,(function(t,n,e){var o=W.getOpt(t),r=G.getOpt(t),i=U.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r=_l.getValue(n).x/100,i=_l.getValue(o).x/100,u=_l.getValue(e).x/100,a=L(r,i,u);l(t,a)}))}))}))}),0,100,200)},W=j("R"),U=j("G"),G=j("B"),X=[g(),W,U,G,b()],q=qx.sketch({dom:u,components:X.map((function(t){return t.asSpec()}))}),Y=function(t,n,e){return function(o){c(o,s_.swap(),{transform:n,swap:function(){tt.getOpt(o).each((function(n){ap.set(n,[t]),e(n)}))}})}},K=R.some(xO),J=R.some(yO),$=[o("crop","Crop",Y(x,R.none(),(function(n){t.showCrop()})),!1),o("resize","Resize",Y(k,R.none(),(function(n){w.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;_l.setValue(n,{width:o,height:r})}))})),!1),o("orientation","Orientation",Y(A,R.none(),a),!1),o("brightness","Brightness",Y(H,R.none(),a),!1),o("sharpen","Sharpen",Y(P,K,a),!1),o("contrast","Contrast",Y(z,R.none(),a),!1),o("color-levels","Color levels",Y(q,R.none(),a),!1),o("gamma","Gamma",Y(N,R.none(),a),!1),o("invert","Invert",Y(P,J,a),!1)],Q=qx.sketch({dom:u,components:$.map((function(t){return t.asSpec()}))}),Z=qx.sketch({dom:{tag:"div"},components:[Q],containerBehaviours:wc([ap.config({})])}),tt=bh(Z);return{memContainer:tt,getApplyButton:function(t){return tt.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},p_=tinymce.util.Tools.resolve("tinymce.geom.Rect"),h_=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),v_=tinymce.util.Tools.resolve("tinymce.util.Observable"),b_=tinymce.util.Tools.resolve("tinymce.util.VK"),y_=function(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};function x_(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(y_(t),t.button!==o)return s(t);t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function(t){y_(t),h_(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),n.stop&&n.stop(t)};return h_(a).on("mousedown touchstart",(function(t){var f,l=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight);return{width:r<u?i:r,height:a<n(e.offsetHeight,o.offsetHeight)?c:a}}(u);y_(t),t.preventDefault(),o=t.button;var d=a;r=t.screenX,i=t.screenY,f=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,e=h_("<div></div>").css({position:"absolute",top:0,left:0,width:l.width,height:l.height,zIndex:2147483647,opacity:1e-4,cursor:f}).appendTo(u.body),h_(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)})),{destroy:function(){h_(a).off()}}}var w_=0,S_=function(t,n,e,o,r){var i,u="tox-crid-"+w_++,a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],c=["top","right","bottom","left"],s=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},f=function(n,o,r,i){var u,a,c,f,l;u=o.x,a=o.y,c=o.w,f=o.h,u+=r*n.deltaX,a+=i*n.deltaY,(c+=r*n.deltaW)<20&&(c=20),(f+=i*n.deltaH)<20&&(f=20),l=t=p_.clamp({x:u,y:a,w:c,h:f},e,"move"===n.name),l=s(e,l),g.fire("updateRect",{rect:l}),m(l)},l=function(t){var e=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),h_("#"+u+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})};SC.each(a,(function(n){h_("#"+u+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},d=function(n){l(t=n)},m=function(t){var n,o;d((n=e,{x:(o=t).x+n.x,y:o.y+n.y,w:o.w,h:o.h}))};h_('<div id="'+u+'" class="tox-croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),SC.each(c,(function(t){h_("#"+u,o).append('<div id="'+u+"-"+t+'"class="tox-croprect-block" style="display: none" data-mce-bogus="all">')})),SC.each(a,(function(t){h_("#"+u,o).append('<div id="'+u+"-"+t.name+'" class="tox-croprect-handle tox-croprect-handle-'+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),i=SC.map(a,(function(n){var e;return x_(u,{document:o.ownerDocument,handle:u+"-"+n.name,start:function(){e=t},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})})),l(t),h_(o).on("focusin focusout",(function(t){h_(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),h_(o).on("keydown",(function(n){var e;SC.each(a,(function(t){if(n.target.id===u+"-"+t.name)return e=t,!1}));var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),f(e,o,r,i)};switch(n.keyCode){case b_.LEFT:o(n,0,t,-10,0);break;case b_.RIGHT:o(n,0,t,10,0);break;case b_.UP:o(n,0,t,0,-10);break;case b_.DOWN:o(n,0,t,0,10);break;case b_.ENTER:case b_.SPACEBAR:n.preventDefault(),r()}}));var g=SC.extend({toggleVisibility:function(t){var n=SC.map(a,(function(t){return"#"+u+"-"+t.name})).concat(SC.map(c,(function(t){return"#"+u+"-"+t}))).join(",");t?h_(n,o).show():h_(n,o).hide()},setClampRect:function(n){e=n,l(t)},setRect:d,getInnerRect:function(){return s(e,t)},setInnerRect:m,setViewPortRect:function(e){n=e,l(t)},destroy:function(){SC.each(i,(function(t){t.destroy()})),i=[]}},v_);return g},k_=function(t){var n=bh({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=oe(1),o=Qc(),r=oe({x:0,y:0,w:1,h:1}),i=oe({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each((function(t){var u=e.get(),a=Lu(t.element),c=Fu(t.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};cu(i,m),n.getOpt(t).each((function(t){cu(t.element,m)})),o.on((function(t){var n=r.get();t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){var o,a=ie.fromTag("img");return ni(a,"src",n),(o=a.dom,new Uh((function(t){var n=function(){o.removeEventListener("load",n),t(o)};o.complete?t(o):o.addEventListener("load",n)}))).then((function(){t.getSystem().isConnected()&&s.getOpt(t).map((function(t){var n=Tu({element:a});ap.replaceAt(t,1,R.some(n));var o=i.get(),c={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight};i.set(c);var f=p_.inflate(c,-20,-20);r.set(f),o.w===c.w&&o.h===c.h||function(t,n){s.getOpt(t).each((function(t){var o=Lu(t.element),r=Fu(t.element),i=n.dom.naturalWidth,u=n.dom.naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)}))}(t,a),u(t,a)}))}))},c=qx.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:wc([cp("image-panel-crop-events",[pr((function(t){s.getOpt(t).each((function(t){var n=t.element.dom,i=S_({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,p);i.toggleVisibility(!1),i.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)})),o.set(i)}))}))])])}],containerBehaviours:wc([ap.config({}),cp("image-panel-events",[pr((function(n){a(n,t)}))])])}),s=bh(c);return{memContainer:s,updateSrc:a,zoom:function(t,n){var o=e.get(),r=n>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),s.getOpt(t).each((function(t){var n=t.components()[1].element;u(t,n)}))},showCrop:function(){o.on((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){o.on((function(t){t.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}},C_=function(t,n,e,o,r){return YO({name:t,icon:R.some(n),disabled:e,tooltip:R.some(t),primary:!1,borderless:!1},o,r)},O_=function(t,n){n?Kd.enable(t):Kd.disable(t)};var __,T_=function(t){var n,e,o,r,i=oe(t),u=Qc(),a=(e=-1,{data:n=[],add:function(t){var o=n.splice(++e);return n.push(t),{state:t,removed:o}},undo:function(){if(o())return n[--e]},redo:function(){if(r())return n[++e]},canUndo:o=function(){return e>0},canRedo:r=function(){return-1!==e&&e<n.length-1}});a.add(t);var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},f=function(t){URL.revokeObjectURL(t.url)},l=function(){u.on(f),u.clear()},d=function(t){var n=s(t);c(n);var e,o=a.add(n).removed;return e=o,SC.each(e,f),n.url};return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:d,getTempState:function(){return u.get().getOrThunk(i.get)},updateTempState:function(t){var n=s(t);return l(),u.set(n),n.url},addTempState:function(t){var n=s(t);return u.set(n),n.url},applyTempState:function(t){return u.get().fold(p,(function(n){d(n.blob),t()}))},destroyTempState:l,undo:function(){var t=a.undo();return c(t),t.url},redo:function(){var t=a.redo();return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}},E_=function(t,n){var e=T_(t.currentState),o=function(t){var n=e.getHistoryStates();d.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Zo(t,m_.formActionEvent,{name:m_.saveState(),value:n.undoEnabled})},r=function(t){return t.toBlob()},i=function(t){Zo(t,m_.formActionEvent,{name:m_.disable(),value:{}})},u=function(t){m.getApplyButton(t).each((function(t){Kd.enable(t)})),Zo(t,m_.formActionEvent,{name:m_.enable(),value:{}})},a=function(t,n){return i(t),l.updateSrc(t,n)},c=function(t,n,e,c,s){i(t),function(t){return QC(t)}(n).then(e).then(r).then(c).then((function(n){return a(t,n)})).then((function(){o(t),s(),u(t)})).catch((function(n){console.log(n),t.getSystem().isConnected()&&u(t)}))},s=function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(t){return e.updateTempState(t)}),o)},f=function(t){var n=e.getBlobState().url;return e.destroyTempState(),o(t),n},l=k_(t.currentState.url),d=function(t){var n=bh(C_("Undo","undo",!0,(function(t){Zo(t,s_.undo(),{direction:1})}),t)),e=bh(C_("Redo","redo",!0,(function(t){Zo(t,s_.redo(),{direction:1})}),t)),o=qx.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),e.asSpec(),C_("Zoom in","zoom-in",!1,(function(t){Zo(t,s_.zoom(),{direction:1})}),t),C_("Zoom out","zoom-out",!1,(function(t){Zo(t,s_.zoom(),{direction:-1})}),t)]});return{container:o,updateButtonUndoStates:function(t,o,r){n.getOpt(t).each((function(t){O_(t,o)})),e.getOpt(t).each((function(t){O_(t,r)}))}}}(n),m=g_(l,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[m.memContainer.asSpec(),l.memContainer.asSpec(),d.container],behaviours:wc([_l.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),cp("image-tools-events",[ar(s_.undo(),(function(t,n){var r=e.undo();a(t,r).then((function(n){u(t),o(t)}))})),ar(s_.redo(),(function(t,n){var r=e.redo();a(t,r).then((function(n){u(t),o(t)}))})),ar(s_.zoom(),(function(t,n){var e=n.event.direction;l.zoom(t,e)})),ar(s_.back(),(function(t,n){!function(t){var n=f(t);a(t,n).then((function(n){u(t)}))}(t),(0,n.event.swap)(),l.hideCrop()})),ar(s_.apply(),(function(t,n){e.applyTempState((function(){f(t),(0,n.event.swap)()}))})),ar(s_.transform(),(function(t,n){return s(t,n.event.transform,p)})),ar(s_.tempTransform(),(function(t,n){return function(t,n){var o=e.getTempState().blob;c(t,o,n,(function(t){return e.addTempState(t)}),p)}(t,n.event.transform)})),ar(s_.transformApply(),(function(t,n){return function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(n){var o=e.addBlobState(n);return f(t),o}),o)}(t,n.event.transform,n.event.swap)})),ar(s_.swap(),(function(t,n){!function(t){d.updateButtonUndoStates(t,!1,!1)}(t);var e=n.event.transform,o=n.event.swap;e.fold((function(){o()}),(function(n){s(t,n,o)}))}))]),hC()])}},D_=function(t){return!zt(t,"items")},B_="data-value",A_=function(t,n,e,o){return U(e,(function(e){return D_(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){_l.setValue(t,e.value),Zo(t,uw,{name:n}),mp.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return A_(t,n,e.items,o)}}}))},M_=function(t,n){return ft(t,(function(t){return D_(t)?tu(t.value===n,t):M_(t.items,n)}))},F_=Bd({name:"HtmlSelect",configFields:[Mn("options"),Tl("selectBehaviours",[mp,_l]),Yn("selectClasses",[]),Yn("selectAttributes",{}),Ln("data")],factory:function(t,n){var e=U(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return qe("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Dl(t.selectBehaviours,[mp.config({}),_l.config({store:_({mode:"manual",getValue:function(t){return vu(t.element)},setValue:function(n,e){J(t.options,(function(t){return t.value===e})).isSome()&&bu(n.element,e)}},o)})])}}}),I_=function(t,n){var e=t.label.map((function(t){return iw(t,n)})),o=[Kd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Xb(),np.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Qo(t,fw),R.some(!0)}}),cp("textfield-change",[ar(bo(),(function(n,e){Zo(n,uw,{name:t.name})})),ar(Do(),(function(n,e){Zo(n,uw,{name:t.name})}))]),tw.config({})],r=t.validation.map((function(t){return Nw.config({getRoot:function(t){return Br(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=_l.getValue(n),o=t.validator(e);return Bw(!0===o?mt.value(e):mt.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=t.placeholder.fold(v({}),(function(t){return{placeholder:n.translate(t)}})),u=t.inputMode.fold(v({}),(function(t){return{inputmode:t}})),a=_(_({},i),u),c=$x.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:wc(Q([o,r])),selectOnFocus:!1,factory:xw}),s=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),f=[Kd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){$x.getField(t).each(Kd.disable)},onEnabled:function(t){$x.getField(t).each(Kd.enable)}}),Xb()];return ew(e,c,s,f)},R_=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return rr([ar(t.event,e),hr((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[ar(t,(function(){return n.cancel()}))]})).getOr([])))}}),V_=function(t){var n=oe(null);return Di({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},P_=Object.freeze({__proto__:null,throttle:V_,init:function(t){return t.stream.streams.state(t)}}),H_=[Fn("stream",En("mode",{throttle:[Mn("delay"),Yn("stopEvent",!0),Ma("streams",{setup:function(t,n){var e=t.stream,o=Fh(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:V_})]})),Yn("event","input"),Ln("cancelEvent"),Ba("onStream")],z_=kc({fields:H_,name:"streaming",active:R_,state:P_}),N_=function(t,n,e){var o=_l.getValue(e);_l.setValue(n,o),j_(n)},L_=function(t,n){var e=t.element,o=vu(e),r=e.dom;"number"!==ei(e,"type")&&n(r,o)},j_=function(t){L_(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},W_=function(t,n,e){if(t.selectsOver){var o=_l.getValue(n),r=t.getDisplayText(o),i=_l.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?R.some((function(){N_(0,n,e),function(t,n){L_(t,(function(t,e){return t.setSelectionRange(n,e.length)}))}(n,r.length)})):R.none()}return R.none()},U_=v("alloy.typeahead.itemexecute"),G_=v([Ln("lazySink"),Mn("fetch"),Yn("minChars",5),Yn("responseTime",1e3),Ea("onOpen"),Yn("getHotspot",R.some),Yn("getAnchorOverrides",v({})),Yn("layouts",R.none()),Yn("eventOrder",{}),ee("model",{},[Yn("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),Yn("selectsOver",!0),Yn("populateFromBrowse",!0)]),Ea("onSetValue"),Da("onExecute"),Ea("onItemExecute"),Yn("inputClasses",[]),Yn("inputAttributes",{}),Yn("inputStyles",{}),Yn("matchWidth",!0),Yn("useMinWidth",!1),Yn("dismissOnBlur",!0),_a(["openClass"]),Ln("initialData"),Tl("typeaheadBehaviours",[mp,_l,z_,np,Op,Uw]),Bn("previewing",(function(){return oe(!0)}))].concat(hw()).concat(iS())),X_=v([od({schema:[Oa()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){W_(t.model,o,e).fold((function(){return um.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&N_(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Zo(t,U_(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&N_(t.model,n,e)}))}}}})]),q_=Ad({name:"Typeahead",configFields:G_(),partFields:X_(),factory:function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=Uw.getCoupled(n,"sandbox");if(ul.isOpen(i))Rd.getCurrent(i).each((function(t){um.getHighlighted(t).fold((function(){r(t)}),(function(){or(i,t.element,"keydown",e)}))}));else{$w(t,u(n),n,i,o,(function(t){Rd.getCurrent(t).each(r)}),kw.HighlightFirst).get(p)}},i=vw(t),u=function(t){return function(n){return n.map((function(n){var e=Pt(n.menus),o=Z(e,(function(t){return q(t.items,(function(t){return"item"===t.type}))}));return _l.getState(t).update(U(o,(function(t){return t.data}))),n}))}},a=[mp.config({}),_l.config({onSetValue:t.onSetValue,store:_({mode:"dataset",getDataKey:function(t){return vu(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){bu(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return qe("initialValue",t)})).getOr({}))}),z_.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=Uw.getCoupled(n,"sandbox");if(mp.isFocused(n)&&vu(n.element).length>=t.minChars){var i=Rd.getCurrent(r).bind((function(t){return um.getHighlighted(t).map(_l.getValue)}));t.previewing.set(!0);$w(t,u(n),n,r,o,(function(n){Rd.getCurrent(r).each((function(n){i.fold((function(){t.model.selectsOver&&um.highlightFirst(n)}),(function(t){um.highlightBy(n,(function(n){return _l.getValue(n).value===t.value})),um.getHighlighted(n).orThunk((function(){return um.highlightFirst(n),R.none()}))}))}))}),kw.HighlightFirst).get(p)}},cancelEvent:Vo()}),np.config({mode:"special",onDown:function(t,n){return r(t,n,um.highlightFirst),R.some(!0)},onEscape:function(t){var n=Uw.getCoupled(t,"sandbox");return ul.isOpen(n)?(ul.close(n),R.some(!0)):R.none()},onUp:function(t,n){return r(t,n,um.highlightLast),R.some(!0)},onEnter:function(n){var e=Uw.getCoupled(n,"sandbox"),o=ul.isOpen(e);if(o&&!t.previewing.get())return Rd.getCurrent(e).bind((function(t){return um.getHighlighted(t)})).map((function(t){return Zo(n,U_(),{item:t}),!0}));var r=_l.getValue(n);return Qo(n,Vo()),t.onExecute(e,n,r),o&&ul.close(e),R.some(!0)}}),Op.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),Uw.config({others:{sandbox:function(n){return oS(t,n,{onOpen:function(){return Op.on(n)},onClose:function(){return Op.off(n)}})}}}),cp("typeaheadevents",[br((function(n){var e=p;Zw(t,u(n),n,o,e,kw.HighlightFirst).get(p)})),ar(U_(),(function(n,e){var o=Uw.getCoupled(n,"sandbox");N_(t.model,n,e.event.item),Qo(n,Vo()),t.onItemExecute(n,o,e.event.item,_l.getValue(n)),ul.close(o),j_(n)}))].concat(t.dismissOnBlur?[ar(Eo(),(function(t){var n=Uw.getCoupled(t,"sandbox");Mc(n.element).isNone()&&ul.close(n)}))]:[]))];return{uid:t.uid,dom:yw(jt(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:_(_({},i),Dl(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}}}),Y_=function(t){return _(_({},t),{toCached:function(){return Y_(t.toCached())},bindFuture:function(n){return Y_(t.bind((function(t){return t.fold((function(t){return Bw(mt.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return Y_(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return Y_(t.map((function(t){return t.map(n)})))},mapError:function(n){return Y_(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return Y_(Dw((function(o){var r=!1,i=setTimeout((function(){r=!0,o(mt.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},K_=function(t){return Y_(Dw(t))},J_=K_,$_={type:"separator"},Q_=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:p}},Z_=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:p}},tT=function(t,n){return function(t){return U(t,Q_)}(function(t,n){return q(n,(function(n){return n.type===t}))}(t,n))},nT=function(t){return tT("header",t.targets)},eT=function(t){return tT("anchor",t.targets)},oT=function(t){return R.from(t.anchorTop).map((function(t){return Z_("<top>",t)})).toArray()},rT=function(t){return R.from(t.anchorBottom).map((function(t){return Z_("<bottom>",t)})).toArray()},iT=function(t,n){var e=t.toLowerCase();return q(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return le(n.toLowerCase(),e)||le(t.value.toLowerCase(),e)}))},uT=function(t,n,e){var o=_l.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i=iT(r,function(t){return U(t,(function(t){return Z_(t,t)}))}(e.getHistory(t)));return"file"===t?(o=[i,iT(r,nT(n)),iT(r,Q([oT(n),eT(n),rT(n)]))],K(o,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat($_,n)}),[])):i}))},aT=di("aria-invalid"),cT=function(t){return function(n,e,o){return Ht(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},sT={bar:cT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:U(t.items,n.interpreter)}}(t,n.shared)})),collection:cT((function(t,n){return pw(t,n.shared.providers)})),alertbanner:cT((function(t,n){return function(t,n){return qx.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[vh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Oh(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){Zo(n,sw,{name:"alert-banner",value:t.url})},buttonBehaviours:wc([_h()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})}(t,n.shared.providers)})),input:cT((function(t,n){return function(t,n){return I_({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:R.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),textarea:cT((function(t,n){return function(t,n){return I_({name:t.name,multiline:!0,label:t.label,inputMode:R.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:R.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),label:cT((function(t,n){return function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},o=U(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:wc([hC(),ap.config({}),EC(R.none()),np.config({mode:"acyclic"})])}}(t,n.shared)})),iframe:function(t){return function(n,e,o){var r=jt(e,{source:"dynamic"});return cT(t)(n,r,o)}}((function(t,n){return zC(t,n.shared.providers)})),button:cT((function(t,n){return ZO(t,n.shared.providers)})),checkbox:cT((function(t,n){return function(t,n){var e=_l.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),o=function(t){return t.element.dom.click(),R.some(!0)},r=$x.parts.field({factory:{sketch:b},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:wc([hC(),Kd.config({disabled:function(){return t.disabled||n.isDisabled()}}),tw.config({}),mp.config({}),e,np.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),cp("checkbox-events",[ar(yo(),(function(n,e){Zo(n,uw,{name:t.name})}))])])}),i=$x.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:wc([fS.config({})])}),u=function(t){return Eh("checked"===t?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},n.icons)},a=bh({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return $x.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:wc([Kd.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){$x.getField(t).each(Kd.disable)},onEnabled:function(t){$x.getField(t).each(Kd.enable)}}),Xb()])})}(t,n.shared.providers)})),colorinput:cT((function(t,n){return gS(t,n.shared,n.colorinput)})),colorpicker:cT((function(t){var n=function(t){return"tox-"+t},e=pC(xC,n),o=bh(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){Zo(t,sw,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Zo(t,sw,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:wc([_l.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return Rd.getCurrent(n).bind((function(t){return _l.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t);Rd.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){_l.setValue(t,{hex:R.from(e[1]).getOr("")}),cC.getField(t,"hex").each((function(t){Qo(t,bo())}))}))}}}),hC()])}})),dropzone:cT((function(t,n){return BC(t,n.shared.providers)})),grid:cT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:U(t.items,n.interpreter)}}(t,n.shared)})),listbox:cT((function(t,n){return function(t,n){var e=n.shared.providers,o=at(t.items).filter(D_),r=t.label.map((function(t){return iw(t,e)})),i=$x.parts.field({dom:{},factory:{sketch:function(e){return VO({uid:e.uid,text:o.map((function(t){return t.text})),icon:R.none(),tooltip:t.label,role:R.none(),fetch:function(e,o){var r=A_(e,t.name,t.items,_l.getValue(e));o(jO(r,hv.CLOSE_ON_EXECUTE,n,!1))},onSetup:v(p),getApi:v({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[tw.config({}),_l.config({store:{mode:"manual",initialValue:o.map((function(t){return t.value})).getOr(""),getValue:function(t){return ei(t.element,B_)},setValue:function(n,e){M_(t.items,e).each((function(t){ni(n.element,B_,t.value),Zo(n,IO,{text:t.text})}))}}})]},"tox-listbox",n.shared)}}}),u={dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]};return $x.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([r.toArray(),[u]]),fieldBehaviours:wc([Kd.config({disabled:v(t.disabled),onDisabled:function(t){$x.getField(t).each(Kd.disable)},onEnabled:function(t){$x.getField(t).each(Kd.enable)}})])})}(t,n)})),selectbox:cT((function(t,n){return function(t,n){var e=U(t.items,(function(t){return{text:n.translate(t.text),value:t.value}})),o=t.label.map((function(t){return iw(t,n)})),r=$x.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:F_,selectBehaviours:wc([Kd.config({disabled:function(){return t.disabled||n.isDisabled()}}),tw.config({}),cp("selectbox-change",[ar(yo(),(function(n,e){Zo(n,uw,{name:t.name})}))])])}),i=t.size>1?R.none():R.some(Eh("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:Q([[r],i.toArray()])};return $x.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([o.toArray(),[u]]),fieldBehaviours:wc([Kd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){$x.getField(t).each(Kd.disable)},onEnabled:function(t){$x.getField(t).each(Kd.enable)}}),Xb()])})}(t,n.shared.providers)})),sizeinput:cT((function(t,n){return c_(t,n.shared.providers)})),urlinput:cT((function(t,n){return function(t,n,e){var o,r=n.shared.providers,i=function(n){var o=_l.getValue(n);e.addToHistory(o.value,t.filetype)},u=$x.parts.field({factory:q_,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":aT,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=uT(t.filetype,o,e),i=jO(r,hv.BUBBLE_TO_SANDBOX,n,!1);return Bw(i)},getHotspot:function(t){return d.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(Nw)&&Nw.run(t).get(p)},typeaheadBehaviours:wc(Q([e.getValidationHandler().map((function(n){return Nw.config({getRoot:function(t){return Br(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){c.getOpt(t).each((function(t){ni(t.element,"title",r.translate(n))}))}},validator:{validate:function(e){var o=_l.getValue(e);return J_((function(e){n({type:t.filetype,url:o.value},(function(t){if("invalid"===t.status){var n=mt.error(t.message);e(n)}else{var o=mt.value(t.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[Kd.config({disabled:function(){return t.disabled||r.isDisabled()}}),tw.config({}),cp("urlinput-events",Q(["file"===t.filetype?[ar(bo(),(function(n){Zo(n,uw,{name:t.name})}))]:[],[ar(yo(),(function(n){Zo(n,uw,{name:t.name}),i(n)})),ar(Do(),(function(n){Zo(n,uw,{name:t.name}),i(n)}))]]))]])),eventOrder:(o={},o[bo()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Iv(0,0,"normal")},onExecute:function(t,n,e){Zo(n,fw,{})},onItemExecute:function(n,e,o,r){i(n),Zo(n,uw,{name:t.name})}}),a=t.label.map((function(t){return iw(t,r)})),c=bh(function(t,n,e,o){return void 0===e&&(e=t),void 0===o&&(o=t),Eh(e,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],attributes:_({title:r.translate(o),"aria-live":"polite"},n.fold((function(){return{}}),(function(t){return{id:t}})))},r.icons)}("invalid",R.some(aT),"warning")),s=bh({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c.asSpec()]}),f=e.getUrlPicker(t.filetype),l=di("browser.url.event"),d=bh({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,s.asSpec()],behaviours:wc([Kd.config({disabled:function(){return t.disabled||r.isDisabled()}})])}),m=bh(JO({name:t.name,icon:R.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return Qo(t,l)}),r,[],["tox-browse-url"]));return $x.sketch({dom:rw([]),components:a.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Q([[d.asSpec()],f.map((function(){return m.asSpec()})).toArray()])}]),fieldBehaviours:wc([Kd.config({disabled:function(){return t.disabled||r.isDisabled()},onDisabled:function(t){$x.getField(t).each(Kd.disable),m.getOpt(t).each(Kd.disable)},onEnabled:function(t){$x.getField(t).each(Kd.enable),m.getOpt(t).each(Kd.enable)}}),Xb(),cp("url-input-events",[ar(l,(function(n){Rd.getCurrent(n).each((function(e){var o=_l.getValue(e),r=_({fieldname:t.name},o);f.each((function(o){o(r).get((function(o){_l.setValue(e,o),Zo(n,uw,{name:t.name})}))}))}))}))])])})}(t,n,n.urlinput)})),customeditor:cT((function(t){var n=Qc(),e=bh({dom:{tag:t.tag}}),o=Qc();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:wc([cp("custom-editor-events",[pr((function(r){e.getOpt(r).each((function(e){(!function(t){return zt(t,"init")}(t)?wC.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)})):t.init(e.element.dom)).then((function(t){o.on((function(n){t.setValue(n)})),o.clear(),n.set(t)}))}))}))]),_l.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(e)}),(function(t){return t.setValue(e)}))}}}),hC()]),components:[e.asSpec()]}})),htmlpanel:cT((function(t){return"presentation"===t.presets?qx.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):qx.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:wc([tw.config({}),mp.config({})])})})),imagetools:cT((function(t,n){return E_(t,n.shared.providers)})),table:cT((function(t,n){return function(t,n){var e,o,r=function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}},i=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}},u=function(t){return{dom:{tag:"tr"},components:U(t,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(o=t.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:U(o,r)}]}),(e=t.cells,{dom:{tag:"tbody"},components:U(e,u)})],behaviours:wc([tw.config({}),mp.config({})])}}(t,n.shared.providers)})),panel:cT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:t.classes},components:U(t.items,n.shared.interpreter)}}(t,n)}))},fT={field:function(t,n){return n}},lT=function(t,n,e){var o=jt(e,{shared:{interpreter:function(n){return dT(t,n,o)}}});return dT(t,n,o)},dT=function(t,n,e){return Ht(sT,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},mT={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},gT=function(t,n,e){var o={maxHeightFunction:ms()};return function(){return e()?{type:"node",root:Nr(t()),node:R.from(t()),bubble:vs(12,12,mT),layouts:{onRtl:function(){return[ah]},onLtr:function(){return[uh]}},overrides:o}:{type:"hotspot",hotspot:n(),bubble:vs(-12,12,mT),layouts:{onRtl:function(){return[nc]},onLtr:function(){return[ec]}},overrides:o}}},pT=function(t,n,e){return function(){return e()?{type:"node",root:Nr(t()),node:R.from(t()),layouts:{onRtl:function(){return[ch]},onLtr:function(){return[ch]}}}:{type:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[uc]},onLtr:function(){return[uc]}}}}},hT=function(t,n){return function(){return{type:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return R.some(Ws.range(ie.fromDom(n.startContainer),n.startOffset,ie.fromDom(n.endContainer),n.endOffset))}}}},vT=function(t){return function(n){return{type:"node",root:t(),node:n}}},bT=function(t,n,e){var o=Ib(t),r=function(){return ie.fromDom(t.getBody())},i=function(){return ie.fromDom(t.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:gT(i,n,u),banner:pT(i,n,u),cursor:hT(t,r),node:vT(r)}},yT=function(t){return function(n,e){sx(t)(n,e)}},xT=function(t){return function(){return Qy(t)}},wT=function(t){return function(){return Zy(t)}},ST=function(t){return function(){return nx(t)}},kT=function(t){return{colorPicker:yT(t),hasCustomColors:xT(t),getColors:wT(t),getColorCols:ST(t)}},CT=function(t){return function(){return function(t){return t.getParam("draggable_modal",!1,"boolean")}(t)}},OT=function(t){return{isDraggableModal:CT(t)}},_T=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],TT=function(t){return K(t,(function(t,n){if(zt(n,"items")){var e=TT(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(function(t){return zt(t,"inline")}(n)||function(t){return zt(t,"block")}(n)||function(t){return zt(t,"selector")}(n)){var o="custom-"+(r(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return _(_({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},ET=function(t){return function(t){return R.from(t.getParam("style_formats")).filter(u)}(t).map((function(n){var e=function(t,n){var e=TT(n),o=function(n){G(n,(function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)}))};return t.formatter?o(e.customFormats):t.on("init",(function(){o(e.customFormats)})),e.formats}(t,n);return function(t){return t.getParam("style_formats_merge",!1,"boolean")}(t)?_T.concat(e):e})).getOr(_T)},DT=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return jt(t,o)},BT=function(t,n,e,o){var i=function(n){return U(n,(function(n){var u=Dt(n);if(Nt(n,"items")){var a=i(n.items);return jt(function(t){return jt(t,{type:"submenu"})}(n),{getStyleItems:v(a)})}return Nt(n,"format")?function(t){return DT(t,e,o)}(n):1===u.length&&N(u,"title")?jt(n,{type:"separator"}):function(n){var i=r(n.name)?n.name:di(n.title),u="custom-"+i,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:o(u)},c=jt(n,a);return t.formatter.register(i,c),c}(n)}))};return i(n)},AT=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?R.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):R.none()}},o=function(t){var n=t.items;return void 0!==n&&n.length>0?Z(n,o):[t.format]},r=oe([]),i=oe([]),u=oe([]),a=oe([]),c=oe(!1);t.on("PreInit",(function(u){var a=ET(t),c=BT(t,a,n,e);r.set(c),i.set(Z(c,o))})),t.on("addStyleModifications",(function(r){var i=BT(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(Z(i,o))}));return{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}},MT=SC.trim,FT=function(t){return function(n){if(function(t){return l(t)&&1===t.nodeType}(n)){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},IT=FT("true"),RT=FT("false"),VT=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},PT=function(t){return t.innerText||t.textContent},HT=function(t){return function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)}(t)&&NT(t)},zT=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},NT=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return IT(t)}return!1}(t)&&!RT(t)},LT=function(t){return zT(t)&&NT(t)},jT=function(t){var n=function(t){return t.id?t.id:di("h")}(t);return VT("header",PT(t),"#"+n,function(t){return zT(t)?parseInt(t.nodeName.substr(1),10):0}(t),(function(){t.id=n}))},WT=function(t){var n=t.id||t.name,e=PT(t);return VT("anchor",e||"#"+n,"#"+n,0,p)},UT=function(t){var n,e,o=(n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,U(of(ie.fromDom(e),n),(function(t){return t.dom})));return o},GT=function(t){return MT(t.title).length>0},XT=function(t){var n=UT(t);return q(function(t){return U(q(t,LT),jT)}(n).concat(function(t){return U(q(t,HT),WT)}(n)),GT)},qT="tinymce-url-history",YT=function(t){return r(t)&&/^https?/.test(t)},KT=function(t){return i(t)&&Vt(t,(function(t){return!(u(n=t)&&n.length<=5&&tt(n,YT));var n})).isNone()},JT=function(){var t,n=Xy.getItem(qT);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+qT+" was not valid JSON",t),{};throw t}return KT(t)?t:(console.log("Local storage "+qT+" was not valid format",t),{})},$T=function(t){var n=JT();return Ht(n,t).getOr([])},QT=function(t,n){if(YT(t)){var e=JT(),o=Ht(e,n).getOr([]),r=q(o,(function(n){return n!==t}));e[n]=[t].concat(r).slice(0,5),function(t){if(!KT(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Xy.setItem(qT,JSON.stringify(t))}(e)}},ZT=function(t){return!!t},tE=function(t){return Mt(SC.makeMap(t,/[, ]/),ZT)},nE=function(t){return R.from(function(t){return t.getParam("file_picker_callback")}(t)).filter(d)},eE=function(t,n){var e=function(t){var n=R.some(function(t){return t.getParam("file_picker_types")}(t)).filter(ZT),e=R.some(function(t){return t.getParam("file_browser_callback_types")}(t)).filter(ZT),o=n.or(e).map(tE);return nE(t).fold(k,(function(t){return o.fold(C,(function(t){return Dt(t).length>0&&t}))}))}(t);return c(e)?e?nE(t):R.none():e[n]?nE(t):R.none()},oE=function(t){return R.from(t).filter(r).getOrUndefined()},rE=function(t){return{getHistory:$T,addToHistory:QT,getLinkInformation:function(){return function(t){return function(t){return!1===t.getParam("typeahead_urls")}(t)?R.none():R.some({targets:XT(t.getBody()),anchorTop:oE(Nb(t)),anchorBottom:oE(Lb(t))})}(t)},getValidationHandler:function(){return function(t){return R.from(function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function");return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n}(t))}(t)},getUrlPicker:function(n){return function(t,n){return eE(t,n).map((function(e){return function(o){return Dw((function(u){var a=_({filetype:n,fieldname:o.fieldname},R.from(o.meta).getOr({}));e.call(t,(function(t,n){if(!r(t))throw new Error("Expected value to be string");if(void 0!==n&&!i(n))throw new Error("Expected meta to be a object");u({value:t,meta:n})}),o.value,a)}))}}))}(t,n)}}},iE=function(t,n,e){var o=oe(!1),r=function(t){var n=oe(Mb(t)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}}(n),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:yh.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return function(t,n){return dT(fT,t,n)}(t,i)},anchors:bT(n,e,r.isPositionedAtTop),header:r,getSink:function(){return mt.value(t)}},urlinput:rE(n),styleselect:AT(n),colorinput:kT(n),dialog:OT(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i},uE=Cd,aE=ad,cE=v([Yn("shell",!1),Mn("makeItem"),Yn("setupItem",p),Bl("listBehaviours",[ap])]),sE=rd({name:"items",overrides:function(){return{behaviours:wc([ap.config({})])}}}),fE=v([sE]),lE=v("CustomList"),dE=Ad({name:lE(),configFields:cE(),partFields:fE(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[ap.config({})],components:[]}:{behaviours:[],components:n},i=function(n){return t.shell?R.some(n):hd(n,t,"items")};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Dl(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){i(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=ap.contents(o),i=e.length,u=i-r.length,a=u>0?j(u,(function(){return t.makeItem()})):[],c=r.slice(i);G(c,(function(t){return ap.remove(o,t)})),G(a,(function(t){return ap.append(o,t)}));var s=ap.contents(o);G(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),mE=v([Mn("dom"),Yn("shell",!0),Tl("toolbarBehaviours",[ap])]),gE=v([rd({name:"groups",overrides:function(){return{behaviours:wc([ap.config({})])}}})]),pE=Ad({name:"Toolbar",configFields:mE(),partFields:gE(),factory:function(t,n,e,o){var r=function(n){return t.shell?R.some(n):hd(n,t,"groups")},i=t.shell?{behaviours:[ap.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:Dl(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){ap.set(t,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),hE=p,vE=k,bE=v([]),yE=Object.freeze({__proto__:null,setup:hE,isDocked:vE,getBehaviours:bE}),xE=function(t){return($i(du(t,"position"),"fixed")?R.none():Ar(t)).orThunk((function(){var n=ie.fromTag("span");return Br(t).bind((function(t){qr(t,n);var e=Ar(n);return Jr(n),e}))}))},wE=function(t){return xE(t).map(Hu).getOrThunk((function(){return Vu(0,0)}))},SE=Ge([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),kE=function(t,n){var e=t.element;Gi(e,n.transitionClass),qi(e,n.fadeOutClass),Gi(e,n.fadeInClass),n.onShow(t)},CE=function(t,n){var e=t.element;Gi(e,n.transitionClass),qi(e,n.fadeInClass),Gi(e,n.fadeOutClass),n.onHide(t)},OE=function(t,n,e){return tt(t,(function(t){switch(t){case"bottom":return function(t,n){return t.bottom<=n.bottom}(n,e);case"top":return function(t,n){return t.y>=n.y}(n,e)}}))},_E=function(t,n){return n.getInitialPos().map((function(n){return Zu(n.bounds.x,n.bounds.y,Lu(t),Fu(t))}))},TE=function(t,n,e){return e.getInitialPos().bind((function(o){switch(e.clearInitialPos(),o.position){case"static":return R.some(SE.static());case"absolute":var r=xE(t).map(ta).getOrThunk((function(){return ta(ou())}));return R.some(SE.absolute(Ic("absolute",Ht(o.style,"left").map((function(t){return n.x-r.x})),Ht(o.style,"top").map((function(t){return n.y-r.y})),Ht(o.style,"right").map((function(t){return r.right-n.right})),Ht(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return R.none()}}))},EE=function(t,n,e){var o=ta(t);if(OE(e.getModes(),o,n))return R.none();!function(t,n,e){e.setInitialPos({style:mu(t),position:fu(t,"position")||"static",bounds:n})}(t,o,e);var r=ea(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return R.some(SE.fixed(Ic("fixed",R.some(i),c?R.some(u):R.none(),R.none(),c?R.none():R.some(a))))},DE=function(t,n,e){var o=t.element;return $i(du(o,"position"),"fixed")?function(t,n,e){return _E(t,e).filter((function(t){return OE(e.getModes(),t,n)})).bind((function(n){return TE(t,n,e)}))}(o,n,e):EE(o,n,e)},BE=function(t,n){G(["left","right","top","bottom","position"],(function(n){return pu(t.element,n)})),n.onUndocked(t)},AE=function(t,n,e){Rc(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},ME=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=function(t,n){return t.y<n.bottom&&t.bottom>n.y}(i,o);u!==e.isVisible()&&(e.setVisible(u),r&&!u?(Ki(t.element,[n.fadeOutClass]),n.onHide(t)):(u?kE:CE)(t,n))}))}))},FE=function(t,n,e){var o=t.element;e.setDocked(!1),function(t,n){var e=t.element;return _E(e,n).bind((function(t){return TE(e,t,n)}))}(t,e).each((function(e){e.fold((function(){return BE(t,n)}),(function(e){return AE(t,n,e)}),p)})),e.setVisible(!0),n.contextual.each((function(n){Ji(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),IE(t,n,e)},IE=function(t,n,e){t.getSystem().isConnected()&&function(t,n,e){var o=n.lazyViewport(t),r=e.isDocked();r&&ME(t,n,e,o),DE(t,o,e).each((function(i){e.setDocked(!r),i.fold((function(){return BE(t,n)}),(function(e){return AE(t,n,e)}),(function(r){ME(t,n,e,o,!0),AE(t,n,r)}))}))}(t,n,e)},RE=function(t,n,e){e.isDocked()&&FE(t,n,e)},VE=Object.freeze({__proto__:null,refresh:IE,reset:RE,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),PE=Object.freeze({__proto__:null,events:function(t,n){return rr([gr(So(),(function(e,o){t.contextual.each((function(t){Yi(e.element,t.transitionClass)&&(Ji(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e));o.stop()}))})),ar(No(),(function(e,o){IE(e,t,n)})),ar(Lo(),(function(e,o){RE(e,t,n)}))])}}),HE=[qn("contextual",[Rn("fadeInClass"),Rn("fadeOutClass"),Rn("transitionClass"),Pn("lazyContext"),Ea("onShow"),Ea("onShown"),Ea("onHide"),Ea("onHidden")]),te("lazyViewport",ea),ne("modes",["top","bottom"],pn),Ea("onDocked"),Ea("onUndocked")],zE=kc({fields:HE,name:"docking",active:PE,apis:VE,state:Object.freeze({__proto__:null,init:function(t){var n=oe(!1),e=oe(!0),o=Qc(),r=oe(t.modes);return Di({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),NE=v(di("toolbar-height-change")),LE={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},jE="tox-tinymce--toolbar-sticky-on",WE="tox-tinymce--toolbar-sticky-off",UE=function(t,n){return N(zE.getModes(t),n)},GE=function(t){var n=t.element;Br(n).each((function(e){var o="padding-"+zE.getModes(t)[0];if(zE.isDocked(t)){var r=Lu(e);au(n,"width",r+"px"),au(e,o,function(t){return Iu(t)+(parseInt(fu(t,"margin-top"),10)||0)+(parseInt(fu(t,"margin-bottom"),10)||0)}(n)+"px")}else pu(n,"width"),pu(e,o)}))},XE=function(t,n){n?(qi(t,LE.fadeOutClass),Ki(t,[LE.transitionClass,LE.fadeInClass])):(qi(t,LE.fadeInClass),Ki(t,[LE.fadeOutClass,LE.transitionClass]))},qE=function(t,n){var e=ie.fromDom(t.getContainer());n?(Gi(e,jE),qi(e,WE)):(Gi(e,WE),qi(e,jE))},YE=function(t,n){var e=Qc(),o=n.getSink,r=function(t){o().each((function(n){return t(n.element)}))},i=function(n){t.inline||GE(n),qE(t,zE.isDocked(n)),n.getSystem().broadcastOn([cl()],{}),o().each((function(t){return t.getSystem().broadcastOn([cl()],{})}))},u=t.inline?[]:function(){var t;return[Tc.config({channels:(t={},t[NE()]={onReceive:GE},t)})]}();return E([mp.config({}),zE.config({contextual:_({lazyContext:function(n){var e=Iu(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=ta(ie.fromDom(o)),i=r.height-e,u=r.y+(UE(n,"top")?0:e);return R.some(Zu(r.x,u,r.width,i))},onShow:function(){r((function(t){return XE(t,!0)}))},onShown:function(t){r((function(t){return Ji(t,[LE.transitionClass,LE.fadeInClass])})),e.get().each((function(n){var o,r,i;o=t.element,i=_r(r=n),Ac(i).filter((function(t){return!je(r,t)})).filter((function(t){return je(t,ie.fromDom(i.dom.body))||Ue(o,t)})).each((function(){return Dc(r)})),e.clear()}))},onHide:function(t){(function(t,n){return Mc(t).orThunk((function(){return n().toOptional().bind((function(t){return Mc(t.element)}))}))})(t.element,o).fold(e.clear,e.set),r((function(t){return XE(t,!1)}))},onHidden:function(){r((function(t){return Ji(t,[LE.transitionClass])}))}},LE),lazyViewport:function(n){var e=ea(),o=function(t){return t.getParam("toolbar_sticky_offset",0,"number")}(t),r=e.y+(UE(n,"top")?o:0),i=e.height-(UE(n,"bottom")?o:0);return Zu(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:i,onUndocked:i})],u)},KE=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(zE.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(GE)})),t.on("SkinLoaded",(function(){e().each((function(t){zE.isDocked(t)?zE.reset(t):zE.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(zE.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){zE.refresh(n);var e=n.element;Km(e)&&function(t,n){var e=_r(n),o=e.dom.defaultView.innerHeight,r=Xu(e),i=ie.fromDom(t.elm),u=na(i),a=Fu(i),c=u.y,s=c+a,f=Hu(n),l=Fu(n),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)qu(r.left,c-l,e);else if(p&&s>d){var h=c-o+a+l;qu(r.left,h,e)}}(t,e)}))})),t.on("PostRender",(function(){qE(t,!1)}))},isDocked:function(t){return t().map(zE.isDocked).getOr(!1)},getBehaviours:YE}),JE=an([Rn("type"),Fn("items",sn([ln([Rn("name"),Nn("items",pn)]),pn]))].concat(tv)),$E=[Un("text"),Un("tooltip"),Un("icon"),Pn("fetch"),te("onSetup",(function(){return p}))],QE=an(E([Rn("type")],$E)),ZE=function(t){return Cn("menubutton",QE,t)},tD=an([Rn("type"),Un("tooltip"),Un("icon"),Un("text"),Gn("select"),Pn("fetch"),te("onSetup",(function(){return p})),Qn("presets","normal",["normal","color","listpreview"]),Yn("columns",1),Pn("onAction"),Pn("onItemAction")]),nD=Bd({factory:function(t,n){var e={focus:np.focusIn,setMenus:function(t,e){var o=U(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=ZE(e).mapError((function(t){return Tn(t)})).getOrDie();return UO(o,"tox-mbtn",n.backstage,R.some("menuitem"))}));ap.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:wc([ap.config({}),cp("menubar-events",[pr((function(n){t.onSetup(n)})),ar(mo(),(function(t,n){fa(t.element,".tox-mbtn--active").each((function(e){la(n.event.target,".tox-mbtn").each((function(n){je(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){cS.expand(t),cS.close(e),mp.focus(t)}))}))}))}))})),ar(Xo(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){cS.isOpen(e)&&(cS.expand(t),cS.close(e))}))}))}))]),np.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),R.some(!0)}}),tw.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Mn("dom"),Mn("uid"),Mn("onEscape"),Mn("backstage"),Yn("onSetup",p)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),eD=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},oD=function(t){return t.dimension.property},rD=function(t,n){return t.dimension.getDimension(n)},iD=function(t,n){var e=eD(t,n);Ji(e,[n.shrinkingClass,n.growingClass])},uD=function(t,n){qi(t.element,n.openClass),Gi(t.element,n.closedClass),au(t.element,oD(n),"0px"),hu(t.element)},aD=function(t,n){qi(t.element,n.closedClass),Gi(t.element,n.openClass),pu(t.element,oD(n))},cD=function(t,n,e,o){e.setCollapsed(),au(t.element,oD(n),rD(n,t.element)),hu(t.element),iD(t,n),uD(t,n),n.onStartShrink(t),n.onShrunk(t)},sD=function(t,n,e,o){var r=o.getOrThunk((function(){return rD(n,t.element)}));e.setCollapsed(),au(t.element,oD(n),r),hu(t.element);var i=eD(t,n);qi(i,n.growingClass),Gi(i,n.shrinkingClass),uD(t,n),n.onStartShrink(t)},fD=function(t,n,e){var o=rD(n,t.element);("0px"===o?cD:sD)(t,n,e,R.some(o))},lD=function(t,n,e){var o=eD(t,n),r=Yi(o,n.shrinkingClass),i=rD(n,t.element);aD(t,n);var u=rD(n,t.element);(r?function(){au(t.element,oD(n),i),hu(t.element)}:function(){uD(t,n)})(),qi(o,n.shrinkingClass),Gi(o,n.growingClass),aD(t,n),au(t.element,oD(n),u),e.setExpanded(),n.onStartGrow(t)},dD=function(t,n,e){var o=eD(t,n);return!0===Yi(o,n.growingClass)},mD=function(t,n,e){var o=eD(t,n);return!0===Yi(o,n.shrinkingClass)},gD=Object.freeze({__proto__:null,refresh:function(t,n,e){if(e.isExpanded()){pu(t.element,oD(n));var o=rD(n,t.element);au(t.element,oD(n),o)}},grow:function(t,n,e){e.isExpanded()||lD(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&fD(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&cD(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:dD,isShrinking:mD,isTransitioning:function(t,n,e){return dD(t,n)||mD(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?fD:lD)(t,n,e)},disableTransitions:iD}),pD=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return Ai(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:qe(n.dimension.property,"0px")})},events:function(t,n){return rr([gr(So(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(iD(e,t),n.isExpanded()&&pu(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),hD=[Mn("closedClass"),Mn("openClass"),Mn("shrinkingClass"),Mn("growingClass"),Ln("getAnimationRoot"),Ea("onShrunk"),Ea("onStartShrink"),Ea("onGrown"),Ea("onStartGrow"),Yn("expanded",!1),Fn("dimension",En("property",{width:[Ma("property","width"),Ma("getDimension",(function(t){return Lu(t)+"px"}))],height:[Ma("property","height"),Ma("getDimension",(function(t){return Fu(t)+"px"}))]}))],vD=kc({fields:hD,name:"sliding",active:pD,apis:gD,state:Object.freeze({__proto__:null,init:function(t){var n=oe(t.expanded);return Di({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:x(n.set,!1),setExpanded:x(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),bD="container",yD=[Tl("slotBehaviours",[])],xD=function(t){return"<alloy.field."+t+">"},wD=function(t,n){var e,o=function(n){return xd(t)},r=function(n,e){return function(o,r){return hd(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==ei(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){if(i(t)){var e=t.element;au(e,"display","none"),ni(e,"aria-hidden","true"),Zo(t,qo(),{name:n,visible:!1})}})),c=(e=a,function(t,n){G(n,(function(n){return e(t,n)}))}),s=r((function(t,n){if(!i(t)){var e=t.element;pu(e,"display"),ii(e,"aria-hidden"),Zo(t,qo(),{name:n,visible:!0})}})),f={getSlotNames:o,getSlot:function(n,e){return hd(n,t,e)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,o())},showSlot:s};return{uid:t.uid,dom:t.dom,components:n,behaviours:El(t.slotBehaviours),apis:f}},SD=Mt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},(function(t){return Ti(t)})),kD=_(_({},SD),{sketch:function(t){var n=function(){var t=[];return{slot:function(n,e){return t.push(n),ld(bD,xD(n),e)},record:v(t)}}(),e=t(n),o=n.record(),r=U(o,(function(t){return ed({name:t,pname:xD(t)})}));return _d(bD,yD,r,wD,e)}}),CD=an([Un("icon"),Un("tooltip"),te("onShow",p),te("onHide",p),te("onSetup",(function(){return p}))]),OD=function(t){return{element:function(){return t.element.dom}}},_D=function(t,n){var e=U(Dt(n),(function(t){var e=n[t],o=On(function(t){return Cn("sidebar",CD,t)}(e));return{name:t,getApi:OD,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return U(e,(function(n){var o=oe(p);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:ub([Qb(n,o),Zb(n,o),ar(qo(),(function(t,n){var o=n.event,r=J(e,(function(t){return t.name===o.name}));r.each((function(n){(o.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},TD=function(t){return kD.sketch((function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:_D(n,t),slotBehaviours:ub([pr((function(t){return kD.hideAllSlots(t)}))])}}))},ED=function(t){return Rd.getCurrent(t).bind((function(t){return vD.isGrowing(t)||vD.hasGrown(t)?Rd.getCurrent(t).bind((function(t){return J(kD.getSlotNames(t),(function(n){return kD.isShowing(t,n)}))})):R.none()}))},DD=di("FixSizeEvent"),BD=di("AutoSizeEvent"),AD=Object.freeze({__proto__:null,block:function(t,n,e,o){ni(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=wc([np.config({mode:"special",onTab:function(){return R.some(!0)},onShiftTab:function(){return R.some(!0)}}),mp.config({})]),u=o(r,i),a=r.getSystem().build(u);ap.append(r,Bu(a)),a.hasConfigured(np)&&n.focus&&np.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return ap.remove(r,a)}))},unblock:function(t,n,e){ii(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),MD=[te("getRoot",R.none),Zn("focus",!0),Ea("onBlock"),Ea("onUnblock")],FD=kc({fields:MD,name:"blocking",apis:AD,state:Object.freeze({__proto__:null,init:function(){var t=Jc((function(t){return t.destroy()}));return Di({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),ID=function(t){var n=ie.fromHtml(t),e=Mr(n),o=function(t){var n=void 0!==t.dom.attributes?t.dom.attributes:[];return K(n,(function(t,n){var e;return"class"===n.name?t:_(_({},t),((e={})[n.name]=n.value,e))}),{})}(n),r=function(t){return Array.prototype.slice.call(t.dom.classList,0)}(n),i=0===e.length?{}:{innerHtml:Qr(n)};return _({tag:xr(n),classes:r,attributes:o},i)},RD=function(t){return Rd.getCurrent(t).each((function(t){return Dc(t.element)}))},VD=function(t,n,e,o){var r=n.element;if(function(t,n){var e="tabindex",o="data-mce-tabindex";R.from(t.iframeElement).map(ie.fromDom).each((function(t){n?(oi(t,e).each((function(n){return ni(t,o,n)})),ni(t,e,-1)):(ii(t,e),oi(t,o).each((function(n){ni(t,e,n),ii(t,o)})))}))}(t,e),e)FD.block(n,function(t){return function(n,e){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:ID('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}}(o)),pu(r,"display"),ii(r,"aria-hidden"),t.hasFocus()&&RD(n);else{var i=Rd.getCurrent(n).exists((function(t){return Bc(t.element)}));FD.unblock(n),au(r,"display","none"),ni(r,"aria-hidden","true"),i&&t.focus()}},PD=function(t,n,e){var o=oe(!1),r=Qc(),i=function(e){var r;!o.get()||function(t){return"focusin"===t.type}(r=e)&&(r.composed?at(r.composedPath()):R.from(r.target)).map(ie.fromDom).filter(Sr).exists((function(t){return Yi(t,"mce-pastebin")}))||(e.preventDefault(),RD(n()),t.editorManager.setActive(t))};t.inline||t.on("PreInit",(function(){t.dom.bind(t.getWin(),"focusin",i),t.on("BeforeExecCommand",(function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&i(t)}))}));var u=function(r){r!==o.get()&&(o.set(r),VD(t,n(),r,e.providers),t.fire("AfterProgressState",{state:r}))};t.on("ProgressState",(function(n){if(r.on(hh.clearTimeout),m(n.time)){var e=hh.setEditorTimeout(t,(function(){return u(n.state)}),n.time);r.set(e)}else u(n.state),r.clear()}))},HD=function(t,n,e){return{within:t,extra:n,withinWidth:e}},zD=function(t,n,e){var o=function(t,n){var e=K(t,(function(t,e){return n(e,t.len).fold(v(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]});return e.list}(t,(function(t,n){var o=e(t);return R.some({element:t,start:n,finish:n+o,width:o})})),r=q(o,(function(t){return t.finish<=n})),i=Y(r,(function(t,n){return t+n.width}),0);return{within:r,extra:o.slice(r.length),withinWidth:i}},ND=function(t){return U(t,(function(t){return t.element}))},LD=function(t,n,e,o){var r=function(t,n,e){var o=zD(n,t,e);return 0===o.extra.length?R.some(o):R.none()}(t,n,e).getOrThunk((function(){return zD(n,t-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?function(t,n,e){var o=ND(t.concat(n));return HD(o,[],e)}(i,u,a):u.length>=1?function(t,n,e,o){var r=ND(t).concat([e]);return HD(r,ND(n),o)}(i,u,o,a):function(t,n,e){return HD(ND(t),[],e)}(i,0,a)},jD=function(t,n){var e=U(n,(function(t){return Bu(t)}));pE.setGroups(t,e)},WD=function(t,n,e){var o=n.builtGroups.get();if(0!==o.length){var r=vd(t,n,"primary"),i=Uw.getCoupled(t,"overflowGroup");au(r.element,"visibility","hidden");var u=o.concat([i]),a=ft(u,(function(t){return Mc(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}));e([]),jD(r,u);var c=Lu(r.element),s=LD(c,n.builtGroups.get(),(function(t){return Lu(t.element)}),i);0===s.extra.length?(ap.remove(r,i),e([])):(jD(r,s.within),e(s.extra)),pu(r.element,"visibility"),hu(r.element),a.each(mp.focus)}},UD=v([Tl("splitToolbarBehaviours",[Uw]),Bn("builtGroups",(function(){return oe([])}))]),GD=v([_a(["overflowToggledClass"]),Gn("getOverflowBounds"),Mn("lazySink"),Bn("overflowGroups",(function(){return oe([])}))].concat(UD())),XD=v([ed({factory:pE,schema:mE(),name:"primary"}),od({schema:mE(),name:"overflow"}),od({name:"overflow-button"}),od({name:"overflow-group"})]),qD=v((function(t,n){!function(t,n){var e=Nu.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);au(t,"max-width",e+"px")}(t,Math.floor(n))})),YD=v([_a(["toggledClass"]),Mn("lazySink"),Pn("fetch"),Gn("getBounds"),qn("fireDismissalEventInstead",[Yn("event",Uo())]),Cs()]),KD=v([od({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:wc([Op.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),od({factory:pE,schema:mE(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:wc([np.config({mode:"cyclic",onEscape:function(n){return hd(n,t,"button").each(mp.focus),R.none()}})])}}})]),JD=function(t,n){var e=Uw.getCoupled(t,"toolbarSandbox");ul.isOpen(e)?ul.close(e):ul.open(e,n.toolbar())},$D=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();Pf.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:qD()}}},r)},QD=function(t,n,e,o,r){pE.setGroups(n,r),$D(t,n,e,o),Op.on(t)},ZD=Ad({name:"FloatingToolbarButton",factory:function(t,n,e,o){return _(_({},vh.sketch(_(_({},o.button()),{action:function(t){JD(t,o)},buttonBehaviours:Al({dump:o.button().buttonBehaviours},[Uw.config({others:{toolbarSandbox:function(n){return function(t,n,e){var o=da();return{dom:{tag:"div",attributes:{id:o.id}},behaviours:wc([np.config({mode:"special",onEscape:function(t){return ul.close(t),R.some(!0)}}),ul.config({onOpen:function(r,i){e.fetch().get((function(r){QD(t,i,e,n.layouts,r),o.link(t.element),np.focusIn(i)}))},onClose:function(){Op.off(t),mp.focus(t),o.unlink(t.element)},isPartOf:function(n,e,o){return ga(e,o)||ga(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),Tc.config({channels:_(_({},ll(_({isExtraPart:k},e.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),ml({doReposition:function(){ul.getState(Uw.getCoupled(t,"toolbarSandbox")).each((function(o){$D(t,o,e,n.layouts)}))}}))})])}}(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){ul.getState(Uw.getCoupled(n,"toolbarSandbox")).each((function(r){QD(n,r,t,e.layouts,o)}))},reposition:function(n){ul.getState(Uw.getCoupled(n,"toolbarSandbox")).each((function(o){$D(n,o,t,e.layouts)}))},toggle:function(t){JD(t,o)},getToolbar:function(t){return ul.getState(Uw.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return ul.isOpen(Uw.getCoupled(t,"toolbarSandbox"))}}})},configFields:YD(),partFields:KD(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),tB=v([Mn("items"),_a(["itemSelector"]),Tl("tgroupBehaviours",[np])]),nB=v([id({name:"items",unit:"item"})]),eB=Ad({name:"ToolbarGroup",configFields:tB(),partFields:nB(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.tgroupBehaviours,[np.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),oB=function(t){return U(t,(function(t){return Bu(t)}))},rB=function(t,n,e){WD(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){ZD.setGroups(t,oB(o))}))}))},iB=Ad({name:"SplitFloatingToolbar",configFields:GD(),partFields:XD(),factory:function(t,n,e,o){var r=bh(ZD.sketch({fetch:function(){return Dw((function(n){n(oB(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[ec,nc]},onRtl:function(){return[nc,ec]},onBottomLtr:function(){return[rc,oc]},onBottomRtl:function(){return[oc,rc]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.splitToolbarBehaviours,[Uw.config({others:{overflowGroup:function(){return eB.sketch(_(_({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(U(e,n.getSystem().build)),rB(n,r,t)},refresh:function(n){return rB(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){ZD.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(ZD.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){ZD.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(ZD.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),uB=v([_a(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ea("onOpened"),Ea("onClosed")].concat(UD())),aB=v([ed({factory:pE,schema:mE(),name:"primary"}),ed({factory:pE,schema:mE(),name:"overflow",overrides:function(t){return{toolbarBehaviours:wc([vD.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){hd(n,t,"overflow-button").each((function(t){Op.off(t),mp.focus(t)})),t.onClosed(n)},onGrown:function(n){np.focusIn(n),t.onOpened(n)},onStartGrow:function(n){hd(n,t,"overflow-button").each(Op.on)}}),np.config({mode:"acyclic",onEscape:function(n){return hd(n,t,"overflow-button").each(mp.focus),R.some(!0)}})])}}}),od({name:"overflow-button",overrides:function(t){return{buttonBehaviours:wc([Op.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),od({name:"overflow-group"})]),cB=function(t,n){hd(t,n,"overflow-button").bind((function(){return hd(t,n,"overflow")})).each((function(e){sB(t,n),vD.toggleGrow(e)}))},sB=function(t,n){hd(t,n,"overflow").each((function(e){WD(t,n,(function(t){var n=U(t,(function(t){return Bu(t)}));pE.setGroups(e,n)})),hd(t,n,"overflow-button").each((function(t){vD.hasGrown(e)&&Op.on(t)})),vD.refresh(e)}))},fB=Ad({name:"SplitSlidingToolbar",configFields:uB(),partFields:aB(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.splitToolbarBehaviours,[Uw.config({others:{overflowGroup:function(t){return eB.sketch(_(_({},o["overflow-group"]()),{items:[vh.sketch(_(_({},o["overflow-button"]()),{action:function(n){Qo(t,r)}}))]}))}}}),cp("toolbar-toggle-events",[ar(r,(function(n){cB(n,t)}))])]),apis:{setGroups:function(n,e){!function(n,e){var o=U(e,n.getSystem().build);t.builtGroups.set(o)}(n,e),sB(n,t)},refresh:function(n){return sB(n,t)},toggle:function(n){return cB(n,t)},isOpen:function(n){return function(t,n){return hd(t,n,"overflow").map(vD.hasGrown).getOr(!1)}(n,t)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),lB=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:_({tag:"div",classes:["tox-toolbar__group"]},n),components:[eB.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:wc([tw.config({}),mp.config({})])}},dB=function(t){return eB.sketch(lB(t))},mB=function(t,n){var e=pr((function(n){var e=U(t.initGroups,dB);pE.setGroups(n,e)}));return wc([Jb(t.providers.isDisabled),Xb(),np.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),cp("toolbar-events",[e])])},gB=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":lB({title:R.none(),items:[]}),"overflow-button":qO({name:"more",icon:R.some("more-drawer"),disabled:!1,tooltip:R.some("More..."),primary:!1,borderless:!1},R.none(),t.providers)},splitToolbarBehaviours:mB(t,n)}},pB=function(t){var n=gB(t),e=iB.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return iB.sketch(_(_({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=na(n),o=Er(n),r=na(o),i=Math.max(o.dom.scrollHeight,r.height);return Zu(e.x+4,r.y,e.width-8,i)},parts:_(_({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},hB=function(t){var n=fB.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=fB.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=gB(t);return fB.sketch(_(_({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([NE()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([NE()],{type:"closed"})}}))},vB=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return pE.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===pv.scrolling?["tox-toolbar--scrolling"]:[])},components:[pE.parts.groups({})],toolbarBehaviours:mB(t,n)})},bB=aE.optional({factory:nD,name:"menubar",schema:[Mn("backstage")]}),yB=aE.optional({factory:{sketch:function(t){return dE.sketch({uid:t.uid,dom:t.dom,listBehaviours:wc([np.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return vB({type:t.type,uid:di("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),R.some(!0)}})},setupItem:function(t,n,e,o){pE.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Mn("dom"),Mn("onEscape")]}),xB=aE.optional({factory:{sketch:function(t){var n=function(t){return t.type===pv.sliding?hB:t.type===pv.floating?pB:vB}(t);return n({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),R.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Mn("dom"),Mn("onEscape"),Mn("getSink")]}),wB=aE.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?YE:bE;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:wc(e(n,t.sharedBackstage))}}},name:"header",schema:[Mn("dom")]}),SB=aE.optional({name:"socket",schema:[Mn("dom")]}),kB=aE.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:wc([tw.config({}),mp.config({}),vD.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Rd.getCurrent(t).each(kD.hideAllSlots),Qo(t,BD)},onGrown:function(t){Qo(t,BD)},onStartGrow:function(t){Zo(t,DD,{width:du(t.element,"width").getOr("")})},onStartShrink:function(t){Zo(t,DD,{width:Lu(t.element)+"px"})}}),ap.config({}),Rd.config({find:function(t){var n=ap.contents(t);return at(n)}})])}],behaviours:wc([bC(0),cp("sidebar-sliding-events",[ar(DD,(function(t,n){au(t.element,"width",n.event.width)})),ar(BD,(function(t,n){pu(t.element,"width")}))])])}}},name:"sidebar",schema:[Mn("dom")]}),CB=aE.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:wc([ap.config({}),FD.config({focus:!1}),Rd.config({find:function(t){return at(t.components())}})]),components:[]}}},name:"throbber",schema:[Mn("dom")]}),OB=Ad({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return uE.getPart(n,t,"socket")},setSidebar:function(n,e){uE.getPart(n,t,"sidebar").each((function(t){return function(t,n){Rd.getCurrent(t).each((function(t){return ap.set(t,[TD(n)])}))}(t,e)}))},toggleSidebar:function(n,e){uE.getPart(n,t,"sidebar").each((function(t){return function(t,n){Rd.getCurrent(t).each((function(t){Rd.getCurrent(t).each((function(e){vD.hasGrown(t)?kD.isShowing(e,n)?vD.shrink(t):(kD.hideAllSlots(e),kD.showSlot(e,n)):(kD.hideAllSlots(e),kD.showSlot(e,n),vD.grow(t))}))}))}(t,e)}))},whichSidebar:function(n){return uE.getPart(n,t,"sidebar").bind(ED).getOrNull()},getHeader:function(n){return uE.getPart(n,t,"header")},getToolbar:function(n){return uE.getPart(n,t,"toolbar")},setToolbar:function(n,e){uE.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){uE.getPart(n,t,"multiple-toolbar").each((function(t){dE.setItems(t,e)}))},refreshToolbar:function(n){uE.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){uE.getPart(n,t,"toolbar").each((function(t){var n,e;n=t.getApis().toggle,e=function(n){return n(t)},null!=n?R.some(e(n)):R.none()}))},isToolbarDrawerToggled:function(n){return uE.getPart(n,t,"toolbar").bind((function(t){return R.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return uE.getPart(n,t,"throbber")},focusToolbar:function(n){uE.getPart(n,t,"toolbar").orThunk((function(){return uE.getPart(n,t,"multiple-toolbar")})).each((function(t){np.focusIn(t)}))},setMenubar:function(n,e){uE.getPart(n,t,"menubar").each((function(t){nD.setMenus(t,e)}))},focusMenubar:function(n){uE.getPart(n,t,"menubar").each((function(t){nD.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Mn("dom"),Mn("behaviours")],partFields:[wB,bB,xB,yB,SB,kB,CB],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=U(e,(function(t){return dB(t)}));t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=U(e,(function(t){return U(t,dB)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),_B={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},TB=function(t){return"string"==typeof t?t.split(" "):t},EB=function(t,n){var e=_(_({},_B),n.menus),o=Dt(n.menus).length>0,r=void 0===n.menubar||!0===n.menubar?TB("file edit view insert format tools table help"):TB(!1===n.menubar?"":n.menubar),i=q(r,(function(t){var e=zt(_B,t);return o?e||Ht(n.menus,t).exists((function(t){return zt(t,"items")})):e})),u=U(i,(function(o){var r=e[o];return function(t,n,e){var o=function(t){return t.getParam("removed_menuitems","")}(e).split(/[ ,]/);return{text:t.title,getItems:function(){return Z(t.items,(function(t){var e=t.toLowerCase();return 0===e.trim().length||L(o,(function(t){return t===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]}))}}}({title:r.title,items:TB(r.items)},n,t)}));return q(u,(function(t){return t.getItems().length>0&&L(t.getItems(),(function(t){return"separator"!==t.type}))}))},DB=function(t){var n=function(){t._skinLoaded=!0,function(t){t.fire("SkinLoaded")}(t)};return function(){t.initialized?n():t.on("init",n)}},BB=function(t,n,e){return new Uh((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},AB=function(t,n){return BB(t,n+"/skin.min.css",t.ui.styleSheetLoader)},MB=function(t,n){var e;return(e=ie.fromDom(t.getElement()),Lr(e).isSome())?BB(t,n+"/skin.shadowdom.min.css",pb.DOM.styleSheetLoader):Uh.resolve()},FB=function(t,n){var e=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url");if(!1!==n){var o=n||"oxide";e=e?t.documentBaseURI.toAbsolute(e):hb.baseURL+"/skins/ui/"+o}return e}(n);e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1===function(t){return!1===t.getParam("skin")}(n)&&r(e)?Uh.all([AB(n,e),MB(n,e)]).then(DB(n),function(t,n){return function(){return function(t,n){return t.fire("SkinLoadError",n)}(t,{message:n})}}(n,"Skin could not be loaded")):DB(n)()},IB=x(FB,!1),RB=x(FB,!0),VB=function(t,n){return function(e){var o=$c(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.once("init",r),function(){t.off("init",r),o.clear()}}},PB=function(t,n,e){return function(o){var r=function(){return e(o)},i=function(){e(o),t.on(n,r)};return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}},HB=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},zB=function(t,n){return function(){return t.execCommand(n)}},NB=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return R.some({type:"separator",text:a});if("submenu"===t.type){var c=Z(t.getStyleItems(),(function(t){return r(t,o,u)}));return 0===o&&c.length<=0?R.none():R.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return Z(t.getStyleItems(),(function(t){return r(t,o,u)}))}})}return R.some(_({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1;return Z(t,(function(t){return r(t,o,n)}))};return{validateItems:i,getFetch:function(t,n){return function(e,o){var r=n(),u=i(r);o(jO(u,hv.CLOSE_ON_EXECUTE,t,!1))}}}},LB=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return U(o.data,(function(t){return DT(t,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:NB(0,n,e),getStyleItems:r}},jB=function(t,n,e){var o=LB(0,n,e),r=o.items,i=o.getStyleItems,u=PB(t,"NodeChange",(function(t){var n=t.getComponent();e.updateText(n)}));return VO({text:e.icon.isSome()?R.none():e.text,icon:e.icon,tooltip:R.from(e.tooltip),role:R.none(),fetch:r.getFetch(n,i),onSetup:u,getApi:function(t){return{getComponent:v(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};!function(t){t[t.SemiColon=0]="SemiColon",t[t.Space=1]="Space"}(__||(__={}));var WB,UB,GB,XB,qB,YB=function(t,n,e,o){var r=function(t){return U(t,(function(t){var n=t,e=t,o=t.split("=");return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}}))}(function(t,n){return n===__.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")}(t.getParam(n,e,"string"),o));return{type:"basic",data:r}},KB=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],JB=function(t){var n={type:"basic",data:KB};return{tooltip:"Align",text:R.none(),icon:R.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:R.none,getPreviewFor:function(t){return R.none},onAction:function(n){return function(){return J(KB,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},updateText:function(n){var e=J(KB,(function(n){return t.formatter.match(n.format)})),o=e.fold(v("left"),(function(t){return t.title.toLowerCase()}));Zo(n,RO,{icon:"align-"+o})},dataset:n,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},$B=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],QB=function(t){var n=t.split(/\s*,\s*/);return U(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},ZB=function(t){var n="System Font",e=function(){var e=function(t){return t?QB(t)[0]:""},r=t.queryCommandValue("FontName"),i=o.data,u=r?r.toLowerCase():"",a=J(i,(function(t){var n=t.format;return n.toLowerCase()===u||e(n).toLowerCase()===e(u).toLowerCase()})).orThunk((function(){return tu(function(t){var n;return 0===t.indexOf("-apple-system")&&(n=QB(t.toLowerCase()),tt($B,(function(t){return n.indexOf(t.toLowerCase())>-1})))}(u),{title:n,format:u})}));return{matchOpt:a,font:r}},o=YB(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",__.SemiColon);return{tooltip:"Fonts",text:R.some(n),icon:R.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return e().matchOpt},getPreviewFor:function(t){return function(){return R.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},updateText:function(t){var n=e(),o=n.matchOpt,r=n.font,i=o.fold(v(r),(function(t){return t.title}));Zo(t,IO,{text:i})},dataset:o,shouldHide:!1,isInvalid:k}},tA={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},nA={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},eA=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e}(72*parseInt(t,10)/96,n||0)+"pt":Ht(nA,t).getOr(t)},oA=function(t){var n=function(){var n=R.none(),e=o.data,r=t.queryCommandValue("FontSize");if(r)for(var i=function(t){var o=eA(r,t),i=function(t){return Ht(tA,t).getOr("")}(o);n=J(e,(function(t){return t.format===r||t.format===o||t.format===i}))},u=3;n.isNone()&&u>=0;u--)i(u);return{matchOpt:n,size:r}},e=v(R.none),o=YB(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",__.Space);return{tooltip:"Font sizes",text:R.some("12pt"),icon:R.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(v(r),(function(t){return t.title}));Zo(t,IO,{text:i})},dataset:o,shouldHide:!1,isInvalid:k}},rA=function(t,n){var e=n(),o=U(e,(function(t){return t.format}));return R.from(t.formatter.closest(o)).bind((function(t){return J(e,(function(n){return n.format===t}))})).orThunk((function(){return tu(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},iA=function(t){var n="Paragraph",e=YB(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",__.SemiColon);return{tooltip:"Blocks",text:R.some(n),icon:R.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:R.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return R.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:HB(t),updateText:function(o){var r=rA(t,(function(){return e.data})).fold(v(n),(function(t){return t.title}));Zo(o,IO,{text:r})},dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},uA=function(t,n){var e="Paragraph";return{tooltip:"Formats",text:R.some(e),icon:R.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:R.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?R.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):R.none()}},onAction:HB(t),updateText:function(n){var o=function(t){var n=t.items;return void 0!==n&&n.length>0?Z(n,o):[{title:t.title,format:t.format}]},r=Z(ET(t),o),i=rA(t,v(r)).fold(v(e),(function(t){return t.title}));Zo(n,IO,{text:i})},shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},aA=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=U(r,e.getSystem().build);Lf(e,i)}))};return rr([ar(Bo(),(function(n,o){var r=o;if(!r.universal){var i=t.channel;N(r.channels,i)&&e(n,r.data)}})),pr((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),cA=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),sA=[Mn("channel"),Ln("renderComponents"),Ln("updateState"),Ln("initialData")],fA=Object.freeze({__proto__:null,init:function(){var t=oe(R.none());return{readState:function(){return t.get().getOr("none")},get:t.get,set:t.set,clear:function(){return t.set(R.none())}}}}),lA=kc({fields:sA,name:"reflecting",active:aA,apis:cA,state:fA}),dA=v([Mn("toggleClass"),Mn("fetch"),Ba("onExecute"),Yn("getHotspot",R.some),Yn("getAnchorOverrides",v({})),Cs(),Ba("onItemExecute"),Ln("lazySink"),Mn("dom"),Ea("onOpen"),Tl("splitDropdownBehaviours",[Uw,np,mp]),Yn("matchWidth",!1),Yn("useMinWidth",!1),Yn("eventOrder",{}),Ln("role")].concat(iS())),mA=ed({factory:vh,schema:[Mn("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:wc([mp.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(tr)},buttonBehaviours:wc([Op.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),gA=ed({factory:vh,schema:[Mn("dom")],name:"button",defaults:function(){return{buttonBehaviours:wc([mp.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),pA=v([mA,gA,rd({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Mn("text")],name:"aria-descriptor"}),od({schema:[Oa()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),Xw()]),hA=Ad({name:"SplitDropdown",configFields:dA(),partFields:pA(),factory:function(t,n,e,o){var r,i=function(t){Rd.getCurrent(t).each((function(t){um.highlightFirst(t),np.focusIn(t)}))},u=function(n){Zw(t,b,n,o,i,kw.HighlightFirst).get(p)},a=function(n){var e=vd(n,t,"button");return tr(e),R.some(!0)},c=_(_({},rr([pr((function(n,e){hd(n,t,"aria-descriptor").each((function(t){var e=di("aria");ni(t.element,"id",e),ni(n.element,"aria-describedby",e)}))}))])),Tp(R.some(u))),s={repositionMenus:function(t){Op.isOn(t)&&rS(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:s,eventOrder:_(_({},t.eventOrder),(r={},r[Ao()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:Dl(t.splitDropdownBehaviours,[Uw.config({others:{sandbox:function(n){var e=vd(n,t,"arrow");return oS(t,n,{onOpen:function(){Op.on(e),Op.on(n)},onClose:function(){Op.off(e),Op.off(n)}})}}}),np.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),R.some(!0)}}),mp.config({}),Op.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),vA=function(t){return{isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)}}},bA=function(t){return{setActive:function(n){Op.set(t,n)},isActive:function(){return Op.isOn(t)},isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)}}},yA=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},xA=di("focus-button"),wA=function(t,n,e,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:yA(e,i)},components:ey([t.map((function(t){return DO(t,i.icons)})),n.map((function(t){return AO(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[co()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:wc([Jb(i.isDisabled),Xb(),cp("common-button-display-events",[ar(co(),(function(t,n){n.event.prevent(),Qo(t,xA)}))])].concat(o.map((function(e){return lA.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return ey([t.icon.map((function(t){return DO(t,i.icons)})),t.text.map((function(t){return AO(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},SA=function(t,n,e){var o,r=oe(p),i=wA(t.icon,t.text,t.tooltip,R.none(),R.none(),e);return vh.sketch({dom:i.dom,components:i.components,eventOrder:FO,buttonBehaviours:wc([cp("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},br((function(t,n){$b(o,t)((function(n){Zo(t,MO,{buttonApi:n}),o.onAction(n)}))}))),Qb(n,r),Zb(n,r)]),Jb((function(){return t.disabled||e.isDisabled()})),Xb()].concat(n.toolbarButtonBehaviours))})},kA=function(t,n,e){return SA(t,{toolbarButtonBehaviours:[].concat(e.length>0?[cp("toolbarButtonWith",e)]:[]),getApi:vA,onSetup:t.onSetup},n)},CA=function(t,n,e){return jt(SA(t,{toolbarButtonBehaviours:[ap.config({}),Op.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[cp("toolbarToggleButtonWith",e)]:[]),getApi:bA,onSetup:t.onSetup},n))},OA=function(t,n,e){return function(o){return Dw((function(t){return n.fetch(t)})).map((function(r){return R.from(Bx(jt(fx(di("menu-value"),r,(function(e){n.onItemAction(t(o),e)}),n.columns,n.presets,hv.CLOSE_ON_EXECUTE,n.select.getOr(k),e),{movement:dx(n.columns,n.presets),menuBehaviours:ub("auto"!==n.columns?[]:[pr((function(t,e){rb(t,4,Ev(n.presets)).each((function(n){var e=n.numRows,o=n.numColumns;np.setGridSize(t,e,o)}))}))])})))}))}},_A=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],TA=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return Tn(t)})).getOrDie();return n(i,o,r)}},EA={button:TA(ev,(function(t,n){return e=t,o=n.backstage.shared.providers,kA(e,o,[]);var e,o})),togglebutton:TA(iv,(function(t,n){return e=t,o=n.backstage.shared.providers,CA(e,o,[]);var e,o})),menubutton:TA(ZE,(function(t,n){return UO(t,"tox-tbtn",n.backstage,R.none())})),splitbutton:TA((function(t){return Cn("SplitButton",tD,t)}),(function(t,n){return function(t,n){var e,o=di("channel-update-split-dropdown-display"),r=function(t){return{isDisabled:function(){return Kd.isDisabled(t)},setDisabled:function(n){return Kd.set(t,n)},setIconFill:function(n,e){fa(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){ni(t,"fill",e)}))},setIconStroke:function(n,e){fa(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){ni(t,"stroke",e)}))},setActive:function(n){ni(t.element,"aria-pressed",n),fa(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Op.set(t,n)}))}))},isActive:function(){return fa(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(Op.isOn)}))}}},i=oe(p),u={getApi:r,onSetup:t.onSetup};return hA.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:_({"aria-pressed":!1},yA(t.tooltip,n.providers))},onExecute:function(n){t.onAction(r(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:wc([Kb(n.providers.isDisabled),Xb(),cp("split-dropdown-events",[ar(xA,mp.focus),Qb(u,i),Zb(u,i)]),fS.config({})]),eventOrder:(e={},e[jo()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:OA(r,t,n.providers),parts:{menu:Iv(0,t.columns,t.presets)},components:[hA.parts.button(wA(t.icon,t.text,R.none(),R.some(o),R.some([Op.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),hA.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Oh("chevron-down",n.providers.icons)},buttonBehaviours:wc([Kb(n.providers.isDisabled),Xb(),_h()])}),hA.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})}(t,n.backstage.shared)})),grouptoolbarbutton:TA((function(t){return Cn("GroupToolbarButton",JE,t)}),(function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[Ss]=n.backstage.shared.header.isPositionedAtTop()?jc.TopToBottom:jc.BottomToTop,o);if(Eb(e)===pv.floating)return function(t,n,e,o){var r=n.shared;return ZD.sketch({lazySink:r.getSink,fetch:function(){return Dw((function(n){n(U(e(t.items),dB))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:wA(t.icon,t.text,t.tooltip,R.none(),R.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(t,n.backstage,(function(t){return MA(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,R.none())}),i);throw new Error("Toolbar groups are only supported when using floating toolbar mode")})),styleSelectButton:function(t,n){return function(t,n){var e=_({type:"advanced"},n.styleselect);return jB(t,n,uA(t,e))}(t,n.backstage)},fontsizeSelectButton:function(t,n){return function(t,n){return jB(t,n,oA(t))}(t,n.backstage)},fontSelectButton:function(t,n){return function(t,n){return jB(t,n,ZB(t))}(t,n.backstage)},formatButton:function(t,n){return function(t,n){return jB(t,n,iA(t))}(t,n.backstage)},alignMenuButton:function(t,n){return function(t,n){return jB(t,n,JB(t))}(t,n.backstage)}},DA={styleselect:EA.styleSelectButton,fontsizeselect:EA.fontsizeSelectButton,fontselect:EA.fontSelectButton,formatselect:EA.formatButton,align:EA.alignMenuButton},BA=function(t){var n,e=t.toolbar,o=t.buttons;return!1===e?[]:void 0===e||!0===e?function(t){var n=U(_A,(function(n){var e=q(n.items,(function(n){return zt(t,n)||zt(DA,n)}));return{name:n.name,items:e}}));return q(n,(function(t){return t.items.length>0}))}(o):r(e)?(n=e.split("|"),U(n,(function(t){return{items:t.trim().split(" ")}}))):function(t){return g(t,(function(t){return zt(t,"name")&&zt(t,"items")}))}(e)?e:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},AA=function(t,n,e,o,r,i){return Ht(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return ft(t,(function(t){return Ht(n,t+e.toLowerCase())}))}))})).fold((function(){return Ht(DA,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return R.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?function(t,n,e){return Ht(EA,t.type).fold((function(){return console.error("skipping button defined by",t),R.none()}),(function(o){return R.some(o(t,n,e))}))}(n,r,t):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),R.none())}))},MA=function(t,n,e,o){var r=BA(n),i=U(r,(function(r){var i=Z(r.items,(function(r){return 0===r.trim().length?[]:AA(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}));return{title:R.from(t.translate(r.name)),items:i}}));return q(i,(function(t){return t.items.length>0}))},FA=function(t,n,e,o){var i=n.outerContainer,u=e.toolbar,a=e.buttons;if(g(u,r)){var c=u.map((function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return MA(t,r,{backstage:o},R.none())}));OB.setToolbars(i,c)}else OB.setToolbar(i,MA(t,e,{backstage:o},R.none()))},IA=ze(),RA=IA.os.isiOS()&&IA.os.version.major<=12,VA=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=oe(0),u=n.outerContainer;IB(t);var c=ie.fromDom(r.targetNode),s=Nr(zr(c));!function(t,n){Yf(t,n,Gr)}(c,n.mothership),qf(s,n.uiMothership),t.on("PostRender",(function(){FA(t,n,e,o),i.set(t.getWin().innerWidth),OB.setMenubar(u,EB(t,e)),OB.setSidebar(u,e.sidebar),function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=oe(Vu(o.innerWidth,o.innerHeight)),u=oe(Vu(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(Vu(o.innerWidth,o.innerHeight)),Ly(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(Vu(n.offsetWidth,n.offsetHeight)),Ly(t))},s=function(n){return function(t,n){return t.fire("ScrollContent",n)}(t,n)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=ns(ie.fromDom(t.getBody()),"load",c),l=n.uiMothership.element;t.on("hide",(function(){au(l,"display","none")})),t.on("show",(function(){pu(l,"display")})),t.on("NodeChange",c),t.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))}(t,n)}));var f,l,d,m=OB.getSocket(u).getOrDie("Could not find expected socket element");if(RA){cu(m.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var g=(f=function(){t.fire("ScrollContent")},l=20,d=null,{cancel:function(){a(d)||(clearTimeout(d),d=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];a(d)&&(d=setTimeout((function(){d=null,f.apply(null,t)}),l))}}),p=ts(m.element,"scroll",g.throttle);t.on("remove",p.unbind)}Gb(t,n),t.addCommand("ToggleSidebar",(function(n,e){OB.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return OB.whichSidebar(u)}));var h=Eb(t);h!==pv.sliding&&h!==pv.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(OB.refreshToolbar(n.outerContainer),i.set(e))}));var v={enable:function(){Ub(n,!1)},disable:function(){Ub(n,!0)},isDisabled:function(){return Kd.isDisabled(u)}};return{iframeContainer:m.element.dom,editorContainer:u.element.dom,api:v}}}),PA=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?R.some(parseInt(""+t,10)):R.none()},HA=function(t){return m(t)?t+"px":t},zA=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return t>n}));return o.or(r).getOr(t)},NA=function(t){var n=function(t){var n=vb(t),e=xb(t),o=Sb(t);return PA(n).map((function(t){return zA(t,e,o)}))}(t);return n.getOr(vb(t))},LA=function(t){var n=bb(t),e=yb(t),o=wb(t);return PA(n).map((function(t){return zA(t,e,o)}))},jA=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=pb.DOM,c=Ib(t),s=Pb(t),f=wb(t).or(LA(t)),l=o.shared.header,d=l.isPositionedAtTop,m=Eb(t),g=m===pv.sliding||m===pv.floating,p=oe(!1),h=function(){return p.get()&&!t.removed},b=function(t){return g?t.fold(v(0),(function(t){return t.components().length>1?Fu(t.components()[1].element):0})):0},y=function(){i.broadcastOn([cl()],{})},x=function(t){if(void 0===t&&(t=!1),h()){var e;if(c||(e=f.getOrThunk((function(){var t=PA(fu(ou(),"margin-left")).getOr(0);return Lu(ou())-Hu(n).left+t})),au(r.get().element,"max-width",e+"px")),g&&OB.refreshToolbar(u),c||function(){var t=OB.getToolbar(u),e=b(t),o=ta(n),i=d()?Math.max(o.y-Fu(r.get().element)+e,0):o.bottom;cu(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})}(),s){var o=r.get();t?zE.reset(o):zE.refresh(o)}y()}},w=function(e){if(void 0===e&&(e=!0),!c&&s&&h()){var o=l.getDockingMode(),i=function(e){switch(Ab(t)){case Tb.auto:var o=OB.getToolbar(u),r=b(o),i=Fu(e.element)-r,a=ta(n);if(a.y>i)return"top";var c=Er(n),s=Math.max(c.dom.scrollHeight,Fu(c));return a.bottom<s-i||ea().bottom<a.bottom-i?"bottom":"top";case Tb.bottom:return"bottom";case Tb.top:default:return"top"}}(r.get());i!==o&&(!function(t){var n=r.get();zE.setModes(n,[t]),l.setDockingMode(t);var e=d()?jc.TopToBottom:jc.BottomToTop;ni(n.element,Ss,e)}(i),e&&x(!0))}};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),au(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),pu(i.element,"display"),w(!1),x()},hide:function(){p.set(!1),e.outerContainer&&(au(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),au(i.element,"display","none")},update:x,updateMode:w,repositionPopups:y}},WA=function(t,n){var e=ta(t);return{pos:n?e.y:e.bottom,bounds:e}},UA=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=oe(null),s=ie.fromDom(r.targetNode),f=jA(t,s,n,o,c),l=function(t){return t.getParam("toolbar_persist",!1,"boolean")}(t);RB(t);var d=function(){if(c.get())f.show();else{c.set(OB.getHeader(a).getOrDie());var r=Rb(t);qf(r,i),qf(r,u),FA(t,n,e,o),OB.setMenubar(a,EB(t,e)),f.show(),function(t,n,e,o){var r=oe(WA(n,e.isPositionedAtTop())),i=function(o){var i=WA(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&Ly(t,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){hh.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=$c();u.set(ns(ie.fromDom(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,f,l),t.nodeChanged()}},m=function(){return hh.setEditorTimeout(t,d,0)};t.on("show",d),t.on("hide",f.hide),l||(t.on("focus",m),t.on("blur",f.hide)),t.on("init",(function(){(t.hasFocus()||l)&&m()})),Gb(t,n);var g={show:function(){f.show()},hide:function(){f.hide()},enable:function(){Ub(n,!1)},disable:function(){Ub(n,!0)},isDisabled:function(){return Kd.isDisabled(a)}};return{editorContainer:a.element.dom,api:g}}}),GA="contexttoolbar-hide",XA=function(t,n){return ar(MO,(function(e,o){var r=function(t){return{hide:function(){return Qo(t,Ro())},getValue:function(){return _l.getValue(t)}}}(t.get(e));n.onAction(r,o.event.buttonApi)}))},qA=function(t,n,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?function(t,n,e){var o=n.original;o.primary;var r=T(o,["primary"]),i=On(iv(_(_({},r),{type:"togglebutton",onAction:p})));return CA(i,e.backstage.shared.providers,[XA(t,n)])}(t,n,o):function(t,n,e){var o=n.original;o.primary;var r=T(o,["primary"]),i=On(ev(_(_({},r),{type:"button",onAction:p})));return kA(i,e.backstage.shared.providers,[XA(t,n)])}(t,n,o)},YA=function(t,n){var e=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=bh(xw.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:wc([np.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map((function(t){return tr(t),!0}))},onLeft:function(t,n){return n.cut(),R.none()},onRight:function(t,n){return n.cut(),R.none()}})])})),r=function(t,n,e){var o=U(n,(function(n){return bh(qA(t,n,e))}));return{asSpecs:function(){return U(o,(function(t){return t.asSpec()}))},findPrimary:function(t){return ft(n,(function(n,e){return n.primary?R.from(o[e]).bind((function(n){return n.getOpt(t)})).filter(w(Kd.isDisabled)):R.none()}))}}}(o,t.commands,n);return[{title:R.none(),items:[o.asSpec()]},{title:R.none(),items:r.asSpecs()}]},KA=YA,JA=function(t,n,e){return void 0===e&&(e=.01),n.bottom-t.y>=e&&t.bottom-n.y>=e},$A=function(t){var n=function(t){var n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){var e=Rr(ie.fromDom(t.startContainer),t.startOffset).element;return(kr(e)?Br(e):R.some(e)).filter(Sr).map((function(t){return t.dom.getBoundingClientRect()})).getOr(n)}return n}(t.selection.getRng());if(t.inline){var e=Xu();return Zu(e.left+n.left,e.top+n.top,n.width,n.height)}var o=na(ie.fromDom(t.getBody()));return Zu(o.x+n.left,o.y+n.top,n.width,n.height)},QA=function(t,n,e,o){void 0===o&&(o=0);var r=Ku(window),i=ta(ie.fromDom(t.getContentAreaContainer())),u=kb(t)||Cb(t)||_b(t),a=function(t,n,e){var o=Math.max(t.x+e,n.x);return{x:o,width:Math.min(t.right-e,n.right)-o}}(i,r,o),c=a.x,s=a.width;if(t.inline&&!u)return Zu(c,r.y,s,r.height);var f=function(t,n,e,o,r,i){var u=ie.fromDom(t.getContainer()),a=fa(u,".tox-editor-header").getOr(u),c=ta(a),s=c.y>=n.bottom,f=o&&!s;if(t.inline&&f)return{y:Math.max(c.bottom+i,e.y),bottom:e.bottom};if(t.inline&&!f)return{y:e.y,bottom:Math.min(c.y-i,e.bottom)};var l="line"===r?ta(u):n;return f?{y:Math.max(c.bottom+i,e.y),bottom:Math.min(l.bottom-i,e.bottom)}:{y:Math.max(l.y+i,e.y),bottom:Math.min(c.y-i,e.bottom)}}(t,i,r,n.header.isPositionedAtTop(),e,o),l=f.y,d=f.bottom;return Zu(c,l,s,d-l)},ZA={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},tM={maxHeightFunction:ms(),maxWidthFunction:qD()},nM=function(t){return"node"===t},eM=function(t,n,e,o,r){var i=$A(t),u=o.lastElement().exists((function(t){return je(e,t)}));return function(t,n){var e=t.selection.getRng(),o=Rr(ie.fromDom(e.startContainer),e.startOffset);return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&je(o.element,n)}(t,e)?u?mh:ch:u?function(t,n,e){var o=du(t,"position");au(t,"position",n);var r=e(t);return o.each((function(n){return au(t,"position",n)})),r}(n,o.getMode(),(function(){return JA(i,ta(n))&&!o.isReposition()?ph:mh})):("fixed"===o.getMode()?r.y+Xu().top:r.y)+(Fu(n)+12)<=i.y?ch:sh},oM=function(t,n,e,o){var r=function(n){return function(o,r,i,u,a){var c=eM(t,u,n,e,a),s=_(_({},o),{y:a.y,height:a.height});return _(_({},c(s,r,i,u,a)),{alwaysFit:!0})}},i=function(t){return nM(o)?[r(t)]:[]};return n?{onLtr:function(t){return[uc,nc,ec,oc,rc,ic].concat(i(t))},onRtl:function(t){return[uc,ec,nc,rc,oc,ic].concat(i(t))}}:{onLtr:function(t){return[ic,uc,oc,nc,rc,ec].concat(i(t))},onRtl:function(t){return[ic,uc,rc,ec,oc,nc].concat(i(t))}}},rM=function(t,n){var e=q(n,(function(n){return n.predicate(t.dom)})),o=X(e,(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:o.pass,contextForms:o.fail}},iM=function(t,n,e){var o=rM(t,n);if(o.contextForms.length>0)return R.some({elem:t,toolbars:[o.contextForms[0]]});var r=rM(t,e);if(r.contextForms.length>0)return R.some({elem:t,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=function(t){if(t.length<=1)return t;var n=function(n){return L(t,(function(t){return t.position===n}))},e=function(n){return q(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=U(e("selection"),(function(t){return _(_({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return R.some({elem:t,toolbars:i})}return R.none()},uM=function(t,n,e){return t(n)?R.none():$e(n,(function(t){if(Sr(t)){var n=rM(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=r.length>0?r:function(t){if(t.length<=1)return t;var n=function(n){return J(t,(function(t){return t.position===n}))},e=n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position}));return e.fold((function(){return[]}),(function(n){return q(t,(function(t){return t.position===n}))}))}(o);return i.length>0?R.some({elem:t,toolbars:i}):R.none()}return R.none()}),t)},aM=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=On(Cn("ContextForm",dv,a));e[t]=c,c.launch.map((function(e){i["form:"+t]=_(_({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){var e;(e=n,Cn("ContextToolbar",mv,e)).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))},s=Dt(t);return G(s,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},cM=di("forward-slide"),sM=di("backward-slide"),fM=di("change-slide-event"),lM="tox-pop--resizing",dM="tox-pop--transition",mM=function(t,n,e,o){var r,i,u=o.backstage,a=u.shared,c=ze().deviceType.isTouch,s=Qc(),f=Qc(),l=Qc(),d=Du((r={sink:e,onEscape:function(){return t.focus(),R.some(!0)}},i=oe([]),Jp.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),Jp.getContent(t).each((function(t){pu(t.element,"visibility")})),qi(t.element,lM),pu(t.element,"width")},inlineBehaviours:wc([cp("context-toolbar-events",[gr(So(),(function(t,n){"width"===n.event.raw.propertyName&&(qi(t.element,lM),pu(t.element,"width"))})),ar(fM,(function(t,n){var e=t.element;pu(e,"width");var o=Lu(e);Jp.setContent(t,n.event.contents),Gi(e,lM);var r=Lu(e);au(e,"width",o+"px"),Jp.getContent(t).each((function(t){n.event.focus.bind((function(t){return Dc(t),Mc(e)})).orThunk((function(){return np.focusIn(t),Ac(zr(e))}))})),hh.setTimeout((function(){au(t.element,"width",r+"px")}),0)})),ar(cM,(function(t,n){Jp.getContent(t).each((function(n){i.set(i.get().concat([{bar:n,focus:Ac(zr(t.element))}]))})),Zo(t,fM,{contents:n.event.forwardContents,focus:R.none()})})),ar(sM,(function(t,n){ct(i.get()).each((function(n){i.set(i.get().slice(0,i.get().length-1)),Zo(t,fM,{contents:Bu(n.bar),focus:n.focus})}))}))]),np.config({mode:"special",onEscape:function(t){return ct(i.get()).fold((function(){return r.onEscape()}),(function(n){return Qo(t,sM),R.some(!0)}))}})]),lazySink:function(){return mt.value(r.sink)}}))),m=function(){var n=l.get().getOr("node"),e=nM(n)?1:0;return QA(t,a,n,e)},g=function(){return!(t.removed||c()&&u.isContextMenuOpen())},h=function(){if(g()){var n=m(),e=$i(l.get(),"node")?function(t,n){return n.filter(eu).map(na).getOrThunk((function(){return $A(t)}))}(t,s.get()):$A(t);return n.height<=0||!JA(e,n)}return!0},v=function(){s.clear(),f.clear(),l.clear(),Jp.hide(d)},b=function(){if(Jp.isOpen(d)){var t=d.element;pu(t,"display"),h()?au(t,"display","none"):(f.set(0),Jp.reposition(d))}},y=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:wc([np.config({mode:"acyclic"}),cp("pop-dialog-wrap-events",[pr((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return np.focusIn(n)}))})),hr((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},x=Ut((function(){return aM(n,(function(t){var n=w([t]);Zo(d,cM,{forwardContents:y(n)})}))})),w=function(n){var e=t.ui.registry.getAll().buttons,r=x(),i=_(_({},e),r.formNavigators),u=Eb(t)===pv.scrolling?pv.scrolling:pv.default,c=Q(U(n,(function(n){return"contexttoolbar"===n.type?function(n,e){return MA(t,{buttons:n,toolbar:e.items,allowToolbarGroups:!1},o,R.some(["form:"]))}(i,n):function(t,n){return KA(t,n)}(n,a.providers)})));return vB({type:u,uid:di("context-toolbar"),initGroups:c,onEscape:R.none,cyclicKeying:!0,providers:a.providers})},S=function(n,o){var r="node"===n?a.anchors.node(o):a.anchors.cursor(),i=function(t,n,e,o){return"line"===n?{bubble:vs(12,0,ZA),layouts:{onLtr:function(){return[ac]},onRtl:function(){return[cc]}},overrides:tM}:{bubble:vs(0,12,ZA,1/12),layouts:oM(t,e,o,n),overrides:tM}}(t,n,c(),{lastElement:s.get,isReposition:function(){return $i(f.get(),0)},getMode:function(){return Pf.getMode(e)}});return jt(r,i)},k=function(t,n){if(C.cancel(),g()){var o=w(t),r=t[0].position,i=S(r,n);l.set(r),f.set(1);var u=d.element;pu(u,"display"),function(t){return $i(Zi(t,s.get(),je),!0)}(n)||(qi(u,dM),Pf.reset(e,d)),Jp.showWithinBounds(d,y(o),{anchor:i,transition:{classes:[dM],mode:"placement"}},(function(){return R.some(m())})),n.fold(s.clear,s.set),h()&&au(u,"display","none")}},C=Fh((function(){t.hasFocus()&&!t.removed&&(Yi(d.element,dM)?C.throttle():function(t,n){var e=ie.fromDom(n.getBody()),o=function(t){return je(t,e)},r=ie.fromDom(n.selection.getNode());return function(t){return!o(t)&&!Ue(e,t)}(r)?R.none():iM(r,t.inNodeScope,t.inEditorScope).orThunk((function(){return uM(o,r,t)}))}(x(),t).fold(v,(function(t){k(t.toolbars,R.some(t.elem))})))}),17);t.on("init",(function(){t.on("remove",v),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",b),t.on("click keyup focus SetContent",C.throttle),t.on(GA,v),t.on("contexttoolbar-show",(function(n){var e=x();Ht(e.lookupTable,n.toolbarKey).each((function(e){k([e],tu(n.target!==t,n.target)),Jp.getContent(d).each(np.focusIn)}))})),t.on("focusout",(function(n){hh.setEditorTimeout(t,(function(){Mc(e.element).isNone()&&Mc(d.element).isNone()&&v()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&v()})),t.on("AfterProgressState",(function(n){n.state?v():t.hasFocus()&&C.throttle()})),t.on("NodeChange",(function(t){Mc(d.element).fold(C.throttle,p)}))}))},gM={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},pM=(UB="[eE][+-]?[0-9]+",GB=function(t){return"(?:"+t+")?"},XB=["Infinity","[0-9]+\\."+GB(WB="[0-9]+")+GB(UB),"\\.[0-9]+"+GB(UB),WB+GB(UB)].join("|"),new RegExp("^([+-]?(?:"+XB+"))(.*)$")),hM=function(t,n){return R.from(pM.exec(t)).bind((function(t){var e=Number(t[1]),o=t[2];return function(t,n){return L(n,(function(n){return L(gM[n],(function(n){return t===n}))}))}(o,n)?R.some({value:e,unit:o}):R.none()}))},vM=function(t,n){var e=function(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=Qc();return U(e,(function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){var u=function(t){t&&(r.on((function(t){return t.setActive(!1)})),r.set(i)),i.setActive(t)};u($i(o,n.hash(e)));var a=n.watcher(t,e,u);return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}}))};t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})},bM={name:"lineheight",text:"Line height",icon:"line-height",getOptions:function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},hash:function(t){return function(t,n){return hM(t,n).map((function(t){return t.value+t.unit}))}(t,["fixed","relative","empty"]).getOr(t)},display:b,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return R.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},yM=function(t){vM(t,bM),function(t){var n=R.from(function(t){return t.getParam("content_langs",void 0,"array")}(t));return n.map((function(n){return{name:"language",text:"Language",icon:"language",getOptions:v(n),hash:function(t){return s(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){var n=ie.fromDom(t.selection.getNode());return Qe(n,(function(t){return R.some(t).filter(Sr).bind((function(t){return oi(t,"lang").map((function(n){return{code:n,customCode:oi(t,"data-mce-lang").getOrUndefined(),title:""}}))}))}))},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(n){var e=$c();return n.setActive(t.formatter.match("lang",{},void 0,!0)),e.set(t.formatter.formatChanged("lang",n.setActive,!0)),e.clear}}}))}(t).each((function(n){return vM(t,n)}))},xM=function(t,n){!function(t,n){var e=LB(0,n,JB(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=LB(0,n,ZB(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=_({type:"advanced"},n.styleselect),o=LB(0,n,uA(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(t,n),function(t,n){var e=LB(0,n,iA(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=LB(0,n,oA(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n)},wM=function(t){return PB(t,"NodeChange",(function(n){n.setDisabled(!t.queryCommandState("outdent"))}))},SM=function(t){!function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:wM(t),onAction:zB(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:zB(t,"indent")})}(t)},kM=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},CM=function(t){!function(t){SC.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:VB(t,n.name),onAction:kM(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:VB(t,e),onAction:kM(t,e)})}}(t),function(t){SC.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:zB(t,n.action)})}))}(t),function(t){SC.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:zB(t,n.action),onSetup:VB(t,n.name)})}))}(t)},OM=function(t){CM(t),function(t){SC.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:zB(t,n.action)})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:kM(t,"code")})}(t)},_M=function(t,n){return PB(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoManager[n]())}))},TM=function(t){!function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:_M(t,"hasUndo"),onAction:zB(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:_M(t,"hasRedo"),onAction:zB(t,"redo")})}(t),function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:_M(t,"hasUndo"),onAction:zB(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:_M(t,"hasRedo"),onAction:zB(t,"redo")})}(t)},EM=function(t){return PB(t,"VisualAid",(function(n){n.setActive(t.hasVisual)}))},DM=function(t){!function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:zB(t,"mceToggleVisualAid")})}(t),function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:EM(t),onAction:zB(t,"mceToggleVisualAid")})}(t)},BM=function(t,n){!function(t){G([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:zB(t,n.cmd),onSetup:VB(t,n.name)})})),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:zB(t,"JustifyNone")})}(t),OM(t),xM(t,n),TM(t),function(t){!function(t){t.addCommand("mceApplyTextcolor",(function(n,e){!function(t,n,e){t.undoManager.transact((function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()}))}(t,n,e)})),t.addCommand("mceRemoveTextcolor",(function(n){!function(t,n){t.undoManager.transact((function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()}))}(t,n)}))}(t);var n=oe(null),e=oe(null);ax(t,"forecolor","forecolor","Text color",n),ax(t,"backcolor","hilitecolor","Background color",e),cx(t,"forecolor","forecolor","Text color"),cx(t,"backcolor","hilitecolor","Background color")}(t),DM(t),SM(t),yM(t)},AM=function(t,n){return{type:"makeshift",x:t,y:n}},MM=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},FM=function(t,n){var e=pb.DOM.getPos(t);return function(t,n,e){return AM(t.x+n,t.y+e)}(n,e.x,e.y)},IM=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(MM(t)){var n=t.touches[0];return AM(n.pageX,n.pageY)}return AM(t.pageX,t.pageY)}(n):FM(t.getContentAreaContainer(),function(t){if(MM(t)){var n=t.touches[0];return AM(n.clientX,n.clientY)}return AM(t.clientX,t.clientY)}(n)):RM(t)},RM=function(t){return{type:"selection",root:ie.fromDom(t.selection.getNode())}},VM=function(t,n,e){switch(e){case"node":return function(t){return{type:"node",node:R.some(ie.fromDom(t.selection.getNode())),root:ie.fromDom(t.getBody())}}(t);case"point":return IM(t,n);case"selection":return RM(t)}},PM=function(t,n,e,o,r,i){var u=e(),a=VM(t,n,i);jO(u,hv.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),Jp.showMenuAt(r,{anchor:a},{menu:{markers:Av("normal")},data:t})}))},HM={onLtr:function(){return[uc,nc,ec,oc,rc,ic,ch,sh,ah,ih,uh,rh]},onRtl:function(){return[uc,ec,nc,rc,oc,ic,ch,sh,uh,rh,ah,ih]}},zM={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},NM=function(t,n,e,o,r,i,u){var a=function(t,n,e){var o=VM(t,n,e);return _({bubble:vs(0,"point"===e?12:0,zM),layouts:HM,overrides:{maxWidthFunction:qD(),maxHeightFunction:ms()}},o)}(t,n,i);jO(e,hv.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),Jp.showMenuWithinBounds(r,{anchor:a},{menu:{markers:Av("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return R.some(QA(t,o.shared,"node"===i?"node":"selection"))})),t.fire(GA)}))},LM=function(t,n,e,o,r,i){var u=ze(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){var u=e();NM(t,n,u,o,r,i,!(s||a||c&&f))};if((c||a)&&"node"!==i){var d=function(){!function(t){var n=t.selection.getRng(),e=function(){hh.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),l()};!function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return sf(t.getWin(),Ws.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?(t.once("selectionchange",d),t.once("touchend",(function(){return t.off("selectionchange",d)}))):d()}else l()},jM=function(t){return"string"==typeof t?t.split(/[ ,]/):t},WM=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},UM=function(t){return function(t,n,e){var o=t.ui.registry.getAll().contextMenus;return R.from(t.getParam(n)).map(jM).getOrThunk((function(){return q(jM(e),(function(t){return zt(o,t)}))}))}(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},GM=function(t){return r(t)?"|"===t:"separator"===t.type},XM={type:"separator"},qM=function(t){var n,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(r(t))return t;switch(t.type){case"separator":return XM;case"submenu":return _(_({type:"nestedmenuitem"},e(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return r(n)?n:U(n,qM)}});default:return _(_({type:"menuitem"},e(t)),{onAction:(n=t.onAction,function(){return n()})})}},YM=function(t,n){if(0===n.length)return t;var e=ct(t).filter((function(t){return!GM(t)})),o=e.fold((function(){return[]}),(function(t){return[XM]}));return t.concat(o).concat(n).concat([XM])},KM=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},JM=function(t,n){return KM(t,n)?t.selection.getStart(!0):n.target},$M=function(t,n,e){var o=ze().deviceType.isTouch,i=Du(Jp.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:wc([cp("dismissContextMenu",[ar(Uo(),(function(n,e){ul.close(n),t.focus()}))])])})),u=function(t){return Jp.hide(i)},a=function(n){if(WM(t)&&n.preventDefault(),!function(t,n){return n.ctrlKey&&!WM(t)}(t,n)&&!function(t){return!1===t.getParam("contextmenu")}(t)){var u=function(t,n){var e=function(t){return t.getParam("contextmenu_avoid_overlap","","string")}(t),o=KM(t,n)?"selection":"point";if(pe(e)){var r=JM(t,n);return Mx(ie.fromDom(r),e)?"node":o}return o}(t,n);(o()?LM:PM)(t,n,(function(){var e=JM(t,n),o=t.ui.registry.getAll(),i=UM(t);return function(t,n,e){var o=K(n,(function(n,o){return Ht(t,o.toLowerCase()).map((function(t){var o=t.update(e);if(r(o))return YM(n,o.split(" "));if(o.length>0){var i=U(o,qM);return YM(n,i)}return n})).getOrThunk((function(){return n.concat([o])}))}),[]);return o.length>0&&GM(o[o.length-1])&&o.pop(),o}(o.contextMenus,i,e)}),e,i,u)}};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,u),t.on("longpress contextmenu",a)}))},QM=Ge([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),ZM=function(t){return function(n){return n.translate(-t.left,-t.top)}},tF=function(t){return function(n){return n.translate(t.left,t.top)}},nF=function(t){return function(n,e){return K(t,(function(t,n){return n(t)}),Vu(n,e))}},eF=function(t,n,e){return t.fold(nF([tF(e),ZM(n)]),nF([ZM(n)]),nF([]))},oF=function(t,n,e){return t.fold(nF([tF(e)]),nF([]),nF([tF(n)]))},rF=function(t,n,e){return t.fold(nF([]),nF([ZM(e)]),nF([tF(n),ZM(e)]))},iF=function(t,n,e){var o=t.fold((function(t,n){return{position:R.some("absolute"),left:R.some(t+"px"),top:R.some(n+"px")}}),(function(t,n){return{position:R.some("absolute"),left:R.some(t-e.left+"px"),top:R.some(n-e.top+"px")}}),(function(t,n){return{position:R.some("fixed"),left:R.some(t+"px"),top:R.some(n+"px")}}));return _({right:R.none(),bottom:R.none()},o)},uF=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(rF,aF),r(oF,cF),r(eF,sF))},aF=QM.offset,cF=QM.absolute,sF=QM.fixed,fF=function(t,n){var e=ei(t,n);return s(e)?NaN:parseInt(e,10)},lF=function(t,n,e,o){return function(t,n){var e=t.element,o=fF(e,n.leftAttr),r=fF(e,n.topAttr);return isNaN(o)||isNaN(r)?R.none():R.some(Vu(o,r))}(t,n).fold((function(){return e}),(function(t){return sF(t.left+o.left,t.top+o.top)}))},dF=function(t,n,e,o,r,i){var u=lF(t,n,e,o),a=n.mustSnap?pF(t,n,u,r,i):hF(t,n,u,r,i),c=eF(u,r,i);return function(t,n,e){var o=t.element;ni(o,n.leftAttr,e.left+"px"),ni(o,n.topAttr,e.top+"px")}(t,n,c),a.fold((function(){return{coord:sF(c.left,c.top),extra:R.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},mF=function(t,n){!function(t,n){var e=t.element;ii(e,n.leftAttr),ii(e,n.topAttr)}(t,n)},gF=function(t,n,e,o){return ft(t,(function(t){var r=t.sensor,i=function(t,n,e,o,r,i){var u=oF(t,r,i),a=oF(n,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o}(n,r,t.range.left,t.range.top,e,o);return i?R.some({output:uF(t.output,n,e,o),extra:t.extra}):R.none()}))},pF=function(t,n,e,o,r){var i=n.getSnapPoints(t);return gF(i,e,o,r).orThunk((function(){var t=K(i,(function(t,n){var i=n.sensor,u=function(t,n,e,o,r,i){var u=oF(t,r,i),a=oF(n,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return Vu(c,s)}(e,i,n.range.left,n.range.top,o,r);return t.deltas.fold((function(){return{deltas:R.some(u),snap:R.some(n)}}),(function(e){return(u.left+u.top)/2<=(e.left+e.top)/2?{deltas:R.some(u),snap:R.some(n)}:t}))}),{deltas:R.none(),snap:R.none()});return t.snap.map((function(t){return{output:uF(t.output,e,o,r),extra:t.extra}}))}))},hF=function(t,n,e,o,r){var i=n.getSnapPoints(t);return gF(i,e,o,r)},vF=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=_r(t.element),u=Xu(i),a=wE(r),c=function(t,n,e){return{coord:uF(t.output,t.output,n,e),extra:t.extra}}(o,u,a),s=iF(c.coord,0,a);su(r,s)}}}),bF="data-initial-z-index",yF=function(t,n){t.getSystem().addToGui(n),function(t){Br(t.element).filter(Sr).each((function(n){du(n,"z-index").each((function(t){ni(n,bF,t)})),au(n,"z-index",fu(t.element,"z-index"))}))}(n)},xF=function(t){!function(t){Br(t.element).filter(Sr).each((function(t){oi(t,bF).fold((function(){return pu(t,"z-index")}),(function(n){return au(t,"z-index",n)})),ii(t,bF)}))}(t),t.getSystem().removeFromGui(t)},wF=function(t,n,e){return t.getSystem().build(qx.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},SF=qn("snaps",[Mn("getSnapPoints"),Ea("onSensor"),Mn("leftAttr"),Mn("topAttr"),Yn("lazyViewport",ea),Yn("mustSnap",!1)]),kF=[Yn("useFixed",k),Mn("blockerClass"),Yn("getTarget",b),Yn("onDrag",p),Yn("repositionTarget",!0),Yn("onDrop",p),te("getBounds",ea),SF],CF=function(t){return(n=du(t,"left"),e=du(t,"top"),o=du(t,"position"),r=function(t,n,e){return("fixed"===e?sF:aF)(parseInt(t,10),parseInt(n,10))},n.isSome()&&e.isSome()&&o.isSome()?R.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):R.none()).getOrThunk((function(){var n=Hu(t);return cF(n.left,n.top)}));var n,e,o,r},OF=function(t,n,e,o,r,i,u){return function(t,n,e,o,r){var i=r.bounds,u=oF(n,e,o),a=Xa(u.left,i.x,i.x+i.width-r.width),c=Xa(u.top,i.y,i.y+i.height-r.height),s=cF(a,c);return n.fold((function(){var t=rF(s,e,o);return aF(t.left,t.top)}),v(s),(function(){var t=eF(s,e,o);return sF(t.left,t.top)}))}(0,n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return aF(t+n,e+u)}),(function(t,e){return cF(t+n,e+u)}),(function(t,e){return sF(t+n,e+u)}))),c=eF(a,o,r);return sF(c.left,c.top)}),(function(n){var u=dF(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord})),o,r,u)},_F=function(t,n){return{bounds:t.getBounds(),height:Iu(n.element),width:ju(n.element)}},TF=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return _F(n,t)}));i.each((function(e){!function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=_r(t.element),u=Xu(i),a=wE(r),c=CF(r),s=OF(t,n.snaps,c,u,a,o,e),f=iF(s,0,a);su(r,f)}n.onDrag(t,r,o)}(t,n,u,e)}))},EF=function(t,n,e,o){n.each(xF),e.snaps.each((function(n){mF(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},DF=function(t){return function(n,e){var o=function(t){e.setStartData(_F(n,t))};return rr(E([ar(No(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o)))}},BF=Object.freeze({__proto__:null,getData:function(t){return R.from(Vu(t.x,t.y))},getDelta:function(t,n){return Vu(n.left-t.left,n.top-t.top)}}),AF=function(t,n,e){return[ar(co(),(function(o,r){if(0===r.event.raw.button){r.stop();var i=function(){return EF(o,R.some(c),t,n)},u=Fx(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),TF(o,t,n,BF,e)}},c=wF(o,t.blockerClass,function(t){return rr([ar(co(),t.forceDrop),ar(lo(),t.drop),ar(so(),(function(n,e){t.move(e.event)})),ar(fo(),t.delayDrop)])}(a));e(o),yF(o,c)}}))]},MF=E(E([],kF),[Ma("dragger",{handlers:DF(AF)})]),FF=Object.freeze({__proto__:null,getData:function(t){var n=t.raw.touches;return 1===n.length?function(t){var n=t[0];return R.some(Vu(n.clientX,n.clientY))}(n):R.none()},getDelta:function(t,n){return Vu(n.left-t.left,n.top-t.top)}}),IF=function(t,n,e){var o=Qc(),r=function(e){EF(e,o.get(),t,n),o.clear()};return[ar(ro(),(function(i,u){u.stop();var a=function(){return r(i)},c={drop:a,delayDrop:p,forceDrop:a,move:function(e){TF(i,t,n,FF,e)}},s=wF(i,t.blockerClass,function(t){return rr([ar(ro(),t.forceDrop),ar(uo(),t.drop),ar(ao(),t.drop),ar(io(),(function(n,e){t.move(e.event)}))])}(c));o.set(s);e(i),yF(i,s)})),ar(io(),(function(e,o){o.stop(),TF(e,t,n,FF,o.event)})),ar(uo(),(function(t,n){n.stop(),r(t)})),ar(ao(),r)]},RF=MF,VF=E(E([],kF),[Ma("dragger",{handlers:DF(IF)})]),PF=E(E([],kF),[Ma("dragger",{handlers:DF((function(t,n,e){return E(E([],AF(t,n,e)),IF(t,n,e))}))})]),HF=Object.freeze({__proto__:null,mouse:RF,touch:VF,mouseOrTouch:PF}),zF=Object.freeze({__proto__:null,init:function(){var t=R.none(),n=R.none(),e=v({});return Di({readState:e,reset:function(){t=R.none(),n=R.none()},update:function(n,e){return n.getData(e).bind((function(e){return function(n,e){var o=t.map((function(t){return n.getDelta(t,e)}));return t=R.some(e),o}(n,e)}))},getStartData:function(){return n},setStartData:function(t){n=R.some(t)}})}}),NF=Oc({branchKey:"mode",branches:HF,name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:R.from(t.extra)}}},state:zF,apis:vF}),LF=function(t,n,e,o,r,i){return t.fold((function(){return NF.snap({sensor:cF(e-20,o-20),range:Vu(r,i),output:cF(R.some(e),R.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return NF.snap({sensor:cF(r,i),range:Vu(40,40),output:cF(R.some(e-u.width/2),R.some(o-u.height/2)),extra:{td:n}})}))},jF=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r=o.td;(function(t,n){return t.exists((function(t){return je(t,n)}))})(n.get(),r)||(n.set(r),e(r))},mustSnap:!0}},WF=function(t){return bh(vh.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:wc([NF.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),fS.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},UF=function(t,n){var e=oe([]),o=oe([]),r=oe(!1),i=Qc(),u=Qc(),a=function(t){var e=na(t);return LF(l.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=na(t);return LF(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=jF((function(){return U(e.get(),(function(t){return a(t)}))}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),f=jF((function(){return U(o.get(),(function(t){return c(t)}))}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),l=WF(s),d=WF(f),m=Du(l.asSpec()),g=Du(d.asSpec()),p=function(n,e,o,r){var i=o(e);NF.snapTo(n,i);!function(n,e,o,r){var i=e.dom.getBoundingClientRect();pu(n.element,"display");var u=Dr(ie.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&au(n.element,"display","none")}(n,e,(function(t){return t[r]<0}),(function(t,n){return t[r]>n}))},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")};ze().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(jf(n,m),jf(n,g),r.set(!0)),i.set(t.start),u.set(t.finish),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(Gf(m),Gf(g),r.set(!1)),i.clear(),u.clear()})))},GF=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},XF=function(t,n,e){n.delimiter||(n.delimiter="»");return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:wc([np.config({mode:"flow",selector:"div[role=button]"}),Kd.config({disabled:e.isDisabled}),Xb(),tw.config({}),ap.config({}),cp("elementPathEvents",[pr((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return np.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;o-- >0;){var r=n[o];if(1===r.nodeType&&!GF(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);a.length>0?ap.set(o,(i=U(a||[],(function(n,o){return vh.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:wc([Yb(e.isDisabled),Xb()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},K(i.slice(1),(function(t,n){var e=t;return e.push(u),e.push(n),e}),[i[0]]))):ap.set(o,[])}))}))])]),components:[]}};!function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Vertical=2]="Vertical"}(qB||(qB={}));var qF=function(t,n,e){var o=ie.fromDom(t.getContainer()),r=function(t,n,e,o,r){var i={};return i.height=zA(o+n.top,xb(t),Sb(t)),e===qB.Both&&(i.width=zA(r+n.left,yb(t),wb(t))),i}(t,n,e,Fu(o),Lu(o));At(r,(function(t,n){return au(o,n,HA(t))})),function(t){t.fire("ResizeEditor")}(t)},YF=function(t,n,e,o){var r=Vu(20*e,20*o);return qF(t,r,n),R.some(!0)},KF=function(t,n){var e=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n);return!1===e?qB.None:"both"===e?qB.Both:qB.Vertical}(t);return e===qB.None?R.none():R.some(Eh("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[NF.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return qF(t,r,e)},blockerClass:"tox-blocker"}),np.config({mode:"special",onLeft:function(){return YF(t,e,-1,0)},onRight:function(){return YF(t,e,1,0)},onUp:function(){return YF(t,e,0,-1)},onDown:function(){return YF(t,e,0,1)}}),tw.config({}),mp.config({})]},n.icons))},JF=function(t,n){var e=function(){var e,o=[];return t.getParam("elementpath",!0,"boolean")&&o.push(XF(t,{},n)),t.hasPlugin("wordcount")&&o.push(function(t,n){var e,o=function(t,e,o){return ap.set(t,[_u(n.translate(["{0} "+o,e[o]]))])};return vh.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:wc([Yb(n.isDisabled),Xb(),tw.config({}),ap.config({}),_l.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),cp("wordcount-events",[br((function(t){var n=_l.getValue(t),e="words"===n.mode?"characters":"words";_l.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)})),pr((function(n){t.on("wordCountUpdate",(function(t){var e=_l.getValue(n).mode;_l.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)}))}))])]),eventOrder:(e={},e[Ao()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(t,n)),t.getParam("branding",!0,"boolean")&&o.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=yh.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=KF(t,n);return o.concat(r.toArray())}()}},$F=function(t){var n,e,o,r,i=t.inline,u=i?UA:VA,a=Pb(t)?KE:yE,c=R.none(),s=ze(),f=s.browser.isIE()?["tox-platform-ie"]:[],l=s.deviceType.isTouch()?["tox-platform-touch"]:[],d=Mb(t),m=Rb(t),g=yh.isRtl()?{attributes:{dir:"rtl"}}:{},h={attributes:(n={},n[Ss]=d?jc.BottomToTop:jc.TopToBottom,n)},v=function(){return c.bind(OB.getHeader)},b=function(){au(X.element,"width",document.body.clientWidth+"px")},y=Du((e=je(ou(),m)&&"grid"===fu(m,"display"),o={dom:_({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(f).concat(l)},g),behaviours:wc([Pf.config({useFixed:function(){return a.isDocked(v)}})])},r={dom:{styles:{width:document.body.clientWidth+"px"}},events:rr([ar(Lo(),b)])},jt(o,e?r:{}))),x=function(){return mt.value(y)},w=bh({dom:{tag:"div",classes:["tox-anchorbar"]}}),S=function(){return c.bind((function(t){return OB.getThrobber(t)})).getOrDie("Could not find throbber element")},k=iE(y,t,(function(){return c.bind((function(t){return w.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),C=OB.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:k,onEscape:function(){t.focus()}}),O=Eb(t),T=OB.parts.toolbar(_({dom:{tag:"div",classes:["tox-toolbar"]},getSink:x,providers:k.shared.providers,onEscape:function(){t.focus()},type:O,lazyToolbar:function(){return c.bind((function(t){return OB.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return v().getOrDie("Could not find header element")}},h)),E=OB.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:k.shared.providers,onEscape:function(){t.focus()},type:O}),D=OB.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),B=OB.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),A=OB.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:k}),M=t.getParam("statusbar",!0,"boolean")&&!i?R.some(JF(t,k.shared.providers)):R.none(),F={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[D,B]},I=_b(t),V=Cb(t),P=kb(t),H=OB.parts.header({dom:_({tag:"div",classes:["tox-editor-header"]},h),components:Q([P?[C]:[],I?[E]:V?[T]:[],Ib(t)?[]:[w.asSpec()]]),sticky:Pb(t),editor:t,sharedBackstage:k.shared}),z=Q([d?[]:[H],i?[]:[F],d?[H]:[]]),N=Q([[{dom:{tag:"div",classes:["tox-editor-container"]},components:z}],i?[]:M.toArray(),[A]]),L=Vb(t),j=_(_({role:"application"},yh.isRtl()?{dir:"rtl"}:{}),L?{"aria-hidden":"true"}:{}),W=Du(OB.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(i?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(f),styles:_({visibility:"hidden"},L?{opacity:"0",border:"0"}:{}),attributes:j},components:N,behaviours:wc([Xb(),Kd.config({disableClass:"tox-tinymce--disabled"}),np.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));c=R.some(W),t.shortcuts.add("alt+F9","focus menubar",(function(){OB.focusMenubar(W)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){OB.focusToolbar(W)})),t.addCommand("ToggleToolbarDrawer",(function(){OB.toggleToolbarDrawer(W)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return OB.isToolbarDrawerToggled(W)}));var U=Yx(W),X=Yx(y);!function(t,n,e){var o=function(t,o){G([n,e],(function(n){n.broadcastEvent(t,o)}))},r=function(t,o){G([n,e],(function(n){n.broadcastOn([t],o)}))},i=function(t){return r(al(),{target:t.target})},u=ts(ie.fromDom(document),"touchstart",i),a=ts(ie.fromDom(document),"touchmove",(function(t){return o(Ho(),t)})),c=ts(ie.fromDom(document),"touchend",(function(t){return o(zo(),t)})),s=ts(ie.fromDom(document),"mousedown",i),f=ts(ie.fromDom(document),"mouseup",(function(t){0===t.raw.button&&r(sl(),{target:t.target})})),l=function(t){return r(al(),{target:ie.fromDom(t.target)})},d=function(t){0===t.button&&r(sl(),{target:ie.fromDom(t.target)})},m=function(){G(t.editorManager.get(),(function(n){t!==n&&n.fire("DismissPopups",{relatedTarget:t})}))},g=function(t){return o(No(),es(t))},p=function(t){r(cl(),{}),o(Lo(),es(t))},h=function(){return r(cl(),{})},v=function(n){n.state&&r(al(),{target:ie.fromDom(t.getContainer())})},b=function(t){r(al(),{target:ie.fromDom(t.relatedTarget.getContainer())})};t.on("PostRender",(function(){t.on("click",l),t.on("tap",l),t.on("mouseup",d),t.on("mousedown",m),t.on("ScrollWindow",g),t.on("ResizeWindow",p),t.on("ResizeEditor",h),t.on("AfterProgressState",v),t.on("DismissPopups",b)})),t.on("remove",(function(){t.off("click",l),t.off("tap",l),t.off("mouseup",d),t.off("mousedown",m),t.off("ScrollWindow",g),t.off("ResizeWindow",p),t.off("ResizeEditor",h),t.off("AfterProgressState",v),t.off("DismissPopups",b),s.unbind(),u.unbind(),a.unbind(),c.unbind(),f.unbind()})),t.on("detach",(function(){Kf(n),Kf(e),n.destroy(),e.destroy()}))}(t,U,X);var q=function(){var n=HA(NA(t)),e=HA(function(t){return LA(t).getOr(bb(t))}(t));return t.inline||(gu("div","width",e)&&au(W.element,"width",e),gu("div","height",n)?au(W.element,"height",n):au(W.element,"height","200px")),n};return{mothership:U,uiMothership:X,backstage:k,renderUI:function(){a.setup(t,k.shared,v),BM(t,k),$M(t,x,k),function(t){var n=t.ui.registry.getAll().sidebars;G(Dt(n),(function(e){var o=n[e],r=function(){return $i(R.from(t.queryCommandValue("ToggleSidebar")),e)};t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})}))}(t),PD(t,S,k.shared),Mt(function(t){return t.getParam("toolbar_groups",{},"object")}(t),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var n=t.ui.registry.getAll(),e=n.buttons,o=n.menuItems,r=n.contextToolbars,i=n.sidebars,c=Ob(t),s={menuItems:o,menus:Hb(t),menubar:zb(t),toolbar:c.getOrThunk((function(){return function(t){return t.getParam("toolbar",!0)}(t)})),allowToolbarGroups:O===pv.floating,buttons:e,sidebar:i};mM(t,r,y,{backstage:k}),UF(t,y);var f=t.getElement(),l=q(),d={mothership:U,uiMothership:X,outerContainer:W},m={targetNode:f,height:l};return u.render(t,d,s,k,m)},getUi:function(){return{channels:{broadcastAll:X.broadcast,broadcastOn:X.broadcastOn,register:p}}}}},QF=v([Mn("lazySink"),Ln("dragBlockClass"),te("getBounds",ea),Yn("useTabstopAt",C),Yn("eventOrder",{}),Tl("modalBehaviours",[np]),Da("onExecute"),Aa("onEscape")]),ZF={sketch:b},tI=v([rd({name:"draghandle",overrides:function(t,n){return{behaviours:wc([NF.config({mode:"mouse",getTarget:function(t){return ca(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),ed({schema:[Mn("dom")],name:"title"}),ed({factory:ZF,schema:[Mn("dom")],name:"close"}),ed({factory:ZF,schema:[Mn("dom")],name:"body"}),rd({factory:ZF,schema:[Mn("dom")],name:"footer"}),od({factory:{sketch:function(t,n){return _(_({},t),{dom:n.dom,components:n.components})}},schema:[Yn("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Yn("components",[])],name:"blocker"})]),nI=Ad({name:"ModalDialog",configFields:QF(),partFields:tI(),factory:function(t,n,e,o){var r,i=Qc(),u=di("modal-events"),a=_(_({},t.eventOrder),((r={})[jo()]=[u].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){i.set(n);var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(_(_({},r),{components:r.components.concat([Bu(n)]),behaviours:wc([mp.config({}),cp("dialog-blocker-events",[gr(go(),(function(){np.focusIn(n)}))])])}));jf(e,u),np.focusIn(n)},hide:function(t){i.clear(),Br(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){Gf(t)}))}))},getBody:function(n){return vd(n,t,"body")},getFooter:function(n){return vd(n,t,"footer")},setIdle:function(t){FD.unblock(t)},setBusy:function(t,n){FD.block(t,n)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Dl(t.modalBehaviours,[ap.config({}),np.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),FD.config({getRoot:i.get}),cp(u,[pr((function(n){var e,o,r,i,u,a;e=n.element,o=vd(n,t,"title").element,r=oi(e,"id").fold((function(){var t=di("dialog-label");return ni(o,"id",t),t}),b),ni(e,"aria-labelledby",r),i=n.element,u=vd(n,t,"body").element,a=R.from(ei(i,"id")).fold((function(){var t=di("dialog-describe");return ni(u,"id",t),t}),b),ni(i,"aria-describedby",a)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),eI=an([Rn("type"),Rn("name")].concat(Yv)),oI=hn,rI=[Dn("name","name",Gt((function(){return di("button-name")})),pn),Un("icon"),Qn("align","end",["start","end"]),Zn("primary",!1),Zn("disabled",!1)],iI=E(E([],rI),[Rn("text")]),uI=E([Vn("type",["submit","cancel","custom"])],iI),aI=E([Vn("type",["menu"]),Un("text"),Un("tooltip"),Un("icon"),Nn("items",eI)],rI),cI=En("type",{submit:uI,cancel:uI,custom:uI,menu:aI}),sI=[Rn("type"),Rn("text"),Vn("level",["info","warn","error","success"]),Rn("icon"),Yn("url","")],fI=an(sI),lI=[Rn("type"),Rn("text"),Zn("disabled",!1),Zn("primary",!1),Dn("name","name",Gt((function(){return di("button-name")})),pn),Un("icon"),Zn("borderless",!1)],dI=an(lI),mI=[Rn("type"),Rn("name"),Rn("label"),Zn("disabled",!1)],gI=an(mI),pI=hn,hI=[Rn("type"),Rn("name")],vI=hI.concat([Un("label")]),bI=vI.concat([Yn("columns","auto")]),yI=an(bI),xI=ln([Rn("value"),Rn("text"),Rn("icon")]),wI=an(vI),SI=pn,kI=an(vI),CI=pn,OI=hI.concat([$n("tag","textarea"),Rn("scriptId"),Rn("scriptUrl"),function(t,n){return Kn(t,n,yn)}("settings",void 0)]),_I=hI.concat([$n("tag","textarea"),Pn("init")]),TI=Sn((function(t){return Cn("customeditor.old",un(_I),t).orThunk((function(){return Cn("customeditor.new",un(OI),t)}))})),EI=pn,DI=an(vI),BI=cn(Zt),AI=function(t){return[Rn("type"),In("columns"),t]},MI=[Rn("type"),Rn("html"),Qn("presets","presentation",["presentation","document"])],FI=an(MI),II=vI.concat([Zn("sandboxed",!0)]),RI=an(II),VI=pn,PI=vI.concat([Fn("currentState",an([Mn("blob"),Rn("url")]))]),HI=an(PI),zI=vI.concat([Un("inputMode"),Un("placeholder"),Zn("maximized",!1),Zn("disabled",!1)]),NI=an(zI),LI=pn,jI=function(t){return[Rn("type"),Rn("label"),t]},WI=[Rn("text"),Rn("value")],UI=[Rn("text"),Nn("items",function(t,n){return e=Ut(n),{extract:function(t,n){return e().extract(t,n)},toString:function(){return e().toString()}};var e}(0,(function(){return GI})))],GI=sn([an(WI),an(UI)]),XI=vI.concat([Nn("items",GI),Zn("disabled",!1)]),qI=an(XI),YI=pn,KI=vI.concat([zn("items",[Rn("text"),Rn("value")]),Jn("size",1),Zn("disabled",!1)]),JI=an(KI),$I=pn,QI=vI.concat([Zn("constrain",!0),Zn("disabled",!1)]),ZI=an(QI),tR=an([Rn("width"),Rn("height")]),nR=[Rn("type"),Nn("header",pn),Nn("cells",cn(pn))],eR=an(nR),oR=vI.concat([Un("placeholder"),Zn("maximized",!1),Zn("disabled",!1)]),rR=an(oR),iR=pn,uR=vI.concat([Qn("filetype","file",["image","media","file"]),Yn("disabled",!1)]),aR=an(uR),cR=an([Rn("value"),Yn("meta",{})]),sR=function(t){return Dn("items","items",{tag:"required",process:{}},cn(Sn((function(n){return Cn("Checking item of "+t,fR,n).fold((function(t){return mt.error(Tn(t))}),(function(t){return mt.value(t)}))}))))},fR=on((function(){return wn("type",{alertbanner:fI,bar:an((t=sR("bar"),[Rn("type"),t])),button:dI,checkbox:gI,colorinput:wI,colorpicker:kI,dropzone:DI,grid:an(AI(sR("grid"))),iframe:RI,input:NI,listbox:qI,selectbox:JI,sizeinput:ZI,textarea:rR,urlinput:aR,customeditor:TI,htmlpanel:FI,imagetools:HI,collection:yI,label:an(jI(sR("label"))),table:eR,panel:dR});var t})),lR=[Rn("type"),Yn("classes",[]),Nn("items",fR)],dR=an(lR),mR=[Dn("name","name",Gt((function(){return di("tab-name")})),pn),Rn("title"),Nn("items",fR)],gR=[Rn("type"),zn("tabs",mR)],pR=an(gR),hR=iI,vR=cI,bR=an([Rn("title"),Fn("body",wn("type",{panel:dR,tabpanel:pR})),$n("size","normal"),Nn("buttons",vR),Yn("initialData",{}),te("onAction",p),te("onChange",p),te("onSubmit",p),te("onClose",p),te("onCancel",p),Yn("onTabChange",p)]),yR=an(E([Vn("type",["cancel","custom"])],hR)),xR=an([Rn("title"),Rn("url"),Wn("height"),Wn("width"),Xn("buttons",yR),te("onAction",p),te("onCancel",p),te("onClose",p),te("onMessage",p)]),wR=function(t){return i(t)?[t].concat(Z(Pt(t),wR)):u(t)?Z(t,wR):[]},SR=function(t){return r(t.type)&&r(t.name)},kR={checkbox:pI,colorinput:SI,colorpicker:CI,dropzone:BI,input:LI,iframe:VI,sizeinput:tR,selectbox:$I,listbox:YI,size:tR,textarea:iR,urlinput:cR,customeditor:EI,collection:xI,togglemenuitem:oI},CR=function(t){var n=function(t){return q(wR(t),SR)}(t),e=Z(n,(function(t){return function(t){return R.from(kR[t.type])}(t).fold((function(){return[]}),(function(n){return[Fn(t.name,n)]}))}));return an(e)},OR=function(t){return{internalDialog:On(Cn("dialog",bR,t)),dataValidator:CR(t),initialData:t.initialData}},_R={open:function(t,n){var e=OR(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(On(Cn("dialog",xR,n)))},redial:function(t){return OR(t)}},TR=function(t){var n=[],e={};return At(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),n.length>0?mt.error(n):mt.value(e)},ER=function(t,n){var e=bh(cC.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:U(t.items,(function(t){return lT(e,t,n)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:wc([np.config({mode:"acyclic",useTabstopAt:w(PC)}),vC(e),_C(e,{postprocess:function(t){return TR(t).fold((function(t){return console.error(t),{}}),b)}})])}},DR=Bd({name:"TabButton",configFields:[Yn("uid",void 0),Mn("value"),Dn("dom","dom",qt((function(){return{attributes:{role:"tab",id:di("aria"),"aria-selected":"false"}}})),dn()),Ln("action"),Yn("domModification",{}),Tl("tabButtonBehaviours",[mp,np,_l]),Mn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Tp(t.action),behaviours:Dl(t.tabButtonBehaviours,[mp.config({}),np.config({mode:"execution",useSpace:!0,useEnter:!0}),_l.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),BR=v([Mn("tabs"),Mn("dom"),Yn("clickToDismiss",!1),Tl("tabbarBehaviours",[um,np]),_a(["tabClass","selectedClass"])]),AR=id({factory:DR,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){um.dehighlight(t,n),Zo(t,Ko(),{tabbar:t,button:n})},e=function(t,n){um.highlight(t,n),Zo(t,Yo(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=um.isHighlighted(r,o);(i&&t.clickToDismiss?n:i?p:e)(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),MR=v([AR]),FR=Ad({name:"Tabbar",configFields:BR(),partFields:MR(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Dl(t.tabbarBehaviours,[um.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){ni(n.element,"aria-selected","true")},onDehighlight:function(t,n){ni(n.element,"aria-selected","false")}}),np.config({mode:"flow",getInitial:function(t){return um.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),IR=Bd({name:"Tabview",configFields:[Tl("tabviewBehaviours",[ap])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Dl(t.tabviewBehaviours,[ap.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),RR=v([Yn("selectFirst",!0),Ea("onChangeTab"),Ea("onDismissTab"),Yn("tabs",[]),Tl("tabSectionBehaviours",[])]),VR=ed({factory:FR,schema:[Mn("dom"),Hn("markers",[Mn("tabClass"),Mn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),PR=ed({factory:IR,name:"tabview"}),HR=v([VR,PR]),zR=Ad({name:"TabSection",configFields:RR(),partFields:HR(),factory:function(t,n,e,o){var r=function(n,e){hd(n,t,"tabbar").each((function(t){e(t).each(tr)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:El(t.tabSectionBehaviours),events:rr(Q([t.selectFirst?[pr((function(t,n){r(t,um.getFirst)}))]:[],[ar(Yo(),(function(n,e){!function(n){var e=_l.getValue(n);hd(n,t,"tabview").each((function(o){var r=J(t.tabs,(function(t){return t.value===e}));r.each((function(e){var r=e.view();oi(n.element,"id").each((function(t){ni(o.element,"aria-labelledby",t)})),ap.set(o,r),t.onChangeTab(o,n,r)}))}))}(e.event.button)})),ar(Ko(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return hd(n,t,"tabview").map((function(t){return ap.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=um.getCandidates(t);return J(e,(function(t){return _l.getValue(t)===n})).filter((function(n){return!um.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),NR=function(t,n){au(t,"height",n+"px"),ze().browser.isIE()?pu(t,"flex-basis"):au(t,"flex-basis",n+"px")},LR=function(t,n,e){ca(t,'[role="dialog"]').each((function(t){fa(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return au(n,"height","0"),au(n,"flex-basis","0"),Math.min(e,function(t,n,e){var o,r=Er(t).dom,i=ca(t,".tox-dialog-wrap").getOr(t);o="fixed"===fu(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var u=Fu(n),a=n.dom.offsetLeft>=e.dom.offsetLeft+Lu(e)?Math.max(Fu(e),u):u,c=parseInt(fu(t,"margin-top"),10)||0,s=parseInt(fu(t,"margin-bottom"),10)||0;return o-(Fu(t)+c+s-a)}(t,n,o))})).each((function(t){NR(n,t)}))}))}))},jR=function(t){return fa(t,'[role="tabpanel"]')},WR=function(t){var n,e,o=(n=Qc(),e=[pr((function(e){var o=e.element;jR(o).each((function(r){au(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o=function(t,n,e){return U(t,(function(o,r){ap.set(e,t[r].view());var i=n.dom.getBoundingClientRect();return ap.set(e,[]),i.height}))}(t,r,e),i=function(t){return at(it(t,(function(t,n){return t>n?-1:t<n?1:0})))}(o);i.fold(n.clear,n.set)})),LR(o,r,n),pu(r,"visibility"),function(t,n){at(t).each((function(t){return zR.showTab(n,t.value)}))}(t,e),hh.requestAnimationFrame((function(){LR(o,r,n)}))}))})),ar(Lo(),(function(t){var e=t.element;jR(e).each((function(t){LR(e,t,n)}))})),ar(gw,(function(t,e){var o=t.element;jR(o).each((function(t){var e=Ac(zr(t));au(t,"visibility","hidden");var r=du(t,"height").map((function(t){return parseInt(t,10)}));pu(t,"height"),pu(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall((function(t){return i>t}))?(n.set(i),LR(o,t,n)):r.each((function(n){NR(t,n)})),pu(t,"visibility"),e.each(Dc)}))}))],{extraEvents:e,selectFirst:!1});return{smartTabHeight:o,naiveTabHeight:{extraEvents:[],selectFirst:!0}}},UR="send-data-to-section",GR="send-data-to-view",XR=function(t,n){var e=oe({}),o=function(t){var n=_l.getValue(t),o=TR(n).getOr({}),r=e.get(),i=jt(r,o);e.set(i)},r=function(t){var n=e.get();_l.setValue(t,n)},i=oe(null),u=U(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[cC.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:U(t.items,(function(t){return lT(e,t,n)})),formBehaviours:wc([np.config({mode:"acyclic",useTabstopAt:w(PC)}),cp("TabView.form.events",[pr(r),hr(o)]),Tc.config({channels:Ye([{key:UR,value:{onReceive:o}},{key:GR,value:{onReceive:r}}])})])}}))]}}})),a=WR(u).smartTabHeight;return zR.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=_l.getValue(n);Zo(t,mw,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[zR.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[FR.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:wc([tw.config({})])}),zR.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:wc([cp("tabpanel",a.extraEvents),np.config({mode:"acyclic"}),Rd.config({find:function(t){return at(zR.getViewItems(t))}}),_l.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([UR],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([GR],{})}}})])})},qR=di("update-dialog"),YR=di("update-title"),KR=di("update-body"),JR=di("update-footer"),$R=di("body-send-message"),QR=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:_(_({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:wc([bC(0),lA.config({channel:KR,updateState:function(t,n){return R.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"===t.body.type?[XR(t.body,e)]:[ER(t.body,e)]},initialData:t})])}},ZR=iy.deviceType.isTouch(),tV=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},nV=function(t,n){return nI.parts.close(vh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:wc([tw.config({})])}))},eV=function(){return nI.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},oV=function(t,n){return nI.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:ID("<p>"+n.translate(t)+"</p>")}]}]})},rV=function(t){return nI.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},iV=function(t,n){return[qx.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),qx.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},uV=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return nI.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),R.some(!0)},useTabstopAt:function(t){return!PC(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:_({position:"relative"},t.extraStyles)},components:E([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:ID('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:ZR?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:wc(E([mp.config({}),cp("dialog-events",t.dialogEvents.concat([gr(go(),(function(t,n){np.focusIn(t)}))])),cp("scroll-lock",[pr((function(){Gi(ou(),i)})),hr((function(){qi(ou(),i)}))])],t.extraBehaviours)),eventOrder:_((n={},n[Ao()]=["dialog-events"],n[jo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[Wo()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},aV=function(t){return vh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[Eh("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){Qo(t,cw)}})},cV=function(t,n,e){var o=function(t){return[_u(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:_({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:wc([lA.config({channel:YR,renderComponents:o})])}},sV=function(){return{dom:ID('<div class="tox-dialog__draghandle"></div>')}},fV=function(t,n){return function(t,n){var e=nI.parts.title(cV(t,R.none(),n)),o=nI.parts.draghandle(sV()),r=nI.parts.close(aV(n)),i=[e].concat(t.draggable?[o]:[]).concat([r]);return qx.sketch({dom:ID('<div class="tox-dialog__header"></div>'),components:i})}({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},lV=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:ID('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},dV=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){nI.setBusy(t(),(function(t,o){return lV(e.message,o,n)}))},onUnblock:function(){nI.setIdle(t())}}},mV=function(t,n,e,o){var r;return Du(uV(_(_({},t),{lazySink:o.shared.getSink,extraBehaviours:E([lA.config({channel:qR,updateState:function(t,n){return R.some(n)},initialData:n}),DC({})],t.extraBehaviours),onEscape:function(t){Qo(t,cw)},dialogEvents:e,eventOrder:(r={},r[Bo()]=[lA.name(),Tc.name()],r[jo()]=["scroll-lock",lA.name(),"messages","dialog-events","alloy.base.behaviour"],r[Wo()]=["alloy.base.behaviour","dialog-events","messages",lA.name(),"scroll-lock"],r)})))},gV=function(t){return U(t,(function(t){return"menu"===t.type?function(t){var n=U(t.items,(function(t){var n=oe(!1);return _(_({},t),{storage:n})}));return _(_({},t),{items:n})}(t):t}))},pV=function(t){return K(t,(function(t,n){return"menu"===n.type?K(n.items,(function(t,n){return t[n.name]=n.storage,t}),t):t}),{})},hV=function(t,n){return[lr(go(),VC),t(aw,(function(t,e){n.onClose(),e.onClose()})),t(cw,(function(t,n,e,o){n.onCancel(t),Qo(o,aw)})),ar(dw,(function(t,e){return n.onUnblock()})),ar(lw,(function(t,e){return n.onBlock(e.event)}))]},vV=function(t,n){var e=function(n,e){return ar(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){lA.getState(t).get().each((function(e){n(e,t)}))};return E(E([],hV(e,n)),[e(sw,(function(t,n,e){n.onAction(t,{name:e.name})}))])},bV=function(t,n,e){var o=function(n,e){return ar(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){lA.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return E(E([],hV(o,n)),[o(fw,(function(t,n){return n.onSubmit(t)})),o(uw,(function(t,n,e){n.onChange(t,{name:e.name})})),o(sw,(function(t,n,o,r){var i=function(){return np.focusIn(r)},u=function(t){return ri(t,"disabled")||oi(t,"aria-disabled").exists((function(t){return"true"===t}))},a=zr(r.element),c=Ac(a);n.onAction(t,{name:o.name,value:o.value}),Ac(a).fold(i,(function(t){u(t)||c.exists((function(n){return Ue(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!Ue(n.element,t)})).each(i)}))})),o(mw,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),hr((function(n){var e=t();_l.setValue(n,e.getData())}))])},yV=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=X(e,(function(t){return"start"===t.align})),r=function(t,n){return qx.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:U(n,(function(t){return t.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},xV=function(t,n){return{dom:ID('<div class="tox-dialog__footer"></div>'),components:[],behaviours:wc([lA.config({channel:JR,initialData:t,updateState:function(t,e){var o=U(e.buttons,(function(t){var e=bh(function(t,n){return QO(t,t.type,n)}(t,n));return{name:t.name,align:t.align,memento:e}}));return R.some({lookupByName:function(t,n){return function(t,n,e){return J(n,(function(t){return t.name===e})).bind((function(n){return n.memento.getOpt(t)}))}(t,o,n)},footerButtons:o})},renderComponents:yV})])}},wV=function(t,n){return nI.parts.footer(xV(t,n))},SV=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=Rd.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return cC.getField(e,n).fold((function(){var o=t.getFooter();return lA.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return R.some(t)}))}return R.none()},kV=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},i={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=_l.getValue(o),i=Mt(e,(function(t){return t.get()}));return _(_({},r),i)},setData:function(n){o((function(o){var r=i.getData(),u=_(_({},r),n),a=function(t,n){var e=t.getRoot();return lA.getState(e).get().map((function(t){return On(Cn("data",t.dataValidator,n))})).getOr(n)}(t,u),c=t.getFormWrapper();_l.setValue(c,a),At(e,(function(t,n){zt(u,n)&&t.set(u[n])}))}))},disable:function(n){SV(t,n).each(Kd.disable)},enable:function(n){SV(t,n).each(Kd.enable)},focus:function(n){SV(t,n).each(mp.focus)},block:function(t){if(!r(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(n){Zo(n,lw,{message:t})}))},unblock:function(){o((function(t){Qo(t,dw)}))},showTab:function(n){o((function(e){var o=t.getBody();lA.getState(o).get().exists((function(t){return t.isTabPanel()}))&&Rd.getCurrent(o).each((function(t){zR.showTab(t,n)}))}))},redial:function(t){o((function(e){var o=n(t);e.getSystem().broadcastOn([qR],o),e.getSystem().broadcastOn([YR],o.internalDialog),e.getSystem().broadcastOn([KR],o.internalDialog),e.getSystem().broadcastOn([JR],o.internalDialog),i.setData(o.initialData)}))},close:function(){o((function(t){Qo(t,aw)}))}};return i},CV=function(t,n,e){var o=fV(t.internalDialog.title,e),r=function(t,n){var e=QR(t,R.none(),n,!1);return nI.parts.body(e)}({body:t.internalDialog.body},e),i=gV(t.internalDialog.buttons),u=pV(i),a=wV({buttons:i},e),c=bV((function(){return m}),dV((function(){return l}),e.shared.providers,n),e.shared.getSink),s=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),f={header:o,body:r,footer:R.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=mV(f,t,c,e),d={getRoot:v(l),getBody:function(){return nI.getBody(l)},getFooter:function(){return nI.getFooter(l)},getFormWrapper:function(){var t=nI.getBody(l);return Rd.getCurrent(t).getOr(t)}},m=kV(d,n.redial,u);return{dialog:l,instanceApi:m}},OV=function(t,n,e,o){var r,i,u,a,c,s=di("dialog-label"),f=di("dialog-content"),l=bh((u={title:t.internalDialog.title,draggable:!0},a=s,c=e.shared.providers,qx.sketch({dom:ID('<div class="tox-dialog__header"></div>'),components:[cV(u,R.some(a),c),sV(),aV(c)],containerBehaviours:wc([NF.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return la(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=bh(function(t,n,e,o){return QR(t,R.some(n),e,o)}({body:t.internalDialog.body},f,e,o)),m=gV(t.internalDialog.buttons),g=pV(m),p=bh(function(t,n){return xV(t,n)}({buttons:m},e)),h=bV((function(){return y}),{onBlock:function(t){FD.block(b,(function(n,o){return lV(t.message,o,e.shared.providers)}))},onUnblock:function(){FD.unblock(b)},onClose:function(){return n.closeWindow()}},e.shared.getSink),b=Du({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=s,r["aria-describedby"]=f,r)},eventOrder:(i={},i[Bo()]=[lA.name(),Tc.name()],i[Ao()]=["execute-on-form"],i[jo()]=["reflecting","execute-on-form"],i),behaviours:wc([np.config({mode:"cyclic",onEscape:function(t){return Qo(t,aw),R.some(!0)},useTabstopAt:function(t){return!PC(t)&&("button"!==xr(t)||"disabled"!==ei(t,"disabled"))}}),lA.config({channel:qR,updateState:function(t,n){return R.some(n)},initialData:t}),mp.config({}),cp("execute-on-form",h.concat([gr(go(),(function(t,n){np.focusIn(t)}))])),FD.config({getRoot:function(){return R.some(b)}}),ap.config({}),DC({})]),components:[l.asSpec(),d.asSpec(),p.asSpec()]}),y=kV({getRoot:v(b),getFooter:function(){return p.get(b)},getBody:function(){return d.get(b)},getFormWrapper:function(){var t=d.get(b);return Rd.getCurrent(t).getOr(t)}},n.redial,g);return{dialog:b,instanceApi:y}},_V=tinymce.util.Tools.resolve("tinymce.util.URI"),TV=["insertContent","setContent","execCommand","close","block","unblock"],EV=function(t){return i(t)&&-1!==TV.indexOf(t.mceAction)},DV=function(t,n,e,o){var u,a,s,f=fV(t.title,o),l=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[IC({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:wc([tw.config({}),mp.config({})])})]}],behaviours:wc([np.config({mode:"acyclic",useTabstopAt:w(PC)})])};return nI.parts.body(n)}(t),d=t.buttons.bind((function(t){return 0===t.length?R.none():R.some(wV({buttons:t},o))})),m=vV((function(){return S}),dV((function(){return x}),o.shared.providers,n)),g=_(_({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),p=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],h=new _V(t.url,{base_uri:new _V(window.location.href)}),v=h.protocol+"://"+h.host+(h.port?":"+h.port:""),b=$c(),y=[cp("messages",[pr((function(){var n=ts(ie.fromDom(window),"message",(function(n){if(h.isSameOrigin(new _V(n.raw.origin))){var o=n.raw.data;EV(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!c(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,S,o):function(t){return!EV(t)&&i(t)&&zt(t,"mceAction")}(o)&&t.onMessage(S,o)}}));b.set(n)})),hr(b.clear)]),Tc.config({channels:(u={},u[$R]={onReceive:function(t,n){fa(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,v)}))}},u)})],x=mV({header:f,body:l,footer:d,extraClasses:p,extraBehaviours:y,extraStyles:g},t,m,o),S=(a=x,s=function(t){a.getSystem().isConnected()&&t(a)},{block:function(t){if(!r(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");s((function(n){Zo(n,lw,{message:t})}))},unblock:function(){s((function(t){Qo(t,dw)}))},close:function(){s((function(t){Qo(t,aw)}))},sendMessage:function(t){s((function(n){n.getSystem().broadcastOn([$R],t)}))}});return{dialog:x,instanceApi:S}},BV=function(t,n,e){return n&&e?[]:[zE.config({contextual:{lazyContext:function(){return R.some(ta(ie.fromDom(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},AV=function(t){var n=t.backstage,e=t.editor,o=Pb(e),r=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(){nI.hide(c),o()},i=bh(QO({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:R.none()},"cancel",t.backstage)),u=eV(),a=nV(r,n.providers),c=Du(uV({lazySink:function(){return n.getSink()},header:tV(u,a),body:oV(e,n.providers),footer:R.some(rV(iV([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[ar(cw,r)],eventOrder:{}}));nI.show(c);var s=i.get(c);mp.focus(s)}}}(t),i=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(t){nI.hide(s),o(t)},i=bh(QO({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:R.none()},"submit",t.backstage)),u=QO({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:R.none()},"cancel",t.backstage),a=eV(),c=nV((function(){return r(!1)}),n.providers),s=Du(uV({lazySink:function(){return n.getSink()},header:tV(a,c),body:oV(e,n.providers),footer:R.some(rV(iV([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[ar(cw,(function(){return r(!1)})),ar(fw,(function(){return r(!0)}))],eventOrder:{}}));nI.show(s);var f=i.get(s);mp.focus(f)}}}(t),u=function(t,o){return _R.openUrl((function(t){var r=DV(t,{closeWindow:function(){nI.hide(r.dialog),o(r.instanceApi)}},e,n);return nI.show(r.dialog),r.instanceApi}),t)},a=function(t,e){return _R.open((function(t,o,r){var i=o,u=CV({dataValidator:r,initialData:i,internalDialog:t},{redial:_R.redial,closeWindow:function(){nI.hide(u.dialog),e(u.instanceApi)}},n);return nI.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),t)},c=function(t,r,i,u){return _R.open((function(t,a,c){var s=On(Cn("data",c,a)),f=Qc(),l=n.shared.header.isPositionedAtTop(),d=function(){return f.on((function(t){Jp.reposition(t),zE.refresh(t)}))},m=OV({dataValidator:c,initialData:s,internalDialog:t},{redial:_R.redial,closeWindow:function(){f.on(Jp.hide),e.off("ResizeEditor",d),f.clear(),i(m.instanceApi)}},n,u),g=Du(Jp.sketch(_(_({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},l?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:wc(E([cp("window-manager-inline-events",[ar(Uo(),(function(t,n){Qo(m.dialog,cw)}))])],BV(e,o,l))),isExtraPart:function(t,n){return function(t){return Mx(t,".tox-alert-dialog")||Mx(t,".tox-confirm-dialog")}(n)}})));return f.set(g),Jp.showWithin(g,Bu(m.dialog),{anchor:r},R.some(ou())),o&&l||(zE.refresh(g),e.on("ResizeEditor",d)),m.instanceApi.setData(s),np.focusIn(m.dialog),m.instanceApi}),t)};return{open:function(t,e,o){return void 0!==e&&"toolbar"===e.inline?c(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?c(t,n.shared.anchors.cursor(),o,e.ariaAttrs):a(t,o)},openUrl:function(t,n){return u(t,n)},alert:function(t,n){r.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){i.open(t,(function(t){n(t)}))}}};O.add("silver",(function(t){var n=$F(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;Ax(t,o.shared);var u=AV({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:v(u),getNotificationManagerImpl:function(){return Ah(0,{backstage:o},e)},ui:i()}}))}()}).call(this,e(46))},2251:function(t,n,e){e(2143)}}]);