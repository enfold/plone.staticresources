{"version":3,"file":"chunks/17663.53902865b9bee1ccf8b9.min.js","mappings":"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I,kHACJ,qDACJ,YACJ,gBAAgBC,KAAK,MAEzBlH,EAAEqB,SAAS,iBAAkB4F,GAE7B,IAAIE,EAAc,CAAC,0BACf,uBACI,mBACI,mDACA,6EACJ,UACA,6DACJ,SACA,4DAA4DD,KAAK,MAErElH,EAAEqB,SAAS,cAAe8F,GAE1B,IAAIC,EAAW,CAAC,uBACR,SACI,yBACA,gDACA,SACA,yBACI,+CACI,yBACJ,WACA,6DACI,qBACI,8DACJ,YACJ,YACJ,QACA,0BACI,6CACI,mDACI,yBACJ,WACA,sBACI,8BACI,YACA,yBACA,+BACJ,yBACJ,SACJ,SACA,8CACI,oDACI,0BACJ,WACA,sBACI,8BACI,YACA,0BACA,+BACJ,0BACJ,SACJ,SACA,8CACI,kFACA,sBACI,2BACI,gCACI,yBACI,6CACA,gDACA,iCACJ,8FACJ,SACJ,YACJ,SACJ,SACA,+CACI,gFACA,sBACI,8BACI,aACA,6BACJ,2BACJ,SACJ,SACA,8CACI,2EACA,sBACI,QACI,SACI,eACA,qBACA,uBACA,wCACJ,8CACI,6BACJ,WACA,wCACI,oCACJ,qDACQ,+CACJ,+CACJ,YACA,YACA,6BACJ,SACA,QACI,SACI,eACA,yBACA,uBACA,4CACJ,kDACI,iCACJ,WACA,+CACI,6BACI,6DACJ,YACJ,YACA,iCACA,0CACI,2BACI,wEACJ,YACJ,YACA,iCACJ,SACJ,SACJ,SACA,8CACI,8EACA,sBACI,8BACI,aACA,4BACJ,0BACJ,SACJ,SACA,6CACI,yEACA,sBACI,QACI,SACI,eACA,qBACA,sBACA,uCACJ,6CACI,4BACJ,WACA,0CACA,uBACI,iDACJ,YACA,YACA,4BACA,wCACA,qDACQ,+CACJ,+CACJ,YACA,YACA,4BACJ,SACA,QACI,SACI,eACA,yBACA,sBACA,0CACJ,iDACI,gCACJ,WACA,8CACA,6BACI,6DACJ,YACA,YACA,iDACI,gCACJ,WACA,4CACA,2BACI,wEACJ,YACA,YACA,gCACA,8CACA,uBACI,iDACJ,YACA,YACA,gCACJ,SACJ,SACJ,SACA,4CACI,6CACA,sBACE,gCACE,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","sources":["webpack://plone.staticresources/../mockup/node_modules/jquery.recurrenceinput.js/src/jquery.recurrenceinput.js"],"sourcesContent":["/*jslint regexp: false, continue: true, indent: 4 */\n/*global $, alert, jQuery */\n\"use strict\";\n\n(function ($) {\n    $.tools = $.tools || {version: '@VERSION'};\n\n    var tool;\n    var LABELS = {};\n\n    tool = $.tools.recurrenceinput = {\n        conf: {\n            lang: 'en',\n            readOnly: false,\n            firstDay: 0,\n\n            // \"REMOTE\" FIELD\n            startField: null,\n            startFieldYear: null,\n            startFieldMonth: null,\n            startFieldDay: null,\n            ajaxURL: null,\n            ajaxContentType: 'application/json; charset=utf8',\n            ributtonExtraClass: '',\n\n            // INPUT CONFIGURATION\n            hasRepeatForeverButton: true,\n\n            // FORM OVERLAY\n            formOverlay: {\n                speed: 'fast',\n                fixed: false\n            },\n\n            // JQUERY TEMPLATE NAMES\n            template: {\n                form: '#jquery-recurrenceinput-form-tmpl',\n                display: '#jquery-recurrenceinput-display-tmpl'\n            },\n\n            // RECURRENCE TEMPLATES\n            rtemplate: {\n                daily: {\n                    rrule: 'FREQ=DAILY',\n                    fields: [\n                        'ridailyinterval',\n                        'rirangeoptions'\n                    ]\n                },\n                mondayfriday: {\n                    rrule: 'FREQ=WEEKLY;BYDAY=MO,FR',\n                    fields: [\n                        'rirangeoptions'\n                    ]\n                },\n                weekdays: {\n                    rrule: 'FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR',\n                    fields: [\n                        'rirangeoptions'\n                    ]\n                },\n                weekly: {\n                    rrule: 'FREQ=WEEKLY',\n                    fields: [\n                        'riweeklyinterval',\n                        'riweeklyweekdays',\n                        'rirangeoptions'\n                    ]\n                },\n                monthly: {\n                    rrule: 'FREQ=MONTHLY',\n                    fields: [\n                        'rimonthlyinterval',\n                        'rimonthlyoptions',\n                        'rirangeoptions'\n                    ]\n                },\n                yearly: {\n                    rrule: 'FREQ=YEARLY',\n                    fields: [\n                        'riyearlyinterval',\n                        'riyearlyoptions',\n                        'rirangeoptions'\n                    ]\n                }\n            }\n        },\n\n        localize: function (language, labels) {\n            LABELS[language] = labels;\n        },\n\n        setTemplates: function (templates, titles) {\n            var lang, template;\n            tool.conf.rtemplate = templates;\n            for (lang in titles) {\n                if (titles.hasOwnProperty(lang)) {\n                    for (template in titles[lang]) {\n                        if (titles[lang].hasOwnProperty(template)) {\n                            LABELS[lang].rtemplate[template] = titles[lang][template];\n                        }\n                    }\n                }\n            }\n        }\n\n    };\n\n    tool.localize(\"en\", {\n        displayUnactivate: 'Does not repeat',\n        displayActivate: 'Repeats every',\n        add_rules: 'Add',\n        edit_rules: 'Edit',\n        delete_rules: 'Delete',\n        add:  'Add',\n        refresh: 'Refresh',\n\n        title: 'Repeat',\n        preview: 'Selected dates',\n        addDate: 'Add date',\n\n        recurrenceType: 'Repeats:',\n\n        dailyInterval1: 'Repeat every:',\n        dailyInterval2: 'days',\n\n        weeklyInterval1: 'Repeat every:',\n        weeklyInterval2: 'week(s)',\n        weeklyWeekdays: 'Repeat on:',\n        weeklyWeekdaysHuman: 'on:',\n\n        monthlyInterval1: 'Repeat every:',\n        monthlyInterval2: 'month(s)',\n        monthlyDayOfMonth1: 'Day',\n        monthlyDayOfMonth1Human: 'on day',\n        monthlyDayOfMonth2: 'of the month',\n        monthlyDayOfMonth3: 'month(s)',\n        monthlyWeekdayOfMonth1: 'The',\n        monthlyWeekdayOfMonth1Human: 'on the',\n        monthlyWeekdayOfMonth2: '',\n        monthlyWeekdayOfMonth3: 'of the month',\n        monthlyRepeatOn: 'Repeat on:',\n\n        yearlyInterval1: 'Repeat every:',\n        yearlyInterval2: 'year(s)',\n        yearlyDayOfMonth1: 'Every',\n        yearlyDayOfMonth1Human: 'on',\n        yearlyDayOfMonth2: '',\n        yearlyDayOfMonth3: '',\n        yearlyWeekdayOfMonth1: 'The',\n        yearlyWeekdayOfMonth1Human: 'on the',\n        yearlyWeekdayOfMonth2: '',\n        yearlyWeekdayOfMonth3: 'of',\n        yearlyWeekdayOfMonth4: '',\n        yearlyRepeatOn: 'Repeat on:',\n\n        range: 'End recurrence:',\n        rangeNoEnd: 'Never',\n        rangeByOccurrences1: 'After',\n        rangeByOccurrences1Human: 'ends after',\n        rangeByOccurrences2: 'occurrence(s)',\n        rangeByEndDate: 'On',\n        rangeByEndDateHuman: 'ends on',\n\n        including: ', and also',\n        except: ', except for',\n\n        cancel: 'Cancel',\n        save: 'Save',\n\n        recurrenceStart: 'Start of the recurrence',\n        additionalDate: 'Additional date',\n        include: 'Include',\n        exclude: 'Exclude',\n        remove: 'Remove',\n\n        orderIndexes: ['first', 'second', 'third', 'fourth', 'last'],\n        months: [\n            'January', 'February', 'March', 'April', 'May', 'June',\n            'July', 'August', 'September', 'October', 'November', 'December'],\n        shortMonths: [\n            'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',\n            'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n        weekdays: [\n            'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday',\n            'Friday', 'Saturday'],\n        shortWeekdays: [\n            'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n\n        longDateFormat: 'mmmm dd, yyyy',\n        shortDateFormat: 'mm/dd/yyyy',\n\n        unsupportedFeatures: 'Warning: This event uses recurrence features not ' +\n                              'supported by this widget. Saving the recurrence ' +\n                              'may change the recurrence in unintended ways:',\n        noTemplateMatch: 'No matching recurrence template',\n        multipleDayOfMonth: 'This widget does not support multiple days in monthly or yearly recurrence',\n        bysetpos: 'BYSETPOS is not supported',\n        noRule: 'No RRULE in RRULE data',\n        noRepeatEvery: 'Error: The \"Repeat every\"-field must be between 1 and 1000',\n        noEndDate: 'Error: End date is not set. Please set a correct value',\n        noRepeatOn: 'Error: \"Repeat on\"-value must be selected',\n        pastEndDate: 'Error: End date cannot be before start date',\n        noEndAfterNOccurrences: 'Error: The \"After N occurrences\"-field must be between 1 and 1000',\n        alreadyAdded: 'This date was already added',\n\n        rtemplate: {\n            daily: 'Daily',\n            mondayfriday: 'Monday and Friday',\n            weekdays: 'Weekday',\n            weekly: 'Weekly',\n            monthly: 'Monthly',\n            yearly: 'Yearly'\n        }\n    });\n\n\n    var OCCURRENCETMPL = ['<div class=\"rioccurrences\">',\n        '{{each occurrences}}',\n            '<div class=\"occurrence ${occurrences[$index].type}\">',\n                '<span>',\n                    '${occurrences[$index].formattedDate}',\n                    '{{if occurrences[$index].type === \"start\"}}',\n                        '<span class=\"rlabel\">${i18n.recurrenceStart}</span>',\n                    '{{/if}}',\n                    '{{if occurrences[$index].type === \"rdate\"}}',\n                        '<span class=\"rlabel\">${i18n.additionalDate}</span>',\n                    '{{/if}}',\n                '</span>',\n                '{{if !readOnly}}',\n                    '<span class=\"action\">',\n                        '{{if occurrences[$index].type === \"rrule\"}}',\n                            '<a date=\"${occurrences[$index].date}\" href=\"#\"',\n                               'class=\"${occurrences[$index].type}\" title=\"${i18n.exclude}\">',\n                                '${i18n.exclude}',\n                            '</a>',\n                        '{{/if}}',\n                        '{{if occurrences[$index].type === \"rdate\"}}',\n                            '<a date=\"${occurrences[$index].date}\" href=\"#\"',\n                               'class=\"${occurrences[$index].type}\" title=\"${i18n.remove}\" >',\n                                '${i18n.remove}',\n                            '</a>',\n                        '{{/if}}',\n                        '{{if occurrences[$index].type === \"exdate\"}}',\n                            '<a date=\"${occurrences[$index].date}\" href=\"#\"',\n                               'class=\"${occurrences[$index].type}\" title=\"${i18n.include}\">',\n                                '${i18n.include}',\n                            '</a>',\n                        '{{/if}}',\n                    '</span>',\n                '{{/if}}',\n            '</div>',\n        '{{/each}}',\n        '<div class=\"batching\">',\n            '{{each batch.batches}}',\n                '{{if $index === batch.currentBatch}}<span class=\"current\">{{/if}}',\n                    '<a href=\"#\" start=\"${batch.batches[$index][0]}\">[${batch.batches[$index][0]} - ${batch.batches[$index][1]}]</a>',\n                '{{if $index === batch.currentBatch}}</span>{{/if}}',\n            '{{/each}}',\n        '</div></div>'].join('\\n');\n\n    $.template('occurrenceTmpl', OCCURRENCETMPL);\n\n    var DISPLAYTMPL = ['<div class=\"ridisplay\">',\n        '<div class=\"rimain\">',\n            '{{if !readOnly}}',\n                '<button name=\"riedit\">${i18n.add_rules}</button>',\n                '<button name=\"ridelete\" style=\"display:none\">${i18n.delete_rules}</button>',\n            '{{/if}}',\n            '<label class=\"ridisplay\">${i18n.displayUnactivate}</label>',\n        '</div>',\n        '<div class=\"rioccurrences\" style=\"display:none\" /></div>'].join('\\n');\n\n    $.template('displayTmpl', DISPLAYTMPL);\n\n    var FORMTMPL = ['<div class=\"riform\">',\n            '<form>',\n                '<h1>${i18n.title}</h1>',\n                '<div id=\"messagearea\" style=\"display: none;\">',\n                '</div>',\n                '<div id=\"rirtemplate\">',\n                    '<label for=\"${name}rtemplate\" class=\"label\">',\n                        '${i18n.recurrenceType}',\n                    '</label>',\n                    '<select id=\"rirtemplate\" name=\"rirtemplate\" class=\"field\">',\n                        '{{each rtemplate}}',\n                            '<option value=\"${$index}\">${i18n.rtemplate[$index]}</value>',\n                        '{{/each}}',\n                    '</select>',\n                '<div>',\n                '<div id=\"riformfields\">',\n                    '<div id=\"ridailyinterval\" class=\"rifield\">',\n                        '<label for=\"${name}dailyinterval\" class=\"label\">',\n                            '${i18n.dailyInterval1}',\n                        '</label>',\n                        '<div class=\"field\">',\n                            '<input type=\"text\" size=\"2\"',\n                                'value=\"1\"',\n                                'name=\"ridailyinterval\"',\n                                'id=\"${name}dailyinterval\" />',\n                            '${i18n.dailyInterval2}',\n                        '</div>',\n                    '</div>',\n                    '<div id=\"riweeklyinterval\" class=\"rifield\">',\n                        '<label for=\"${name}weeklyinterval\" class=\"label\">',\n                            '${i18n.weeklyInterval1}',\n                        '</label>',\n                        '<div class=\"field\">',\n                            '<input type=\"text\" size=\"2\"',\n                                'value=\"1\"',\n                                'name=\"riweeklyinterval\"',\n                                'id=\"${name}weeklyinterval\"/>',\n                            '${i18n.weeklyInterval2}',\n                        '</div>',\n                    '</div>',\n                    '<div id=\"riweeklyweekdays\" class=\"rifield\">',\n                        '<label for=\"${name}weeklyinterval\" class=\"label\">${i18n.weeklyWeekdays}</label>',\n                        '<div class=\"field\">',\n                            '{{each orderedWeekdays}}',\n                                '<div class=\"riweeklyweekday\">',\n                                    '<input type=\"checkbox\"',\n                                        'name=\"riweeklyweekdays${weekdays[$value]}\"',\n                                        'id=\"${name}weeklyWeekdays${weekdays[$value]}\"',\n                                        'value=\"${weekdays[$value]}\" />',\n                                    '<label for=\"${name}weeklyWeekdays${weekdays[$value]}\">${i18n.shortWeekdays[$value]}</label>',\n                                '</div>',\n                            '{{/each}}',\n                        '</div>',\n                    '</div>',\n                    '<div id=\"rimonthlyinterval\" class=\"rifield\">',\n                        '<label for=\"rimonthlyinterval\" class=\"label\">${i18n.monthlyInterval1}</label>',\n                        '<div class=\"field\">',\n                            '<input type=\"text\" size=\"2\"',\n                                'value=\"1\" ',\n                                'name=\"rimonthlyinterval\"/>',\n                            '${i18n.monthlyInterval2}',\n                        '</div>',\n                    '</div>',\n                    '<div id=\"rimonthlyoptions\" class=\"rifield\">',\n                        '<label for=\"rimonthlytype\" class=\"label\">${i18n.monthlyRepeatOn}</label>',\n                        '<div class=\"field\">',\n                            '<div>',\n                                '<input',\n                                    'type=\"radio\"',\n                                    'value=\"DAYOFMONTH\"',\n                                    'name=\"rimonthlytype\"',\n                                    'id=\"${name}monthlytype:DAYOFMONTH\" />',\n                                '<label for=\"${name}monthlytype:DAYOFMONTH\">',\n                                    '${i18n.monthlyDayOfMonth1}',\n                                '</label>',\n                                '<select name=\"rimonthlydayofmonthday\"',\n                                    'id=\"${name}monthlydayofmonthday\">',\n                                '{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,',\n                                        '18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}',\n                                    '<option value=\"${$value}\">${$value}</option>',\n                                '{{/each}}',\n                                '</select>',\n                                '${i18n.monthlyDayOfMonth2}',\n                            '</div>',\n                            '<div>',\n                                '<input',\n                                    'type=\"radio\"',\n                                    'value=\"WEEKDAYOFMONTH\"',\n                                    'name=\"rimonthlytype\"',\n                                    'id=\"${name}monthlytype:WEEKDAYOFMONTH\" />',\n                                '<label for=\"${name}monthlytype:WEEKDAYOFMONTH\">',\n                                    '${i18n.monthlyWeekdayOfMonth1}',\n                                '</label>',\n                                '<select name=\"rimonthlyweekdayofmonthindex\">',\n                                    '{{each i18n.orderIndexes}}',\n                                        '<option value=\"${orderIndexes[$index]}\">${$value}</option>',\n                                    '{{/each}}',\n                                '</select>',\n                                '${i18n.monthlyWeekdayOfMonth2}',\n                                '<select name=\"rimonthlyweekdayofmonth\">',\n                                    '{{each orderedWeekdays}}',\n                                        '<option value=\"${weekdays[$value]}\">${i18n.weekdays[$value]}</option>',\n                                    '{{/each}}',\n                                '</select>',\n                                '${i18n.monthlyWeekdayOfMonth3}',\n                            '</div>',\n                        '</div>',\n                    '</div>',\n                    '<div id=\"riyearlyinterval\" class=\"rifield\">',\n                        '<label for=\"riyearlyinterval\" class=\"label\">${i18n.yearlyInterval1}</label>',\n                        '<div class=\"field\">',\n                            '<input type=\"text\" size=\"2\"',\n                                'value=\"1\" ',\n                                'name=\"riyearlyinterval\"/>',\n                            '${i18n.yearlyInterval2}',\n                        '</div>',\n                    '</div>',\n                    '<div id=\"riyearlyoptions\" class=\"rifield\">',\n                        '<label for=\"riyearlyType\" class=\"label\">${i18n.yearlyRepeatOn}</label>',\n                        '<div class=\"field\">',\n                            '<div>',\n                                '<input',\n                                    'type=\"radio\"',\n                                    'value=\"DAYOFMONTH\"',\n                                    'name=\"riyearlyType\"',\n                                    'id=\"${name}yearlytype:DAYOFMONTH\" />',\n                                '<label for=\"${name}yearlytype:DAYOFMONTH\">',\n                                    '${i18n.yearlyDayOfMonth1}',\n                                '</label>',\n                                '<select name=\"riyearlydayofmonthmonth\">',\n                                '{{each i18n.months}}',\n                                    '<option value=\"${$index+1}\">${$value}</option>',\n                                '{{/each}}',\n                                '</select>',\n                                '${i18n.yearlyDayOfMonth2}',\n                                '<select name=\"riyearlydayofmonthday\">',\n                                '{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,',\n                                        '18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}',\n                                    '<option value=\"${$value}\">${$value}</option>',\n                                '{{/each}}',\n                                '</select>',\n                                '${i18n.yearlyDayOfMonth3}',\n                            '</div>',\n                            '<div>',\n                                '<input',\n                                    'type=\"radio\"',\n                                    'value=\"WEEKDAYOFMONTH\"',\n                                    'name=\"riyearlyType\"',\n                                    'id=\"${name}yearlytype:WEEKDAYOFMONTH\"/>',\n                                '<label for=\"${name}yearlytype:WEEKDAYOFMONTH\">',\n                                    '${i18n.yearlyWeekdayOfMonth1}',\n                                '</label>',\n                                '<select name=\"riyearlyweekdayofmonthindex\">',\n                                '{{each i18n.orderIndexes}}',\n                                    '<option value=\"${orderIndexes[$index]}\">${$value}</option>',\n                                '{{/each}}',\n                                '</select>',\n                                '<label for=\"${name}yearlytype:WEEKDAYOFMONTH\">',\n                                    '${i18n.yearlyWeekdayOfMonth2}',\n                                '</label>',\n                                '<select name=\"riyearlyweekdayofmonthday\">',\n                                '{{each orderedWeekdays}}',\n                                    '<option value=\"${weekdays[$value]}\">${i18n.weekdays[$value]}</option>',\n                                '{{/each}}',\n                                '</select>',\n                                '${i18n.yearlyWeekdayOfMonth3}',\n                                '<select name=\"riyearlyweekdayofmonthmonth\">',\n                                '{{each i18n.months}}',\n                                    '<option value=\"${$index+1}\">${$value}</option>',\n                                '{{/each}}',\n                                '</select>',\n                                '${i18n.yearlyWeekdayOfMonth4}',\n                            '</div>',\n                        '</div>',\n                    '</div>',\n                    '<div id=\"rirangeoptions\" class=\"rifield\">',\n                        '<label class=\"label\">${i18n.range}</label>',\n                        '<div class=\"field\">',\n                          '{{if hasRepeatForeverButton}}',\n                            '<div>',\n                                '<input',\n                                    'type=\"radio\"',\n                                    'value=\"NOENDDATE\"',\n                                    'name=\"rirangetype\"',\n                                    'id=\"${name}rangetype:NOENDDATE\"/>',\n                                '<label for=\"${name}rangetype:NOENDDATE\">',\n                                    '${i18n.rangeNoEnd}',\n                                '</label>',\n                            '</div>',\n                          '{{/if}}',\n                            '<div>',\n                                '<input',\n                                    'type=\"radio\"',\n                                    'checked=\"checked\"',\n                                    'value=\"BYOCCURRENCES\"',\n                                    'name=\"rirangetype\"',\n                                    'id=\"${name}rangetype:BYOCCURRENCES\"/>',\n                                '<label for=\"${name}rangetype:BYOCCURRENCES\">',\n                                    '${i18n.rangeByOccurrences1}',\n                                '</label>',\n                                '<input',\n                                    'type=\"text\" size=\"3\"',\n                                    'value=\"7\"',\n                                    'name=\"rirangebyoccurrencesvalue\" />',\n                                '${i18n.rangeByOccurrences2}',\n                            '</div>',\n                            '<div>',\n                                '<input',\n                                    'type=\"radio\"',\n                                    'value=\"BYENDDATE\"',\n                                    'name=\"rirangetype\"',\n                                    'id=\"${name}rangetype:BYENDDATE\"/>',\n                                '<label for=\"${name}rangetype:BYENDDATE\">',\n                                    '${i18n.rangeByEndDate}',\n                                '</label>',\n                                '<input',\n                                    'type=\"date\"',\n                                    'name=\"rirangebyenddatecalendar\" />',\n                            '</div>',\n                        '</div>',\n                    '</div>',\n                '</div>',\n                '<div class=\"rioccurrencesactions\">',\n                    '<div class=\"rioccurancesheader\">',\n                        '<h2>${i18n.preview}</h2>',\n                        '<span class=\"refreshbutton action\">',\n                            '<a class=\"rirefreshbutton\" href=\"#\" title=\"${i18n.refresh}\">',\n                                '${i18n.refresh}',\n                            '</a>',\n                        '</span>',\n                    '</div>',\n                '</div>',\n                '<div class=\"rioccurrences\">',\n                '</div>',\n                '<div class=\"rioccurrencesactions\">',\n                    '<div class=\"rioccurancesheader\">',\n                        '<h2>${i18n.addDate}</h2>',\n                    '</div>',\n                    '<div class=\"riaddoccurrence\">',\n                        '<div class=\"errorarea\"></div>',\n                        '<input type=\"date\" name=\"adddate\" id=\"adddate\" />',\n                        '<input type=\"button\" name=\"addaction\" id=\"addaction\" value=\"${i18n.add}\">',\n                    '</div>',\n                '</div>',\n\n                '<div class=\"ributtons\">',\n                    '<input',\n                        'type=\"submit\"',\n                        'class=\"ricancelbutton ${ributtonExtraClass}\"',\n                        'value=\"${i18n.cancel}\" />',\n                    '<input',\n                        'type=\"submit\"',\n                        'class=\"risavebutton ${ributtonExtraClass}\"',\n                        'value=\"${i18n.save}\" />',\n                '</div>',\n            '</form></div>'].join('\\n');\n\n    $.template('formTmpl', FORMTMPL);\n\n    // Formatting function (mostly) from jQueryTools dateinput\n    var Re = /d{1,4}|m{1,4}|yy(?:yy)?|\"[^\"]*\"|'[^']*'/g;\n\n    function zeropad(val, len) {\n        val = val.toString();\n        len = len || 2;\n        while (val.length < len) { val = \"0\" + val; }\n        return val;\n    }\n\n    function format(date, fmt, conf) {\n        var d = date.getDate(),\n            D = date.getDay(),\n            m = date.getMonth(),\n            y = date.getFullYear(),\n\n            flags = {\n                d:    d,\n                dd:   zeropad(d),\n                ddd:  conf.i18n.shortWeekdays[D],\n                dddd: conf.i18n.weekdays[D],\n                m:    m + 1,\n                mm:   zeropad(m + 1),\n                mmm:  conf.i18n.shortMonths[m],\n                mmmm: conf.i18n.months[m],\n                yy:   String(y).slice(2),\n                yyyy: y\n            };\n\n        var result = fmt.replace(Re, function ($0) {\n            return flags.hasOwnProperty($0) ? flags[$0] : $0.slice(1, $0.length - 1);\n        });\n\n        return result;\n\n    }\n\n    /**\n     * Parsing RFC5545 from widget\n     */\n    function widgetSaveToRfc5545(form, conf, tz) {\n        var value = form.find('select[name=rirtemplate]').val();\n        var rtemplate = conf.rtemplate[value];\n        var result = rtemplate.rrule;\n        var human = conf.i18n.rtemplate[value];\n        var field, input, weekdays, i18nweekdays, i, j, index, tmp;\n        var day, month, year, interval, yearlyType, occurrences, date;\n\n        for (i = 0; i < rtemplate.fields.length; i++) {\n            field = form.find('#' + rtemplate.fields[i]);\n\n            switch (field.attr('id')) {\n\n            case 'ridailyinterval':\n                interval = field.find('input[name=ridailyinterval]').val();\n                if (interval !== '1') {\n                    result += ';INTERVAL=' + interval;\n                }\n                human = interval + ' ' + conf.i18n.dailyInterval2;\n                break;\n\n            case 'riweeklyinterval':\n                interval = field.find('input[name=riweeklyinterval]').val();\n                if (interval !== '1') {\n                    result += ';INTERVAL=' + interval;\n                }\n                human = interval + ' ' + conf.i18n.weeklyInterval2;\n                break;\n\n            case 'riweeklyweekdays':\n                weekdays = '';\n                i18nweekdays = '';\n                for (j = 0; j < conf.weekdays.length; j++) {\n                    input = field.find('input[name=riweeklyweekdays' + conf.weekdays[j] + ']');\n                    if (input.is(':checked')) {\n                        if (weekdays) {\n                            weekdays += ',';\n                            i18nweekdays += ', ';\n                        }\n                        weekdays += conf.weekdays[j];\n                        i18nweekdays += conf.i18n.weekdays[j];\n                    }\n                }\n                if (weekdays) {\n                    result += ';BYDAY=' + weekdays;\n                    human += ' ' + conf.i18n.weeklyWeekdaysHuman + ' ' + i18nweekdays;\n                }\n                break;\n\n            case 'rimonthlyinterval':\n                interval = field.find('input[name=rimonthlyinterval]').val();\n                if (interval !== '1') {\n                    result += ';INTERVAL=' + interval;\n                }\n                human = interval + ' ' + conf.i18n.monthlyInterval2;\n                break;\n\n            case 'rimonthlyoptions':\n                var monthlyType = $('input[name=rimonthlytype]:checked', form).val();\n                switch (monthlyType) {\n\n                case 'DAYOFMONTH':\n                    day = $('select[name=rimonthlydayofmonthday]', form).val();\n                    result += ';BYMONTHDAY=' + day;\n                    human += ', ' + conf.i18n.monthlyDayOfMonth1Human + ' ' + day + ' ' + conf.i18n.monthlyDayOfMonth2;\n                    break;\n                case 'WEEKDAYOFMONTH':\n                    index = $('select[name=rimonthlyweekdayofmonthindex]', form).val();\n                    day = $('select[name=rimonthlyweekdayofmonth]', form).val();\n                    if ($.inArray(day, ['MO', 'TU', 'WE', 'TH', 'FR', 'SA', 'SU']) > -1) {\n                        result += ';BYDAY=' + index + day;\n                        human += ', ' + conf.i18n.monthlyWeekdayOfMonth1Human + ' ';\n                        human += ' ' + conf.i18n.orderIndexes[$.inArray(index, conf.orderIndexes)];\n                        human += ' ' + conf.i18n.monthlyWeekdayOfMonth2;\n                        human += ' ' + conf.i18n.weekdays[$.inArray(day, conf.weekdays)];\n                        human += ' ' + conf.i18n.monthlyDayOfMonth2;\n                    }\n                    break;\n                }\n                break;\n\n            case 'riyearlyinterval':\n                interval = field.find('input[name=riyearlyinterval]').val();\n                if (interval !== '1') {\n                    result += ';INTERVAL=' + interval;\n                }\n                human = interval + ' ' + conf.i18n.yearlyInterval2;\n                break;\n\n            case 'riyearlyoptions':\n                yearlyType = $('input[name=riyearlyType]:checked', form).val();\n                switch (yearlyType) {\n\n                case 'DAYOFMONTH':\n                    month = $('select[name=riyearlydayofmonthmonth]', form).val();\n                    day = $('select[name=riyearlydayofmonthday]', form).val();\n                    result += ';BYMONTH=' + month;\n                    result += ';BYMONTHDAY=' + day;\n                    human += ', ' + conf.i18n.yearlyDayOfMonth1Human + ' ' + conf.i18n.months[month - 1] + ' ' + day;\n                    break;\n                case 'WEEKDAYOFMONTH':\n                    index = $('select[name=riyearlyweekdayofmonthindex]', form).val();\n                    day = $('select[name=riyearlyweekdayofmonthday]', form).val();\n                    month = $('select[name=riyearlyweekdayofmonthmonth]', form).val();\n                    result += ';BYMONTH=' + month;\n                    if ($.inArray(day, ['MO', 'TU', 'WE', 'TH', 'FR', 'SA', 'SU']) > -1) {\n                        result += ';BYDAY=' + index + day;\n                        human += ', ' + conf.i18n.yearlyWeekdayOfMonth1Human;\n                        human += ' ' + conf.i18n.orderIndexes[$.inArray(index, conf.orderIndexes)];\n                        human += ' ' + conf.i18n.yearlyWeekdayOfMonth2;\n                        human += ' ' + conf.i18n.weekdays[$.inArray(day, conf.weekdays)];\n                        human += ' ' + conf.i18n.yearlyWeekdayOfMonth3;\n                        human += ' ' + conf.i18n.months[month - 1];\n                        human += ' ' + conf.i18n.yearlyWeekdayOfMonth4;\n                    }\n                    break;\n                }\n                break;\n\n            case 'rirangeoptions':\n                var rangeType = form.find('input[name=rirangetype]:checked').val();\n                switch (rangeType) {\n\n                case 'BYOCCURRENCES':\n                    occurrences = form.find('input[name=rirangebyoccurrencesvalue]').val();\n                    result += ';COUNT=' + occurrences;\n                    human += ', ' + conf.i18n.rangeByOccurrences1Human;\n                    human += ' ' + occurrences;\n                    human += ' ' + conf.i18n.rangeByOccurrences2;\n                    break;\n                case 'BYENDDATE':\n                    field = form.find('input[name=rirangebyenddatecalendar]');\n                    date = field.data('dateinput').getValue('yyyymmdd');\n                    result += ';UNTIL=' + date + 'T000000';\n                    if (tz === true) {\n                        // Make it UTC:\n                        result += 'Z';\n                    }\n                    human += ', ' + conf.i18n.rangeByEndDateHuman;\n                    human += ' ' + field.data('dateinput').getValue(conf.i18n.longDateFormat);\n                    break;\n                }\n                break;\n            }\n        }\n\n        if (form.ical.RDATE !== undefined && form.ical.RDATE.length > 0) {\n            form.ical.RDATE.sort();\n            tmp = [];\n            for (i = 0; i < form.ical.RDATE.length; i++) {\n                if (form.ical.RDATE[i] !== '') {\n                    year = parseInt(form.ical.RDATE[i].substring(0, 4), 10);\n                    month = parseInt(form.ical.RDATE[i].substring(4, 6), 10) - 1;\n                    day = parseInt(form.ical.RDATE[i].substring(6, 8), 10);\n                    tmp.push(format(new Date(year, month, day), conf.i18n.longDateFormat, conf));\n                }\n            }\n            if (tmp.length !== 0) {\n                human = human + conf.i18n.including + ' ' + tmp.join('; ');\n            }\n        }\n\n        if (form.ical.EXDATE !== undefined && form.ical.EXDATE.length > 0) {\n            form.ical.EXDATE.sort();\n            tmp = [];\n            for (i = 0; i < form.ical.EXDATE.length; i++) {\n                if (form.ical.EXDATE[i] !== '') {\n                    year = parseInt(form.ical.EXDATE[i].substring(0, 4), 10);\n                    month = parseInt(form.ical.EXDATE[i].substring(4, 6), 10) - 1;\n                    day = parseInt(form.ical.EXDATE[i].substring(6, 8), 10);\n                    tmp.push(format(new Date(year, month, day), conf.i18n.longDateFormat, conf));\n                }\n            }\n            if (tmp.length !== 0) {\n                human = human + conf.i18n.except + ' ' + tmp.join('; ');\n            }\n        }\n        result = 'RRULE:' + result;\n        if (form.ical.EXDATE !== undefined && form.ical.EXDATE.join() !== \"\") {\n            tmp = $.map(form.ical.EXDATE, function (x) {\n                if (x.length === 8) { // DATE format. Make it DATE-TIME\n                    x += 'T000000';\n                }\n                if (tz === true) {\n                    // Make it UTC:\n                    x += 'Z';\n                }\n                return x;\n            });\n            result = result + '\\nEXDATE:' + tmp;\n        }\n        if (form.ical.RDATE !== undefined && form.ical.RDATE.join() !== \"\") {\n            tmp = $.map(form.ical.RDATE, function (x) {\n                if (x.length === 8) { // DATE format. Make it DATE-TIME\n                    x += 'T000000';\n                }\n                if (tz === true) {\n                    // Make it UTC:\n                    x += 'Z';\n                }\n                return x;\n            });\n            result = result + '\\nRDATE:' + tmp;\n        }\n        return {result: result, description: human};\n    }\n\n    function parseLine(icalline) {\n        var result = {};\n        var pos = icalline.indexOf(':');\n        var property = icalline.substring(0, pos);\n        result.value = icalline.substring(pos + 1);\n\n        if (property.indexOf(';') !== -1) {\n            pos = property.indexOf(';');\n            result.parameters = property.substring(pos + 1);\n            result.property = property.substring(0, pos);\n        } else {\n            result.parameters = null;\n            result.property = property;\n        }\n        return result;\n    }\n\n    function cleanDates(dates) {\n        // Get rid of timezones\n        // TODO: We could parse dates and range here, maybe?\n        var result = [];\n        var splitDates = dates.split(',');\n        var date;\n\n        for (date in splitDates) {\n            if (splitDates.hasOwnProperty(date)) {\n                if (splitDates[date].indexOf('Z') !== -1) {\n                    result.push(splitDates[date].substring(0, 15));\n                } else {\n                    result.push(splitDates[date]);\n                }\n            }\n        }\n        return result;\n    }\n\n    function parseIcal(icaldata) {\n        var lines = [];\n        var result = {};\n        var propAndValue = [];\n        var line = null;\n        var nextline;\n\n        lines = icaldata.split('\\n');\n        lines.reverse();\n        while (true) {\n            if (lines.length > 0) {\n                nextline = lines.pop();\n                if (nextline.charAt(0) === ' ' || nextline.charAt(0) === '\\t') {\n                    // Line continuation:\n                    line = line + nextline;\n                    continue;\n                }\n            } else {\n                nextline = '';\n            }\n\n            // New line; the current one is finished, add it to the result.\n            if (line !== null) {\n                line = parseLine(line);\n                 // We ignore properties for now\n                if (line.property === 'RDATE' || line.property === 'EXDATE') {\n                    result[line.property] = cleanDates(line.value);\n                } else {\n                    result[line.property] = line.value;\n                }\n            }\n\n            line = nextline;\n            if (line === '') {\n                break;\n            }\n        }\n        return result;\n    }\n\n    function widgetLoadFromRfc5545(form, conf, icaldata, force) {\n        var unsupportedFeatures = [];\n        var i, matches, match, matchIndex, rtemplate, d, input, index;\n        var selector, selectors, field, radiobutton, start, end;\n        var interval, byday, bymonth, bymonthday, count, until;\n        var day, month, year, weekday, ical;\n\n        form.ical = parseIcal(icaldata);\n        if (form.ical.RRULE === undefined) {\n            unsupportedFeatures.push(conf.i18n.noRule);\n            if (!force) {\n                return -1; // Fail!\n            }\n        } else {\n\n\n            matches = /INTERVAL=([0-9]+);?/.exec(form.ical.RRULE);\n            if (matches) {\n                interval = matches[1];\n            } else {\n                interval = '1';\n            }\n\n            matches = /BYDAY=([^;]+);?/.exec(form.ical.RRULE);\n            if (matches) {\n                byday = matches[1];\n            } else {\n                byday = '';\n            }\n\n            matches = /BYMONTHDAY=([^;]+);?/.exec(form.ical.RRULE);\n            if (matches) {\n                bymonthday = matches[1].split(\",\");\n            } else {\n                bymonthday = null;\n            }\n\n            matches = /BYMONTH=([^;]+);?/.exec(form.ical.RRULE);\n            if (matches) {\n                bymonth = matches[1].split(\",\");\n            } else {\n                bymonth = null;\n            }\n\n            matches = /COUNT=([0-9]+);?/.exec(form.ical.RRULE);\n            if (matches) {\n                count = matches[1];\n            } else {\n                count = null;\n            }\n\n            matches = /UNTIL=([0-9T]+);?/.exec(form.ical.RRULE);\n            if (matches) {\n                until = matches[1];\n            } else {\n                until = null;\n            }\n\n            matches = /BYSETPOS=([^;]+);?/.exec(form.ical.RRULE);\n            if (matches) {\n                unsupportedFeatures.push(conf.i18n.bysetpos);\n            }\n\n            // Find the best rule:\n            match = '';\n            matchIndex = null;\n            for (i in conf.rtemplate) {\n                if (conf.rtemplate.hasOwnProperty(i)) {\n                    rtemplate = conf.rtemplate[i];\n                    if (form.ical.RRULE.indexOf(rtemplate.rrule) === 0) {\n                        if (form.ical.RRULE.length > match.length) {\n                            // This is the best match so far\n                            match = form.ical.RRULE;\n                            matchIndex = i;\n                        }\n                    }\n                }\n            }\n\n            if (match) {\n                rtemplate = conf.rtemplate[matchIndex];\n                // Set the selector:\n                selector = form.find('select[name=rirtemplate]').val(matchIndex);\n            } else {\n                for (rtemplate in conf.rtemplate) {\n                    if (conf.rtemplate.hasOwnProperty(rtemplate)) {\n                        rtemplate = conf.rtemplate[rtemplate];\n                        break;\n                    }\n                }\n                unsupportedFeatures.push(conf.i18n.noTemplateMatch);\n            }\n\n            for (i = 0; i < rtemplate.fields.length; i++) {\n                field = form.find('#' + rtemplate.fields[i]);\n                switch (field.attr('id')) {\n\n                case 'ridailyinterval':\n                    field.find('input[name=ridailyinterval]').val(interval);\n                    break;\n\n                case 'riweeklyinterval':\n                    field.find('input[name=riweeklyinterval]').val(interval);\n                    break;\n\n                case 'riweeklyweekdays':\n                    byday = byday.split(\",\");\n                    for (d = 0; d < conf.weekdays.length; d++) {\n                        day = conf.weekdays[d];\n                        input = field.find('input[name=riweeklyweekdays' + day + ']');\n                        input.attr('checked', $.inArray(day, byday) !== -1);\n                    }\n                    break;\n\n                case 'rimonthlyinterval':\n                    field.find('input[name=rimonthlyinterval]').val(interval);\n                    break;\n\n                case 'rimonthlyoptions':\n                    var monthlyType = 'DAYOFMONTH'; // Default to using BYMONTHDAY\n\n                    if (bymonthday) {\n                        monthlyType = 'DAYOFMONTH';\n                        if (bymonthday.length > 1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);\n                            // Just keep the first\n                            bymonthday = bymonthday[0];\n                        }\n                        field.find('select[name=rimonthlydayofmonthday]').val(bymonthday);\n                    }\n\n                    if (byday) {\n                        monthlyType = 'WEEKDAYOFMONTH';\n\n                        if (byday.indexOf(',') !== -1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);\n                            byday = byday.split(\",\")[0];\n                        }\n                        index = byday.slice(0, -2);\n                        if (index.charAt(0) !== '+' && index.charAt(0) !== '-') {\n                            index = '+' + index;\n                        }\n                        weekday = byday.slice(-2);\n                        field.find('select[name=rimonthlyweekdayofmonthindex]').val(index);\n                        field.find('select[name=rimonthlyweekdayofmonth]').val(weekday);\n                    }\n\n                    selectors = field.find('input[name=rimonthlytype]');\n                    for (index = 0; index < selectors.length; index++) {\n                        radiobutton = selectors[index];\n                        $(radiobutton).attr('checked', radiobutton.value === monthlyType);\n                    }\n                    break;\n\n                case 'riyearlyinterval':\n                    field.find('input[name=riyearlyinterval]').val(interval);\n                    break;\n\n                case 'riyearlyoptions':\n                    var yearlyType = 'DAYOFMONTH'; // Default to using BYMONTHDAY\n\n                    if (bymonthday) {\n                        yearlyType = 'DAYOFMONTH';\n                        if (bymonthday.length > 1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);\n                            bymonthday = bymonthday[0];\n                        }\n                        field.find('select[name=riyearlydayofmonthmonth]').val(bymonth);\n                        field.find('select[name=riyearlydayofmonthday]').val(bymonthday);\n                    }\n\n                    if (byday) {\n                        yearlyType = 'WEEKDAYOFMONTH';\n\n                        if (byday.indexOf(',') !== -1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);\n                            byday = byday.split(\",\")[0];\n                        }\n                        index = byday.slice(0, -2);\n                        if (index.charAt(0) !== '+' && index.charAt(0) !== '-') {\n                            index = '+' + index;\n                        }\n                        weekday = byday.slice(-2);\n                        field.find('select[name=riyearlyweekdayofmonthindex]').val(index);\n                        field.find('select[name=riyearlyweekdayofmonthday]').val(weekday);\n                        field.find('select[name=riyearlyweekdayofmonthmonth]').val(bymonth);\n                    }\n\n                    selectors = field.find('input[name=riyearlyType]');\n                    for (index = 0; index < selectors.length; index++) {\n                        radiobutton = selectors[index];\n                        $(radiobutton).attr('checked', radiobutton.value === yearlyType);\n                    }\n                    break;\n\n                case 'rirangeoptions':\n                    var rangeType = 'NOENDDATE';\n\n                    if (count) {\n                        rangeType = 'BYOCCURRENCES';\n                        field.find('input[name=rirangebyoccurrencesvalue]').val(count);\n                    }\n\n                    if (until) {\n                        rangeType = 'BYENDDATE';\n                        input = field.find('input[name=rirangebyenddatecalendar]');\n                        year = until.slice(0, 4);\n                        month = until.slice(4, 6);\n                        month = parseInt(month, 10) - 1;\n                        day = until.slice(6, 8);\n                        input.data('dateinput').setValue(new Date(year, month, day));\n                    }\n\n                    selectors = field.find('input[name=rirangetype]');\n                    for (index = 0; index <  selectors.length; index++) {\n                        radiobutton = selectors[index];\n                        $(radiobutton).attr('checked', radiobutton.value === rangeType);\n                    }\n                    break;\n                }\n            }\n        }\n\n        var messagearea = form.find('#messagearea');\n        if (unsupportedFeatures.length !== 0) {\n            messagearea.text(conf.i18n.unsupportedFeatures + ' ' + unsupportedFeatures.join('; '));\n            messagearea.show();\n            return 1;\n        } else {\n            messagearea.text('');\n            messagearea.hide();\n            return 0;\n        }\n\n    }\n\n    /**\n     * RecurrenceInput - form, display and tools for recurrenceinput widget\n     */\n    function RecurrenceInput(conf, textarea) {\n\n        var self = this;\n        var form, display;\n\n        // Extend conf with non-configurable data used by templates.\n        var orderedWeekdays = [];\n        var index, i;\n        for (i = 0; i < 7; i++) {\n            index = i + conf.firstDay;\n            if (index > 6) {\n                index = index - 7;\n            }\n            orderedWeekdays.push(index);\n        }\n\n        $.extend(conf, {\n            orderIndexes: ['+1', '+2', '+3', '+4', '-1'],\n            weekdays: ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'],\n            orderedWeekdays: orderedWeekdays\n        });\n\n        // The recurrence type dropdown should show certain fields depending\n        // on selection:\n        function displayFields(selector) {\n            var i;\n            // First hide all the fields\n            form.find('.rifield').hide();\n            // Then show the ones that should be shown.\n            var value = selector.val();\n            if (value) {\n                var rtemplate = conf.rtemplate[value];\n                for (i = 0; i < rtemplate.fields.length; i++) {\n                    form.find('#' + rtemplate.fields[i]).show();\n                }\n            }\n        }\n\n        function occurrenceExclude(event) {\n            event.preventDefault();\n            if (form.ical.EXDATE === undefined) {\n                form.ical.EXDATE = [];\n            }\n            form.ical.EXDATE.push(this.attributes.date.value);\n            var $this = $(this);\n            $this.attr('class', 'exdate');\n            $this.parent().parent().addClass('exdate');\n            $this.unbind(event);\n            $this.click(occurrenceInclude); // Jslint warns here, but that's OK.\n        }\n\n        function occurrenceInclude(event) {\n            event.preventDefault();\n            form.ical.EXDATE.splice($.inArray(this.attributes.date.value, form.ical.EXDATE), 1);\n            var $this = $(this);\n            $this.attr('class', 'rrule');\n            $this.parent().parent().removeClass('exdate');\n            $this.unbind(event);\n            $this.click(occurrenceExclude);\n        }\n\n        function occurrenceDelete(event) {\n            event.preventDefault();\n            form.ical.RDATE.splice($.inArray(this.attributes.date.value, form.ical.RDATE), 1);\n            $(this).parent().parent().hide('slow', function () {\n                $(this).remove();\n            });\n        }\n\n        function occurrenceAdd(event) {\n            event.preventDefault();\n            var dateinput = form\n                .find('.riaddoccurrence input#adddate')\n                .data('dateinput');\n            var datevalue = dateinput.getValue('yyyymmddT000000');\n            if (form.ical.RDATE === undefined) {\n                form.ical.RDATE = [];\n            }\n            var errorarea = form.find('.riaddoccurrence div.errorarea');\n            errorarea.text('');\n            errorarea.hide();\n\n            // Add date only if it is not already in RDATE\n            if ($.inArray(datevalue, form.ical.RDATE) === -1) {\n                form.ical.RDATE.push(datevalue);\n                var html = ['<div class=\"occurrence rdate\" style=\"display: none;\">',\n                        '<span class=\"rdate\">',\n                            dateinput.getValue(conf.i18n.longDateFormat),\n                            '<span class=\"rlabel\">' + conf.i18n.additionalDate + '</span>',\n                        '</span>',\n                        '<span class=\"action\">',\n                            '<a date=\"' + datevalue + '\" href=\"#\" class=\"rdate\" >',\n                                'Include',\n                            '</a>',\n                        '</span>',\n                        '</div>'].join('\\n');\n                form.find('div.rioccurrences').prepend(html);\n                $(form.find('div.rioccurrences div')[0]).slideDown();\n                $(form.find('div.rioccurrences .action a.rdate')[0]).click(occurrenceDelete);\n            } else {\n                errorarea.text(conf.i18n.alreadyAdded).show();\n            }\n        }\n\n        // element is where to find the tag in question. Can be the form\n        // or the display widget. Defaults to the form.\n        function loadOccurrences(startdate, rfc5545, start, readonly) {\n            var element, occurrenceDiv;\n\n            if (!readonly) {\n                element = form;\n            } else {\n                element = display;\n            }\n\n            occurrenceDiv = element.find('.rioccurrences');\n            occurrenceDiv.hide();\n\n            var year, month, day;\n            year = startdate.getFullYear();\n            month = startdate.getMonth() + 1;\n            day = startdate.getDate();\n\n            var data = {year: year,\n                       month: month, // Sending January as 0? I think not.\n                       day: day,\n                       rrule: rfc5545,\n                       format: conf.i18n.longDateFormat,\n                       start: start};\n\n            var dict = {\n                url: conf.ajaxURL,\n                async: false, // Can't be tested if it's asynchronous, annoyingly.\n                type: 'post',\n                dataType: 'json',\n                contentType: conf.ajaxContentType,\n                cache: false,\n                data: data,\n                success: function (data, status, jqXHR) {\n                    var result, element;\n\n                    if (!readonly) {\n                        element = form;\n                    } else {\n                        element = display;\n                    }\n                    data.readOnly = readonly;\n                    data.i18n = conf.i18n;\n\n                    // Format dates:\n                    var occurrence, date, y, m, d, each;\n                    for (each in data.occurrences) {\n                        if (data.occurrences.hasOwnProperty(each)) {\n                            occurrence = data.occurrences[each];\n                            date = occurrence.date;\n                            y = parseInt(date.substring(0, 4), 10);\n                            m = parseInt(date.substring(4, 6), 10) - 1; // jan=0\n                            d = parseInt(date.substring(6, 8), 10);\n                            occurrence.formattedDate = format(new Date(y, m, d), conf.i18n.longDateFormat, conf);\n                        }\n                    }\n\n                    result = $.tmpl('occurrenceTmpl', data);\n                    occurrenceDiv = element.find('.rioccurrences');\n                    occurrenceDiv.replaceWith(result);\n\n                    // Add the batch actions:\n                    element.find('.rioccurrences .batching a').click(\n                        function (event) {\n                            event.preventDefault();\n                            loadOccurrences(startdate, rfc5545, this.attributes.start.value, readonly);\n                        }\n                    );\n\n                    // Add the delete/undelete actions:\n                    if (!readonly) {\n                        element.find('.rioccurrences .action a.rrule').click(occurrenceExclude);\n                        element.find('.rioccurrences .action a.exdate').click(occurrenceInclude);\n                        element.find('.rioccurrences .action a.rdate').click(occurrenceDelete);\n                    }\n                    // Show the new div\n                    element.find('.rioccurrences').show();\n                },\n                error: function (jqXHR, textStatus, errorThrown) {\n                    alert(textStatus);\n                }\n            };\n\n            $.ajax(dict);\n        }\n\n        function getField(field) {\n            // See if it is a field already\n            var realField = $(field);\n            if (!realField.length) {\n                // Otherwise, we assume it's an id:\n                realField = $('#' + field);\n            }\n            if (!realField.length) {\n                // Still not? Then it's a name.\n                realField = $(\"input[name='\" + field + \"']\");\n            }\n            return realField;\n        }\n        function findStartDate() {\n            var startdate = null;\n            var startField, startFieldYear, startFieldMonth, startFieldDay;\n\n            // Find the default byday and bymonthday from the start date, if any:\n            if (conf.startField) {\n                startField = getField(conf.startField);\n                if (!startField.length) {\n                    // Field not found\n                    return null;\n                }\n                // Now we have a field, see if it is a dateinput field:\n                startdate = startField.data('dateinput');\n                if (!startdate) {\n                    //No, it wasn't, just try to interpret it with Date()\n                    startdate = startField.val();\n                    if (startdate === \"\") {\n                        // Probably not an input at all. Try to see if it contains a date\n                        startdate = startField.text();\n                    }\n                } else {\n                    // Yes it was, get the date:\n                    startdate = startdate.getValue();\n                }\n\n                if (typeof startdate === 'string') {\n                    // convert human readable, non ISO8601 dates, like\n                    // '2014-04-24 19:00', where the 'T' separator is missing.\n                    startdate = startdate.replace(' ', 'T');\n                }\n\n                startdate = new Date(startdate);\n            } else if (conf.startFieldYear &&\n                       conf.startFieldMonth &&\n                       conf.startFieldDay) {\n                startFieldYear = getField(conf.startFieldYear);\n                startFieldMonth = getField(conf.startFieldMonth);\n                startFieldDay = getField(conf.startFieldDay);\n                if (!startFieldYear.length &&\n                    !startFieldMonth.length &&\n                    !startFieldDay.length) {\n                    // Field not found\n                    return null;\n                }\n                startdate = new Date(startFieldYear.val(),\n                                     startFieldMonth.val() - 1,\n                                     startFieldDay.val());\n            }\n            if (startdate === null) {\n                return null;\n            }\n            // We have some sort of startdate:\n            if (isNaN(startdate)) {\n                return null;\n            }\n            return startdate;\n        }\n        function findEndDate(form) {\n            var endField, enddate;\n\n            endField = form.find('input[name=rirangebyenddatecalendar]');\n\n            // Now we have a field, see if it is a dateinput field:\n            enddate = endField.data('dateinput');\n            if (!enddate) {\n                //No, it wasn't, just try to interpret it with Date()\n                enddate = endField.val();\n            } else {\n                // Yes it was, get the date:\n                enddate = enddate.getValue();\n            }\n            enddate = new Date(enddate);\n\n            // if the end date is incorrect or the field is left empty\n            if (isNaN(enddate) || endField.val() === \"\") {\n                return null;\n            }\n            return enddate;\n        }\n        function findIntField(fieldName, form) {\n            var field, num, isInt;\n\n            field = form.find('input[name=' + fieldName + ']');\n\n            num = field.val();\n\n            // if it's not a number or the field is left empty\n            if (isNaN(num) || (num.toString().indexOf('.') !== -1) || field.val() === \"\") {\n                return null;\n            }\n            return num;\n        }\n\n        // Loading (populating) display and form widget with\n        // passed RFC5545 string (data)\n        function loadData(rfc5545) {\n            var selector, format, startdate, dayindex, day;\n\n            if (rfc5545) {\n                widgetLoadFromRfc5545(form, conf, rfc5545, true);\n            }\n\n            startdate = findStartDate();\n\n            if (startdate !== null) {\n                // If the date is a real date, set the defaults in the form\n                form.find('select[name=rimonthlydayofmonthday]').val(startdate.getDate());\n                dayindex = conf.orderIndexes[Math.floor((startdate.getDate() - 1) / 7)];\n                day = conf.weekdays[startdate.getDay()];\n                form.find('select[name=rimonthlyweekdayofmonthindex]').val(dayindex);\n                form.find('select[name=rimonthlyweekdayofmonth]').val(day);\n\n                form.find('select[name=riyearlydayofmonthmonth]').val(startdate.getMonth() + 1);\n                form.find('select[name=riyearlydayofmonthday]').val(startdate.getDate());\n                form.find('select[name=riyearlyweekdayofmonthindex]').val(dayindex);\n                form.find('select[name=riyearlyweekdayofmonthday]').val(day);\n                form.find('select[name=riyearlyweekdayofmonthmonth]').val(startdate.getMonth() + 1);\n\n                // Now when we have a start date, we can also do an ajax call to calculate occurrences:\n                loadOccurrences(startdate, widgetSaveToRfc5545(form, conf, false).result, 0, false);\n\n                // Show the add and refresh buttons:\n                form.find('div.rioccurrencesactions').show();\n\n            } else {\n                // No EXDATE/RDATE support\n                form.find('div.rioccurrencesactions').hide();\n            }\n\n\n            selector = form.find('select[name=rirtemplate]');\n            displayFields(selector);\n        }\n\n        function recurrenceOn() {\n            var RFC5545 = widgetSaveToRfc5545(form, conf, false);\n            var label = display.find('label[class=ridisplay]');\n            label.text(conf.i18n.displayActivate + ' ' + RFC5545.description);\n            textarea.val(RFC5545.result).change();\n            var startdate = findStartDate();\n            if (startdate !== null) {\n                loadOccurrences(startdate, widgetSaveToRfc5545(form, conf, false).result, 0, true);\n            }\n            display.find('button[name=\"riedit\"]').text(conf.i18n.edit_rules);\n            display.find('button[name=\"ridelete\"]').show();\n        }\n\n        function recurrenceOff() {\n            var label = display.find('label[class=ridisplay]');\n            label.text(conf.i18n.displayUnactivate);\n            textarea.val('').change();  // Clear the textarea.\n            display.find('.rioccurrences').hide();\n            display.find('button[name=\"riedit\"]').text(conf.i18n.add_rules);\n            display.find('button[name=\"ridelete\"]').hide();\n        }\n\n        function checkFields(form) {\n            var startDate, endDate, num, messagearea;\n            startDate = findStartDate();\n\n            // Hide any error message from before\n            messagearea = form.find('#messagearea');\n            messagearea.text('');\n            messagearea.hide();\n\n            // Hide add field errors\n            form.find('.riaddoccurrence div.errorarea').text('').hide();\n\n            // Repeats Daily\n            if (form.find('#ridailyinterval').css('display') === 'block') {\n                // Check repeat every field\n                num = findIntField('ridailyinterval', form);\n                if (!num || num < 1 || num > 1000) {\n                    messagearea.text(conf.i18n.noRepeatEvery).show();\n                    return false;\n                }\n            }\n\n            // Repeats Weekly\n            if (form.find('#riweeklyinterval').css('display') === 'block') {\n                // Check repeat every field\n                num = findIntField('riweeklyinterval', form);\n                if (!num || num < 1 || num > 1000) {\n                    messagearea.text(conf.i18n.noRepeatEvery).show();\n                    return false;\n                }\n            }\n\n            // Repeats Monthly\n            if (form.find('#rimonthlyinterval').css('display') === 'block') {\n                // Check repeat every field\n                num = findIntField('rimonthlyinterval', form);\n                if (!num || num < 1 || num > 1000) {\n                    messagearea.text(conf.i18n.noRepeatEvery).show();\n                    return false;\n                }\n\n                // Check repeat on\n                if (form.find('#rimonthlyoptions input:checked').length === 0) {\n                    messagearea.text(conf.i18n.noRepeatOn).show();\n                    return false;\n                }\n            }\n\n            // Repeats Yearly\n            if (form.find('#riyearlyinterval').css('display') === 'block') {\n                // Check repeat every field\n                num = findIntField('riyearlyinterval', form);\n                if (!num || num < 1 || num > 1000) {\n                    messagearea.text(conf.i18n.noRepeatEvery).show();\n                    return false;\n                }\n\n                // Check repeat on\n                if (form.find('#riyearlyoptions input:checked').length === 0) {\n                    messagearea.text(conf.i18n.noRepeatOn).show();\n                    return false;\n                }\n            }\n\n            // End recurrence fields\n\n            // If after N occurences is selected, check its value\n            if (form.find('input[value=\"BYOCCURRENCES\"]:visible:checked').length > 0) {\n                num = findIntField('rirangebyoccurrencesvalue', form);\n                if (!num || num < 1 || num > 1000) {\n                    messagearea.text(conf.i18n.noEndAfterNOccurrences).show();\n                    return false;\n                }\n            }\n\n            // If end date is selected, check its value\n            if (form.find('input[value=\"BYENDDATE\"]:visible:checked').length > 0) {\n                endDate = findEndDate(form);\n                if (!endDate) {\n                    // if endDate is null that means the field is empty\n                    messagearea.text(conf.i18n.noEndDate).show();\n                    return false;\n                } else if (endDate < startDate) {\n                    // the end date cannot be before start date\n                    messagearea.text(conf.i18n.pastEndDate).show();\n                    return false;\n                }\n            }\n\n            return true;\n        }\n\n        function save(event) {\n            event.preventDefault();\n            // if no field errors, process the request\n            if (checkFields(form)) {\n                // close overlay\n                form.overlay().close();\n                recurrenceOn();\n            }\n        }\n\n        function cancel(event) {\n            event.preventDefault();\n            // close overlay\n            form.overlay().close();\n        }\n\n        function updateOccurances() {\n            var startDate;\n            startDate = findStartDate();\n\n            // if no field errors, process the request\n            if (checkFields(form)) {\n                loadOccurrences(startDate,\n                    widgetSaveToRfc5545(form, conf, false).result,\n                    0,\n                    false);\n            }\n        }\n\n        /*\n          Load the templates\n        */\n\n        display = $.tmpl('displayTmpl', conf);\n        form = $.tmpl('formTmpl', conf);\n\n        // Make an overlay and hide it\n        form.overlay(conf.formOverlay).hide();\n        form.ical = {RDATE: [], EXDATE: []};\n\n        $.tools.dateinput.localize(conf.lang,  {\n            months:      LABELS[conf.lang].months.join(),\n            shortMonths: LABELS[conf.lang].shortMonths.join(),\n            days:        LABELS[conf.lang].weekdays.join(),\n            shortDays:   LABELS[conf.lang].shortWeekdays.join()\n        });\n\n        // Make the date input into a calendar dateinput()\n        form.find('input[name=rirangebyenddatecalendar]').dateinput({\n            selectors: true,\n            lang: conf.lang,\n            format: conf.i18n.shortDateFormat,\n            firstDay: conf.firstDay,\n            yearRange: [-5, 10]\n        }).data('dateinput').setValue(new Date());\n\n        if (textarea.val()) {\n            var result = widgetLoadFromRfc5545(form, conf, textarea.val(), false);\n            if (result === -1) {\n                var label = display.find('label[class=ridisplay]');\n                label.text(conf.i18n.noRule);\n            } else {\n                recurrenceOn();\n            }\n        }\n\n        /*\n          Do all the GUI stuff:\n        */\n\n        // When you click \"Delete...\", the recurrence rules should be cleared.\n        display.find('button[name=ridelete]').click(function (e) {\n            e.preventDefault();\n            recurrenceOff();\n        });\n\n        // Show form overlay when you click on the \"Edit...\" link\n        display.find('button[name=riedit]').click(\n            function (e) {\n                // Load the form to set up the right fields to show, etc.\n                loadData(textarea.val());\n                e.preventDefault();\n                form.overlay().load();\n            }\n        );\n\n        // Pop up the little add form when clicking \"Add\"\n        form.find('div.riaddoccurrence input#adddate').dateinput({\n            selectors: true,\n            lang: conf.lang,\n            format: conf.i18n.shortDateFormat,\n            firstDay: conf.firstDay,\n            yearRange: [-5, 10]\n        }).data('dateinput').setValue(new Date());\n        form.find('input#addaction').click(occurrenceAdd);\n\n        // When the reload button is clicked, reload\n        form.find('a.rirefreshbutton').click(\n            function (event) {\n                event.preventDefault();\n                updateOccurances();\n            }\n        );\n\n        // When selecting template, update what fieldsets are visible.\n        form.find('select[name=rirtemplate]').change(\n            function (e) {\n                displayFields($(this));\n            }\n        );\n\n        // When focus goes to a drop-down, select the relevant radiobutton.\n        form.find('select').change(\n            function (e) {\n                $(this).parent().find('> input').click().change();\n            }\n        );\n        form.find('input[name=rirangebyoccurrencesvalue]').change(\n            function (e) {\n                $(this).parent().find('input[name=rirangetype]').click().change();\n            }\n        );\n        form.find('input[name=rirangebyenddatecalendar]').change(function () {\n            // Update only if the occurances are shown\n            $(this).parent().find('input[name=rirangetype]').click();\n            if (form.find('.rioccurrencesactions:visible').length !== 0) {\n                updateOccurances();\n            }\n        });\n        // Update the selected dates section\n        form.find('input:radio, .riweeklyweekday > input, input[name=ridailyinterval], input[name=riweeklyinterval], input[name=rimonthlyinterval], input[name=riyearlyinterval]').change(\n            function (e) {\n                // Update only if the occurances are shown\n                if (form.find('.rioccurrencesactions:visible').length !== 0) {\n                    updateOccurances();\n                }\n            }\n        );\n\n        /*\n          Save and cancel methods:\n        */\n        form.find('.ricancelbutton').click(cancel);\n        form.find('.risavebutton').click(save);\n\n        /*\n         * Public API of RecurrenceInput\n         */\n\n        $.extend(self, {\n            display: display,\n            form: form,\n            loadData: loadData, //Used by tests.\n            save: save //Used by tests.\n        });\n\n    }\n\n\n    /*\n     * jQuery plugin implementation\n     */\n    $.fn.recurrenceinput = function (conf) {\n        if (this.data('recurrenceinput')) {\n            // plugin already installed\n            return this.data('recurrenceinput');\n        }\n\n        // \"compile\" configuration for widget\n        var config = $.extend({}, tool.conf);\n        $.extend(config, conf);\n        $.extend(config, {i18n: LABELS[config.lang], name: this.attr('name')});\n\n        // our recurrenceinput widget instance\n        var recurrenceinput = new RecurrenceInput(config, this);\n        // hide textarea and place display widget after textarea\n        recurrenceinput.form.appendTo('body');\n        this.after(recurrenceinput.display);\n\n        // hide the textarea\n        this.hide();\n\n        // save the data for next call\n        this.data('recurrenceinput', recurrenceinput);\n        return recurrenceinput;\n    };\n\n}(jQuery));\n"],"names":["$","tool","tools","version","LABELS","recurrenceinput","conf","lang","readOnly","firstDay","startField","startFieldYear","startFieldMonth","startFieldDay","ajaxURL","ajaxContentType","ributtonExtraClass","hasRepeatForeverButton","formOverlay","speed","fixed","template","form","display","rtemplate","daily","rrule","fields","mondayfriday","weekdays","weekly","monthly","yearly","localize","language","labels","setTemplates","templates","titles","hasOwnProperty","displayUnactivate","displayActivate","add_rules","edit_rules","delete_rules","add","refresh","title","preview","addDate","recurrenceType","dailyInterval1","dailyInterval2","weeklyInterval1","weeklyInterval2","weeklyWeekdays","weeklyWeekdaysHuman","monthlyInterval1","monthlyInterval2","monthlyDayOfMonth1","monthlyDayOfMonth1Human","monthlyDayOfMonth2","monthlyDayOfMonth3","monthlyWeekdayOfMonth1","monthlyWeekdayOfMonth1Human","monthlyWeekdayOfMonth2","monthlyWeekdayOfMonth3","monthlyRepeatOn","yearlyInterval1","yearlyInterval2","yearlyDayOfMonth1","yearlyDayOfMonth1Human","yearlyDayOfMonth2","yearlyDayOfMonth3","yearlyWeekdayOfMonth1","yearlyWeekdayOfMonth1Human","yearlyWeekdayOfMonth2","yearlyWeekdayOfMonth3","yearlyWeekdayOfMonth4","yearlyRepeatOn","range","rangeNoEnd","rangeByOccurrences1","rangeByOccurrences1Human","rangeByOccurrences2","rangeByEndDate","rangeByEndDateHuman","including","except","cancel","save","recurrenceStart","additionalDate","include","exclude","remove","orderIndexes","months","shortMonths","shortWeekdays","longDateFormat","shortDateFormat","unsupportedFeatures","noTemplateMatch","multipleDayOfMonth","bysetpos","noRule","noRepeatEvery","noEndDate","noRepeatOn","pastEndDate","noEndAfterNOccurrences","alreadyAdded","OCCURRENCETMPL","join","DISPLAYTMPL","FORMTMPL","Re","zeropad","val","len","toString","length","format","date","fmt","d","getDate","D","getDay","m","getMonth","y","getFullYear","flags","dd","ddd","i18n","dddd","mm","mmm","mmmm","yy","String","slice","yyyy","replace","$0","widgetSaveToRfc5545","tz","field","i18nweekdays","i","j","index","tmp","day","month","year","interval","occurrences","value","find","result","human","attr","is","inArray","data","getValue","undefined","ical","RDATE","sort","parseInt","substring","push","Date","EXDATE","map","x","description","parseLine","icalline","pos","indexOf","property","parameters","cleanDates","dates","splitDates","split","widgetLoadFromRfc5545","icaldata","force","matches","match","matchIndex","input","selectors","radiobutton","byday","bymonth","bymonthday","count","until","weekday","nextline","lines","line","reverse","pop","charAt","parseIcal","RRULE","exec","monthlyType","yearlyType","rangeType","setValue","messagearea","text","show","hide","RecurrenceInput","textarea","orderedWeekdays","displayFields","selector","occurrenceExclude","event","preventDefault","this","attributes","$this","parent","addClass","unbind","click","occurrenceInclude","splice","removeClass","occurrenceDelete","loadOccurrences","startdate","rfc5545","start","readonly","dict","url","async","type","dataType","contentType","cache","success","status","jqXHR","element","occurrence","each","formattedDate","tmpl","replaceWith","error","textStatus","errorThrown","alert","ajax","getField","realField","findStartDate","isNaN","findIntField","fieldName","num","loadData","dayindex","Math","floor","recurrenceOn","RFC5545","change","checkFields","startDate","endDate","css","endField","enddate","findEndDate","overlay","close","updateOccurances","extend","dateinput","days","shortDays","yearRange","e","load","datevalue","errorarea","html","prepend","slideDown","fn","config","name","appendTo","after","jQuery"],"sourceRoot":""}